<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matthew Vaishnav</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,700;1,9..144,300;1,9..144,700&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:          #09090f;
    --surface:     #0f1018;
    --surface2:    #14161f;
    --border:      rgba(255,255,255,0.07);
    --border-hi:   rgba(255,255,255,0.13);
    --accent:      #c8d6f8;
    --accent-dim:  rgba(200,214,248,0.45);
    --accent-glow: rgba(200,214,248,0.055);
    --text:        #7a8298;
    --text-mid:    #a8b0c4;
    --text-hi:     #e4e8f4;
    --green:       #52c97a;
    --amber:       #f5c842;
    --red:         #e05252;
    --mono: 'JetBrains Mono', monospace;
    --sans: 'DM Sans', sans-serif;
    --display: 'Fraunces', serif;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; overflow-x: hidden; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    font-size: 17px;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  /* grain */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9998;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    opacity: 0.5;
  }

  /* ── NAV ── */
  nav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 200;
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 2.5rem; height: 58px;
    border-bottom: 1px solid var(--border);
    background: rgba(9,9,15,0.88);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
  }

  /* hamburger */
  .nav-burger {
    display: none;
    flex-direction: column; justify-content: center; gap: 5px;
    width: 36px; height: 36px; cursor: pointer;
    background: none; border: none; padding: 6px;
  }
  .nav-burger span {
    display: block; width: 20px; height: 1.5px;
    background: var(--text-mid); border-radius: 2px;
    transition: all .2s ease;
  }
  .nav-burger.open span:nth-child(1) { transform: translateY(6.5px) rotate(45deg); }
  .nav-burger.open span:nth-child(2) { opacity: 0; }
  .nav-burger.open span:nth-child(3) { transform: translateY(-6.5px) rotate(-45deg); }

  /* mobile drawer */
  .nav-drawer {
    display: none;
    position: fixed; top: 58px; left: 0; right: 0;
    background: rgba(9,9,15,0.97);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 1.5rem 2rem;
    z-index: 199;
    flex-direction: column; gap: 0;
  }
  .nav-drawer.open { display: flex; }
  .nav-drawer a {
    display: block; padding: .85rem 0;
    font-size: 15px; color: var(--text-mid);
    text-decoration: none; border-bottom: 1px solid var(--border);
    transition: color .15s;
  }
  .nav-drawer a:last-child { border-bottom: none; }
  .nav-drawer a:hover { color: var(--text-hi); }
  .nav-name {
    font-family: var(--display);
    font-size: 15px; font-weight: 600;
    color: var(--text-hi); text-decoration: none;
    letter-spacing: 0.01em;
  }
  .nav-links { display: flex; gap: 2.5rem; list-style: none; }
  .nav-links a {
    font-size: 14px; color: var(--text);
    text-decoration: none; transition: color 0.15s;
  }
  .nav-links a:hover { color: var(--text-hi); }
  .nav-cta {
    font-size: 13px; font-weight: 500;
    color: var(--accent); text-decoration: none;
    padding: 6px 16px;
    border: 1px solid rgba(200,214,248,0.18);
    border-radius: 4px;
    transition: background 0.15s, border-color 0.15s;
  }
  .nav-cta:hover {
    background: var(--accent-glow);
    border-color: rgba(200,214,248,0.32);
  }

  /* ── HERO ── */
  #hero {
    min-height: 100vh;
    display: flex; align-items: center;
    padding: 0 2.5rem;
    position: relative; overflow: hidden;
  }
  #hero::before {
    content: '';
    position: absolute; top: 20%; left: -10%;
    width: 55%; height: 70%;
    background: radial-gradient(ellipse at center,
      rgba(200,214,248,0.035) 0%, transparent 65%);
    pointer-events: none;
  }
  .hero-inner {
    width: 100%; max-width: 1100px; margin: 0 auto;
    display: grid; grid-template-columns: 1fr 1px 1fr;
    gap: 0; align-items: stretch;
    position: relative;
  }

  .hero-divider {
    width: 1px;
    height: 60%;
    background: linear-gradient(
      to bottom,
      transparent 0%,
      var(--border-hi) 25%,
      var(--border-hi) 75%,
      transparent 100%
    );
    justify-self: center;
    opacity: 0;
    animation: up .65s cubic-bezier(.16,1,.3,1) .55s forwards;
  }

  .hero-left {
    padding-right: 5rem;
    display: flex; flex-direction: column; justify-content: center;
  }
  .hero-right {
    padding-left: 5rem;
    display: flex; flex-direction: column;
  }

  .hero-label {
    display: flex; align-items: center; gap: 10px;
    margin-bottom: 2rem;
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .1s forwards;
  }
  .hero-label-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--accent); opacity: 0.5;
  }
  .hero-label span {
    font-family: var(--mono);
    font-size: 12px; letter-spacing: .12em;
    text-transform: uppercase; color: var(--text);
  }

  h1 {
    font-family: var(--display);
    font-size: clamp(2.8rem, 5vw, 4.8rem);
    font-weight: 700;
    line-height: 1.08; letter-spacing: -.01em;
    color: var(--text-hi);
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .22s forwards;
  }
  h1 .name-first { display: block; font-weight: 300; font-style: italic; font-size: 0.55em; color: var(--text); letter-spacing: .01em; margin-bottom: .2em; }
  h1 .name-role  { display: block; font-size: 0.38em; font-weight: 300; font-style: normal; font-family: var(--mono); letter-spacing: .1em; text-transform: uppercase; color: var(--text); margin-top: .6em; }

  .hero-body {
    margin-top: 1.75rem;
    font-size: 1.05rem; font-weight: 300;
    color: var(--text); line-height: 1.8;
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .34s forwards;
  }
  .hero-body strong { color: var(--text-mid); font-weight: 400; }

  .hero-actions {
    display: flex; gap: 1rem; flex-wrap: wrap;
    margin-top: 2.5rem;
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .46s forwards;
  }
  .btn {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 11px 24px;
    font-family: var(--sans); font-size: 14px; font-weight: 500;
    text-decoration: none; border-radius: 5px;
    transition: all .15s ease; letter-spacing: .01em;
  }
  .btn-solid { background: var(--text-hi); color: var(--bg); }
  .btn-solid:hover {
    background: #fff;
    transform: translateY(-1px);
    box-shadow: 0 8px 28px rgba(228,232,244,.1);
  }
  .btn-ghost {
    background: transparent; color: var(--text-mid);
    border: 1px solid var(--border-hi);
  }
  .btn-ghost:hover { border-color: rgba(255,255,255,.22); color: var(--text-hi); }

  /* ── HERO TERMINAL ── */
  .hero-terminal {
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .5s forwards;
    border: 1px solid var(--border-hi);
    border-radius: 8px; overflow: hidden;
    background: #07080d;
    box-shadow: 0 32px 80px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.04);
    flex: 1;
    display: flex; flex-direction: column;
  }
  .ht-bar {
    display: flex; align-items: center; gap: 7px;
    padding: 10px 14px; background: var(--surface2);
    border-bottom: 1px solid var(--border);
  }
  .ht-dot { width: 11px; height: 11px; border-radius: 50%; }
  .ht-red    { background: #ff5f57; }
  .ht-yellow { background: #febc2e; }
  .ht-green  { background: #28c840; }
  .ht-title {
    font-family: var(--mono); font-size: 11px;
    color: var(--text); margin-left: auto; letter-spacing: .04em;
  }
  .ht-body {
    padding: 1.25rem 1.5rem;
    font-family: var(--mono); font-size: 12px; line-height: 1.9;
    flex: 1; overflow: hidden;
  }
  .ht-line { display: flex; gap: 0; white-space: pre-wrap; word-break: break-all; }
  .ht-prompt { color: var(--accent); flex-shrink: 0; }
  .ht-cmd    { color: var(--text-hi); }
  .ht-out    { color: #4a5568; }
  .ht-hi     { color: var(--text-mid); }
  .ht-green-t { color: #52c97a; }
  .ht-amber-t { color: #f5c842; }
  .ht-red-t   { color: #e05252; }
  .ht-cursor  {
    display: inline-block; width: 7px; height: 14px;
    background: var(--accent); opacity: 0.7; margin-left: 2px;
    vertical-align: middle;
    animation: blink .9s step-end infinite;
  }

  .hero-scroll {
    position: absolute; bottom: 2.5rem; left: 0;
    display: flex; align-items: center; gap: 10px;
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .65s forwards;
  }
  .hero-scroll-line { width: 36px; height: 1px; background: var(--border-hi); }
  .hero-scroll span {
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .12em; text-transform: uppercase; color: var(--text);
  }

  /* ── SECTIONS ── */
  section { padding: 6rem 2.5rem; }
  .inner { max-width: 820px; margin: 0 auto; }

  .s-label {
    display: flex; align-items: center; gap: 1rem;
    margin-bottom: 3.5rem;
  }
  .s-label-txt {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .13em; text-transform: uppercase;
    color: var(--text); white-space: nowrap;
  }
  .s-label-line { flex: 1; height: 1px; background: var(--border); }

  h2 {
    font-family: var(--display);
    font-size: 2rem; font-weight: 700;
    letter-spacing: -.02em; color: var(--text-hi);
    margin-bottom: 1.25rem; line-height: 1.1;
  }

  /* ── ABOUT ── */
  #about { background: var(--surface); border-top: 1px solid var(--border); }

  .about-cols {
    display: grid; grid-template-columns: 1.15fr .85fr;
    gap: 5rem; align-items: start;
  }
  .about-text p {
    font-weight: 300; color: var(--text);
    line-height: 1.82; margin-bottom: 1.1rem;
    font-size: 1rem;
  }
  .about-text strong { color: var(--text-mid); font-weight: 400; }

  .profile-card {
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
    background: var(--surface2);
  }
  .profile-head {
    padding: .9rem 1.2rem; border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 8px;
  }
  .profile-head-dot {
    width: 7px; height: 7px; border-radius: 50%;
    background: var(--accent); opacity: 0.45;
  }
  .profile-head span {
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .1em; text-transform: uppercase; color: var(--text);
  }
  .profile-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: .62rem 1.2rem; border-bottom: 1px solid var(--border); gap: 1rem;
  }
  .profile-row:last-child { border-bottom: none; }
  .pk { font-family: var(--mono); font-size: 12px; color: var(--text); }
  .pv { font-family: var(--mono); font-size: 12px; color: var(--text-mid); text-align: right; }

  .sdot {
    display: inline-block; width: 6px; height: 6px;
    border-radius: 50%; margin-right: 5px; vertical-align: middle;
  }
  .s-green { background: var(--green); }
  .s-amber { background: var(--amber); animation: blink 2s ease-in-out infinite; }
  .s-dim   { background: #3a3f50; }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:.3} }

  /* ── SKILLS ── */
  .skills-grid {
    display: grid; grid-template-columns: repeat(3,1fr);
    gap: 1px; background: var(--border);
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
  }
  .sc {
    background: var(--bg); padding: 1.5rem;
    transition: background .15s;
  }
  .sc:hover { background: var(--surface2); }
  .sc-label {
    display: block; font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--accent-dim); margin-bottom: .9rem;
  }
  .chips { display: flex; flex-wrap: wrap; gap: 5px; }
  .chip {
    font-family: var(--mono); font-size: 11px;
    padding: 4px 9px; border: 1px solid var(--border-hi);
    border-radius: 3px; color: var(--text); letter-spacing: .01em;
    transition: color .15s, border-color .15s;
  }
  .sc:hover .chip { color: var(--text-mid); border-color: rgba(255,255,255,.14); }

  /* ── PROJECTS ── */
  #projects { background: var(--surface); border-top: 1px solid var(--border); }

  .proj-row {
    display: grid; grid-template-columns: 1fr auto;
    gap: 2rem; align-items: center;
    padding: 1.6rem 0; border-bottom: 1px solid var(--border);
    text-decoration: none; cursor: pointer;
    transition: padding-left .2s ease;
  }
  .proj-row:first-of-type { border-top: 1px solid var(--border); }
  .proj-row:hover { padding-left: .5rem; }
  .proj-row:hover .proj-title { color: var(--text-hi); }

  .proj-kicker {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--text); margin-bottom: .35rem;
  }
  .proj-title {
    font-family: var(--display); font-size: 1.25rem; font-weight: 600;
    color: var(--text-hi); letter-spacing: -.01em;
    margin-bottom: .3rem; transition: color .15s;
  }
  .proj-desc {
    font-size: 14px; font-weight: 300;
    color: var(--text); line-height: 1.65; max-width: 560px;
  }
  .proj-arrow {
    font-size: 17px; color: var(--border-hi);
    transition: color .15s, transform .2s; flex-shrink: 0;
  }
  .proj-row:hover .proj-arrow { color: var(--text-mid); transform: translate(3px,-3px); }

  /* ── CTF ── */
  .ctf-grid {
    display: grid; grid-template-columns: repeat(2,1fr);
    gap: 1px; background: var(--border);
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
  }
  .ctf-card {
    background: var(--bg); padding: 1.75rem;
    text-decoration: none; display: block; transition: background .15s;
  }
  .ctf-card:hover { background: var(--surface2); }
  .ctf-top {
    display: flex; justify-content: space-between; align-items: flex-start;
    margin-bottom: 1rem;
  }
  .ctf-platform {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase; color: var(--text);
  }
  .diff {
    font-family: var(--mono); font-size: 11px;
    padding: 3px 9px; border-radius: 3px; letter-spacing: .04em;
  }
  .d-easy { color:var(--green); background:rgba(82,201,122,.08); border:1px solid rgba(82,201,122,.2); }
  .d-med  { color:var(--amber); background:rgba(245,200,66,.08); border:1px solid rgba(245,200,66,.2); }
  .d-hard { color:var(--red);   background:rgba(224,82,82,.08);  border:1px solid rgba(224,82,82,.2); }

  .ctf-name {
    font-family: var(--display); font-size: 1.15rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.01em; margin-bottom: .45rem;
  }
  .ctf-desc {
    font-size: 13.5px; font-weight: 300; color: var(--text);
    line-height: 1.65; margin-bottom: 1rem;
  }
  .ttp-list { display: flex; flex-wrap: wrap; gap: 5px; }
  .ttp {
    font-family: var(--mono); font-size: 10.5px;
    padding: 3px 8px; border: 1px solid var(--border-hi);
    border-radius: 3px; color: var(--text); letter-spacing: .02em;
  }

  /* ── CONTACT ── */
  #contact { border-top: 1px solid var(--border); }
  .contact-cols {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 5rem; align-items: start;
  }
  .contact-text p {
    font-weight: 300; color: var(--text);
    line-height: 1.82; margin-bottom: 1rem;
    font-size: 1rem;
  }
  .contact-text strong { color: var(--text-mid); font-weight: 400; }

  .link-list {
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
  }
  .ext-link {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1rem 1.2rem;
    text-decoration: none; border-bottom: 1px solid var(--border);
    transition: background .15s; gap: 1rem;
  }
  .ext-link:last-child { border-bottom: none; }
  .ext-link:hover { background: var(--surface2); }
  .ext-lbl {
    font-family: var(--mono); font-size: 10.5px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--text); display: block; margin-bottom: 3px;
  }
  .ext-val {
    font-size: 14px; color: var(--text-mid); font-weight: 400;
    transition: color .15s;
  }
  .ext-link:hover .ext-val { color: var(--text-hi); }
  .ext-arr {
    font-size: 14px; color: var(--border-hi);
    transition: color .15s, transform .15s; flex-shrink: 0;
  }
  .ext-link:hover .ext-arr { color: var(--text-mid); transform: translate(2px,-2px); }

  /* ── SKILLS SNAPSHOT ── */
  .skills-snapshot {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 0 4rem;
  }
  .snap-col { display: flex; flex-direction: column; gap: 2rem; }
  .snap-group {}
  .snap-cat {
    display: block;
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .12em; text-transform: uppercase;
    color: var(--accent-dim); margin-bottom: .75rem;
    padding-bottom: .5rem;
    border-bottom: 1px solid var(--border);
  }
  .snap-list {
    list-style: none; padding: 0;
    display: flex; flex-direction: column; gap: .4rem;
  }
  .snap-list li {
    font-size: 14px; font-weight: 300;
    color: var(--text-mid); line-height: 1.5;
    padding-left: 1rem; position: relative;
  }
  .snap-list li::before {
    content: '—';
    position: absolute; left: 0;
    color: var(--border-hi);
    font-size: 12px;
  }

  /* ── CURRENTLY WORKING ON ── */
  #now { background: var(--surface); border-top: 1px solid var(--border); }
  .now-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 1px; background: var(--border);
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
  }
  .now-item {
    background: var(--bg); padding: 1.5rem;
    display: flex; gap: 1rem; align-items: flex-start;
    transition: background .15s;
  }
  .now-item:hover { background: var(--surface2); }
  .now-icon {
    font-size: 12px; color: var(--accent-dim);
    flex-shrink: 0; margin-top: 3px;
  }
  .now-title {
    font-family: var(--display); font-size: 1rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.01em; margin-bottom: .35rem;
  }
  .now-desc {
    font-size: 13px; font-weight: 300; color: var(--text); line-height: 1.65;
  }

  /* ── LAB DIAGRAM ── */
  #lab { border-top: 1px solid var(--border); }
  #lab .inner { max-width: 100%; padding: 0 2.5rem; }
  .diagram-wrap {
    border: 1px solid var(--border); border-radius: 6px;
    overflow: hidden; background: #080a10;
    padding: 0;
    max-width: 1400px;
    margin: 0 auto;
  }

  #labCanvas { image-rendering: crisp-edges; }

  /* ── FOOTER (expanded) ── */
  footer {
    padding: 2.5rem 2.5rem;
    border-top: 1px solid var(--border);
    background: var(--surface);
  }
  .footer-inner {
    max-width: 820px; margin: 0 auto;
    display: flex; justify-content: space-between; align-items: flex-start;
    gap: 2rem; flex-wrap: wrap;
  }
  .footer-name {
    font-family: var(--display); font-size: 15px; font-weight: 600;
    color: var(--text-hi); margin-bottom: .4rem;
  }
  .footer-sub { font-family: var(--mono); font-size: 11px; color: var(--text); line-height: 1.8; }
  .footer-links {
    display: flex; flex-direction: column; gap: .4rem; text-align: right;
  }
  .footer-links a {
    font-family: var(--mono); font-size: 11px; color: var(--text);
    text-decoration: none; transition: color .15s;
  }
  .footer-links a:hover { color: var(--text-hi); }

  /* ── ANIMATIONS ── */
  @keyframes up {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: none; }
  }
  .reveal { opacity: 0; transform: translateY(14px); transition: opacity .55s cubic-bezier(.16,1,.3,1), transform .55s cubic-bezier(.16,1,.3,1); }
  .reveal.in { opacity: 1; transform: none; }

  /* ── RESPONSIVE ── */
  @media (max-width: 780px) {
    nav { padding: 0 1.25rem; }
    .nav-links { display: none; }
    .nav-cta { display: none; }
    .nav-burger { display: flex; }

    section { padding: 3.5rem 1.25rem; }

    #hero {
      padding: 1.25rem; padding-top: 5.5rem; padding-bottom: 3rem;
      min-height: auto;
    }
    .hero-inner { grid-template-columns: 1fr; gap: 2.5rem; }
    .hero-divider { display: none; }
    .hero-left { padding-right: 0; }
    .hero-right { display: none; }
    .hero-scroll { display: none; }
    h1 { font-size: clamp(2.2rem, 9vw, 3rem); }

    .about-cols { grid-template-columns: 1fr; gap: 2rem; }
    .skills-snapshot { grid-template-columns: 1fr; gap: 2rem; }
    .ctf-grid { grid-template-columns: 1fr; }
    .now-grid { grid-template-columns: 1fr; }
    .contact-cols { grid-template-columns: 1fr; gap: 2rem; }

    .proj-row { grid-template-columns: 1fr; gap: .75rem; }
    .proj-arrow { display: none; }

    .diagram-wrap { padding: .75rem; }

    .footer-inner { flex-direction: column; gap: 1.25rem; }
    .footer-links { text-align: left; flex-direction: row; flex-wrap: wrap; gap: 1rem; }
  }

  @media (max-width: 500px) {
    .hero-actions { flex-direction: column; }
    .btn { width: 100%; justify-content: center; }
  }
</style>
</head>
<body>

<nav>
  <a href="#" class="nav-name">Matthew Vaishnav</a>
  <ul class="nav-links">
    <li><a href="#about">About</a></li>
    <li><a href="#skills">Skills</a></li>
    <li><a href="#projects">Projects</a></li>
    <li><a href="#ctf">CTF</a></li>
    <li><a href="#now">Now</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
  <a href="https://github.com/matthewvaishnav/cst-portfolio" class="nav-cta" target="_blank">View Repo →</a>
  <button class="nav-burger" id="burger" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<!-- MOBILE DRAWER -->
<div class="nav-drawer" id="drawer">
  <a href="#about"    onclick="closeDrawer()">About</a>
  <a href="#skills"   onclick="closeDrawer()">Skills</a>
  <a href="#projects" onclick="closeDrawer()">Projects</a>
  <a href="#ctf"      onclick="closeDrawer()">CTF</a>
  <a href="#now"      onclick="closeDrawer()">Currently Working On</a>
  <a href="#lab"      onclick="closeDrawer()">Lab Diagram</a>
  <a href="#contact"  onclick="closeDrawer()">Contact</a>
</div>

<!-- HERO -->
<section id="hero">
  <div class="hero-inner">
    <!-- LEFT: text -->
    <div class="hero-left">
      <div class="hero-label">
        <div class="hero-label-dot"></div>
        <span>Computer Systems Technician · Conestoga College · Waterloo, ON</span>
      </div>
      <h1>
        <span class="name-first">Matthew Vaishnav</span>
        Security &amp; Infrastructure
        <span class="name-role">CST · Conestoga · Co-op 2026</span>
      </h1>
      <p class="hero-body">
        First-year CST student with a focus on <strong>network security and infrastructure operations</strong>.
        I maintain a home lab, pursue CTF challenges, and document everything openly.
        Currently seeking a co-op placement for 2026.
      </p>
      <div class="hero-actions">
        <a href="https://github.com/matthewvaishnav/cst-portfolio" class="btn btn-solid" target="_blank">GitHub Repository</a>
        <a href="#contact" class="btn btn-ghost">Get in Touch</a>
      </div>
    </div>

    <!-- DIVIDER -->
    <div class="hero-divider"></div>

    <!-- RIGHT: animated terminal -->
    <div class="hero-right">
    <div class="hero-terminal">
      <div class="ht-bar">
        <div class="ht-dot ht-red"></div>
        <div class="ht-dot ht-yellow"></div>
        <div class="ht-dot ht-green"></div>
        <span class="ht-title">log-correlator.py</span>
      </div>
      <div class="ht-body" id="terminal-output"></div>
    </div>
    </div><!-- end hero-right -->
  </div>

  <div class="hero-scroll">
    <div class="hero-scroll-line"></div>
    <span>Scroll</span>
  </div>
</section>

<!-- ABOUT -->
<section id="about">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">01 — About</span>
      <div class="s-label-line"></div>
    </div>
    <div class="about-cols">
      <div class="about-text reveal">
        <p>I'm a Computer Systems Technician student at Conestoga College with a focus on homelabs, monitoring stacks, and troubleshooting complex systems. I build real infrastructure, document everything, and constantly refine my workflow for reliability and clarity.</p>
        <p>My home lab runs Kali Linux, pfSense, Security Onion, and a Windows Server 2019 domain. It's a practical space for extending coursework into real configuration, testing, and break/fix scenarios. Every config and script gets committed.</p>
        <p>I'm pursuing a <strong>co-op placement in SOC analysis or IT infrastructure for 2026</strong>. Alongside coursework I'm studying for CompTIA Security+ and working through TryHackMe's SOC Level 1 path.</p>
      </div>
      <div class="reveal">
        <div class="profile-card">
          <div class="profile-head">
            <div class="profile-head-dot"></div>
            <span>Profile</span>
          </div>
          <div class="profile-row"><span class="pk">Program</span><span class="pv">CST — Conestoga</span></div>
          <div class="profile-row"><span class="pk">Graduating</span><span class="pv">2027</span></div>
          <div class="profile-row"><span class="pk">Location</span><span class="pv">Waterloo, ON</span></div>
          <div class="profile-row"><span class="pk">Lab OS</span><span class="pv">Kali · Ubuntu · Win Server</span></div>
          <div class="profile-row"><span class="pk">Security+</span><span class="pv"><span class="sdot s-amber"></span>Studying</span></div>
          <div class="profile-row"><span class="pk">THM SOC L1</span><span class="pv"><span class="sdot s-amber"></span>In Progress</span></div>
          <div class="profile-row"><span class="pk">Co-op</span><span class="pv"><span class="sdot s-green"></span>Available 2026</span></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SKILLS -->
<section id="skills">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">02 — Skills Snapshot</span>
      <div class="s-label-line"></div>
    </div>
    <div class="skills-snapshot reveal">
      <div class="snap-col">
        <div class="snap-group">
          <span class="snap-cat">Containerisation &amp; DevOps</span>
          <ul class="snap-list">
            <li>Docker, Docker Compose</li>
            <li>GitHub Actions, CI/CD pipelines</li>
            <li>Terraform (AWS VPC, EC2, S3)</li>
            <li>Ansible provisioning</li>
            <li>Git, version control workflows</li>
          </ul>
        </div>
        <div class="snap-group">
          <span class="snap-cat">Monitoring &amp; Observability</span>
          <ul class="snap-list">
            <li>Prometheus, Grafana, Loki</li>
            <li>Node Exporter, cAdvisor</li>
            <li>AlertManager, Promtail</li>
            <li>Log correlation &amp; anomaly detection</li>
            <li>Splunk SPL query writing</li>
          </ul>
        </div>
        <div class="snap-group">
          <span class="snap-cat">Networking</span>
          <ul class="snap-list">
            <li>Cisco IOS CLI, Packet Tracer</li>
            <li>TCP/IP, subnetting, VLANs, OSPF</li>
            <li>pfSense firewall administration</li>
            <li>DNS, DHCP, SMB, NFS</li>
            <li>Wireshark &amp; packet analysis</li>
          </ul>
        </div>
      </div>
      <div class="snap-col">
        <div class="snap-group">
          <span class="snap-cat">Windows Server &amp; Active Directory</span>
          <ul class="snap-list">
            <li>Windows Server 2019 (Standard &amp; Core)</li>
            <li>Active Directory, Group Policy, RSAT</li>
            <li>NTFS permissions, SMB shares</li>
            <li>Exchange Server, mailbox administration</li>
            <li>PowerShell remoting &amp; scripting</li>
          </ul>
        </div>
        <div class="snap-group">
          <span class="snap-cat">Linux Administration</span>
          <ul class="snap-list">
            <li>Kali, Ubuntu Server, Rocky Linux</li>
            <li>Bash scripting, Python automation</li>
            <li>SSH hardening, auditd, fail2ban</li>
            <li>Samba, NFS, service management</li>
            <li>CIS Benchmark hardening</li>
          </ul>
        </div>
        <div class="snap-group">
          <span class="snap-cat">Security &amp; Troubleshooting</span>
          <ul class="snap-list">
            <li>Nmap, Metasploit, Burp Suite</li>
            <li>MITRE ATT&amp;CK, Sigma Rules, YARA</li>
            <li>Vulnerability assessment (OpenVAS)</li>
            <li>Incident triage &amp; documentation</li>
            <li>Troubleshooting &amp; root cause analysis</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- PROJECTS -->
<section id="projects">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">03 — Projects</span>
      <div class="s-label-line"></div>
    </div>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/soc" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Python · Security</div>
        <div class="proj-title">SOC Toolkit</div>
        <div class="proj-desc">Multi-source log correlation engine, anomaly detection, threat hunting framework, and Splunk SPL playbook library. Detects brute force, lateral movement, and scanner activity with MITRE ATT&CK mapping.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/scripting" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Bash · PowerShell · Python</div>
        <div class="proj-title">Security Scripting Suite</div>
        <div class="proj-desc">CIS Benchmark server hardening automation, Windows security audit with Active Directory enumeration and HTML report output, network recon tool with service fingerprinting and vulnerability flagging.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/devops" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Terraform · Ansible · Docker · GitHub Actions</div>
        <div class="proj-title">DevSecOps Pipeline</div>
        <div class="proj-desc">End-to-end CI/CD pipeline with SAST (Bandit, Semgrep), dependency scanning (Trivy), Terraform-managed AWS infrastructure with VPC and flow logging, Ansible provisioning, and hardened container images.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/monitoring" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Docker Compose · Prometheus · Grafana · Loki</div>
        <div class="proj-title">SOC Monitoring Stack</div>
        <div class="proj-desc">Self-hosted observability stack: Prometheus, Grafana, Loki, Promtail, AlertManager, Node Exporter, and cAdvisor. Deployed on an isolated Docker network with persistent storage and pre-configured dashboards.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/data-analysis" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Python · Log Analysis</div>
        <div class="proj-title">Log Correlation Engine</div>
        <div class="proj-desc">Parses and correlates auth.log and web access logs across sources. Identifies brute force success chains, scanner-to-admin-path patterns, and multi-service reconnaissance via sliding time windows.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>
  </div>
</section>

<!-- CTF -->
<section id="ctf">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">04 — CTF Writeups</span>
      <div class="s-label-line"></div>
    </div>
    <p class="reveal" style="font-size:14px;font-weight:300;color:var(--text);margin-bottom:2.5rem;line-height:1.75;">
      Documented walkthroughs covering attack methodology, tooling, and blue team detection notes for each technique used.
    </p>
    <div class="ctf-grid reveal">
      <a href="https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_Blue_EternalBlue.md" class="ctf-card" target="_blank">
        <div class="ctf-top">
          <span class="ctf-platform">TryHackMe</span>
          <span class="diff d-easy">Easy</span>
        </div>
        <div class="ctf-name">Blue — EternalBlue (MS17-010)</div>
        <div class="ctf-desc">SMB exploitation via Metasploit, SYSTEM-level access, credential dumping with hashdump. Includes Windows Event ID analysis and detection recommendations.</div>
        <div class="ttp-list">
          <span class="ttp">T1190 Exploit Public App</span>
          <span class="ttp">T1003 Credential Dumping</span>
          <span class="ttp">T1078 Valid Accounts</span>
        </div>
      </a>
      <a href="https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_Linux_Privesc.md" class="ctf-card" target="_blank">
        <div class="ctf-top">
          <span class="ctf-platform">TryHackMe</span>
          <span class="diff d-med">Medium</span>
        </div>
        <div class="ctf-name">Linux Privilege Escalation</div>
        <div class="ctf-desc">SUID binary abuse, sudo misconfigurations, cron job exploitation, and weak file permissions. Full methodology from low-privilege shell to root.</div>
        <div class="ttp-list">
          <span class="ttp">T1548 Abuse Elevation</span>
          <span class="ttp">T1053 Scheduled Task</span>
          <span class="ttp">T1222 File Permissions</span>
        </div>
      </a>
      <a href="https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_WebApp_Exploitation.md" class="ctf-card" target="_blank">
        <div class="ctf-top">
          <span class="ctf-platform">TryHackMe</span>
          <span class="diff d-med">Medium</span>
        </div>
        <div class="ctf-name">Web Application Exploitation</div>
        <div class="ctf-desc">SQL injection for authentication bypass, stored XSS, IDOR, and directory traversal. Includes remediation guidance and secure coding notes for each finding.</div>
        <div class="ttp-list">
          <span class="ttp">T1190 Web Exploit</span>
          <span class="ttp">T1059 Command Injection</span>
          <span class="ttp">T1083 File Discovery</span>
        </div>
      </a>
      <a href="https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_ActiveDirectory_Attacks.md" class="ctf-card" target="_blank">
        <div class="ctf-top">
          <span class="ctf-platform">TryHackMe</span>
          <span class="diff d-hard">Hard</span>
        </div>
        <div class="ctf-name">Active Directory Attacks</div>
        <div class="ctf-desc">Kerberoasting, AS-REP roasting, pass-the-hash, and lateral movement across a Windows domain. Full chain from initial foothold to Domain Admin.</div>
        <div class="ttp-list">
          <span class="ttp">T1558 Kerberos Ticket</span>
          <span class="ttp">T1550 Pass the Hash</span>
          <span class="ttp">T1021 Lateral Movement</span>
        </div>
      </a>
    </div>
  </div>
</section>

<!-- CURRENTLY WORKING ON -->
<section id="now">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">05 — Currently Working On</span>
      <div class="s-label-line"></div>
    </div>
    <div class="now-grid reveal">
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Docker Engine Security Hardening</div>
          <div class="now-desc">Implementing CIS Docker Benchmark controls: rootless containers, read-only filesystems, seccomp profiles, and network segmentation between stacks.</div>
        </div>
      </div>
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Homelab → GitHub Automated Sync</div>
          <div class="now-desc">Building a pipeline to automatically commit config changes and new scripts from the lab to this repo. Keeps the portfolio live and current.</div>
        </div>
      </div>
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Monitoring Stack Architecture Diagrams</div>
          <div class="now-desc">Documenting the full Prometheus/Grafana/Loki stack with clean architecture diagrams showing data flows, retention policies, and alerting paths.</div>
        </div>
      </div>
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Windows Server Lab Expansion</div>
          <div class="now-desc">Extending the AD domain with a second DC, GPO policy testing environment, and a read-only domain controller (RODC) to simulate enterprise topologies.</div>
        </div>
      </div>
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">CompTIA Security+ Exam Prep</div>
          <div class="now-desc">Working through Professor Messer's course and Darril Gibson practice exams. Target date: Summer 2026.</div>
        </div>
      </div>
      <div class="now-item">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">TryHackMe SOC Level 1 Path</div>
          <div class="now-desc">Completing the full SOC Level 1 learning path. Currently on Cyber Defence frameworks and log analysis modules.</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- LAB DIAGRAM -->
<section id="lab">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">06 — Home Lab Architecture</span>
      <div class="s-label-line"></div>
    </div>
    <p class="reveal" style="font-size:14px;font-weight:300;color:var(--text);margin-bottom:2rem;line-height:1.75;">
      A segmented virtual lab environment running on VMware. Isolated VLAN per zone, all traffic passing through pfSense, with Security Onion sniffing the span port. <span style="font-family:var(--mono);font-size:11px;color:var(--text);">Click any node to explore.</span>
    </p>
    <div class="diagram-wrap reveal" style="padding:0;position:relative;">
      <canvas id="labCanvas" style="width:100%;display:block;border-radius:6px;cursor:pointer;"></canvas>
      <!-- Detail panel -->
      <div id="nodePanel" style="
        display:none;position:absolute;z-index:10;
        background:#0f1018;border:1px solid rgba(200,214,248,0.18);border-radius:6px;
        padding:1.25rem 1.5rem;min-width:240px;max-width:300px;
        box-shadow:0 16px 48px rgba(0,0,0,0.6);
        font-family:'JetBrains Mono',monospace;
        pointer-events:none;
      ">
        <div id="panelTitle" style="font-size:13px;font-weight:600;color:#e4e8f4;margin-bottom:.5rem;font-family:'Fraunces',serif;"></div>
        <div id="panelIp"    style="font-size:10px;color:#5a6a88;margin-bottom:.75rem;letter-spacing:.06em;"></div>
        <div id="panelBody"  style="font-size:11px;color:#7a8298;line-height:1.75;"></div>
      </div>
    </div>
  </div>
</section>

<!-- CONTACT -->
<section id="contact">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">07 — Contact</span>
      <div class="s-label-line"></div>
    </div>
    <div class="contact-cols">
      <div class="contact-text reveal">
        <p>I'm actively looking for a <strong>co-op placement starting in 2026</strong> in SOC analysis, IT infrastructure, or security operations. Based in Waterloo and open to in-person, hybrid, and remote opportunities across Ontario.</p>
        <p>If you're a hiring manager or recruiter and something here is relevant to your team, I'd be glad to connect.</p>
      </div>
      <div class="link-list reveal">
        <a href="https://github.com/matthewvaishnav/cst-portfolio" class="ext-link" target="_blank">
          <div><span class="ext-lbl">GitHub</span><span class="ext-val">github.com/matthewvaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="https://www.linkedin.com/in/matthew-vaishnav-279670229/" class="ext-link" target="_blank">
          <div><span class="ext-lbl">LinkedIn</span><span class="ext-val">linkedin.com/in/matthew-vaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="https://tryhackme.com/p/matthew.vaishnav" class="ext-link" target="_blank">
          <div><span class="ext-lbl">TryHackMe</span><span class="ext-val">tryhackme.com/p/matthew.vaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="mailto:matthew.vaishnav@gmail.com" class="ext-link">
          <div><span class="ext-lbl">Email</span><span class="ext-val">matthew.vaishnav@gmail.com</span></div>
          <span class="ext-arr">↗</span>
        </a>
      </div>
    </div>
  </div>
</section>

<footer>
  <div class="footer-inner">
    <div class="footer-left">
      <p class="footer-name">Matthew Vaishnav</p>
      <p class="footer-sub">Computer Systems Technician · Conestoga College · Class of 2027</p>
      <p class="footer-sub">Waterloo, Ontario · Open to co-op 2026</p>
    </div>
    <div class="footer-links">
      <a href="https://github.com/matthewvaishnav/cst-portfolio" target="_blank">GitHub</a>
      <a href="https://www.linkedin.com/in/matthew-vaishnav-279670229/" target="_blank">LinkedIn</a>
      <a href="https://tryhackme.com/p/matthew.vaishnav" target="_blank">TryHackMe</a>
      <a href="mailto:matthew.vaishnav@gmail.com">matthew.vaishnav@gmail.com</a>
    </div>
  </div>
</footer>

<script>
  // Hamburger menu
  const burger = document.getElementById('burger');
  const drawer = document.getElementById('drawer');
  burger.addEventListener('click', () => {
    burger.classList.toggle('open');
    drawer.classList.toggle('open');
  });
  function closeDrawer() {
    burger.classList.remove('open');
    drawer.classList.remove('open');
  }
  // Close drawer on outside click
  document.addEventListener('click', (e) => {
    if (!burger.contains(e.target) && !drawer.contains(e.target)) closeDrawer();
  });

  // Scroll reveal
  const io = new IntersectionObserver((entries) => {
    entries.forEach((e, i) => {
      if (e.isIntersecting) {
        setTimeout(() => e.target.classList.add('in'), i * 65);
        io.unobserve(e.target);
      }
    });
  }, { threshold: 0.07 });
  document.querySelectorAll('.reveal').forEach(el => io.observe(el));

  // Terminal typewriter
  const out = document.getElementById('terminal-output');
  const lines = [
    { type: 'cmd',   text: 'python3 log-correlator.py --src auth.log' },
    { type: 'blank', text: '' },
    { type: 'out',   text: '[*] Loading 14,822 log entries...' },
    { type: 'out',   text: '[*] Parsing sources: auth.log, access.log' },
    { type: 'blank', text: '' },
    { type: 'warn',  text: '[!] BRUTE FORCE DETECTED' },
    { type: 'hi',    text: '    Source IP   : 185.220.101.47' },
    { type: 'hi',    text: '    Target      : root@10.0.0.10' },
    { type: 'hi',    text: '    Attempts    : 847 over 00:03:12' },
    { type: 'hi',    text: '    ATT&CK      : T1110.001' },
    { type: 'blank', text: '' },
    { type: 'good',  text: '[+] SUCCESS AFTER FAILURE CHAIN' },
    { type: 'hi',    text: '    IP          : 185.220.101.47' },
    { type: 'hi',    text: '    Login at    : 03:17:44 UTC' },
    { type: 'hi',    text: '    User        : svc-backup' },
    { type: 'blank', text: '' },
    { type: 'out',   text: '[*] Correlating with web access logs...' },
    { type: 'warn',  text: '[!] RECON PATTERN — scanner fingerprint' },
    { type: 'hi',    text: '    Paths hit   : /admin /wp-login /.env' },
    { type: 'blank', text: '' },
    { type: 'out',   text: '[*] Writing report → report_2026-02-21.html' },
    { type: 'good',  text: '[+] Done. 3 alerts generated.' },
    { type: 'blank', text: '' },
    { type: 'prompt', text: '' },
  ];

  const colours = {
    cmd:    'color:#e4e8f4',
    out:    'color:#4a5568',
    warn:   'color:#f5c842',
    good:   'color:#52c97a',
    hi:     'color:#7a8298',
    blank:  '',
    prompt: '',
  };

  let lineIdx = 0;
  let charIdx = 0;
  let el = null;

  function nextLine() {
    if (lineIdx >= lines.length) return;
    const line = lines[lineIdx];
    const div = document.createElement('div');
    div.className = 'ht-line';

    if (line.type === 'cmd') {
      div.innerHTML = '<span class="ht-prompt">$ </span><span class="ht-cmd"></span>';
    } else if (line.type === 'prompt') {
      div.innerHTML = '<span class="ht-prompt">$ </span><span class="ht-cursor"></span>';
      out.appendChild(div);
      lineIdx++;
      return;
    } else if (line.type === 'blank') {
      out.appendChild(div);
      lineIdx++;
      charIdx = 0;
      setTimeout(nextLine, 80);
      return;
    } else {
      div.innerHTML = `<span style="${colours[line.type] || ''}"></span>`;
    }

    out.appendChild(div);
    el = div.querySelector('span:last-child');
    charIdx = 0;
    typeChar();
  }

  function typeChar() {
    const line = lines[lineIdx];
    if (charIdx < line.text.length) {
      el.textContent += line.text[charIdx];
      charIdx++;
      out.scrollTop = out.scrollHeight;
      const delay = line.type === 'cmd' ? 38 : 12;
      setTimeout(typeChar, delay);
    } else {
      lineIdx++;
      charIdx = 0;
      const pause = line.type === 'cmd' ? 300 : line.type === 'blank' ? 80 : 30;
      setTimeout(nextLine, pause);
    }
  }

  // Start terminal after hero animates in
  setTimeout(nextLine, 900);

  // ── INTERACTIVE LAB DIAGRAM ──
  (function() {
    const canvas = document.getElementById('labCanvas');
    if (!canvas) return;
    const panel  = document.getElementById('nodePanel');
    const pTitle = document.getElementById('panelTitle');
    const pIp    = document.getElementById('panelIp');
    const pBody  = document.getElementById('panelBody');

    const W = 1600, H = 900;
    canvas.width  = W;
    canvas.height = H;
    const ctx = canvas.getContext('2d');
    let tick = 0;

    // ─────────────────────────────────────────────
    // COLOUR SYSTEM
    // ─────────────────────────────────────────────
    const C = {
      bg:      '#050810',
      grid:    'rgba(255,255,255,0.018)',
      mgmt:    { base:'#0b1830', border:'#1a4a9e', accent:'#4a8fff', glow:'rgba(74,143,255,0.22)',  dim:'rgba(74,143,255,0.08)',  label:'#6aafff', tag:'#1a3a7e' },
      sec:     { base:'#0a1c10', border:'#1a5a28', accent:'#2ecc71', glow:'rgba(46,204,113,0.22)', dim:'rgba(46,204,113,0.08)',  label:'#4ade80', tag:'#0f3a1a' },
      mon:     { base:'#1a1408', border:'#4a3a08', accent:'#f5c842', glow:'rgba(245,200,66,0.22)',  dim:'rgba(245,200,66,0.08)',  label:'#ffd95a', tag:'#3a2a08' },
      lab:     { base:'#1a0a0c', border:'#5a1a20', accent:'#ff4a5a', glow:'rgba(255,74,90,0.22)',   dim:'rgba(255,74,90,0.08)',   label:'#ff6a7a', tag:'#3a0a10' },
      hub:     { base:'#080f1e', border:'#2a4a8a', accent:'#c8d6f8', glow:'rgba(200,214,248,0.22)', dim:'rgba(200,214,248,0.08)', label:'#e8f0ff', tag:'#162040' },
      isp:     { base:'#0c0e18', border:'#2a2e48', accent:'#7a8ab0', glow:'rgba(122,138,176,0.2)',  dim:'rgba(122,138,176,0.06)', label:'#9aaad0', tag:'#1a1e30' },
    };

    // ─────────────────────────────────────────────
    // LAYOUT
    // ─────────────────────────────────────────────
    const GRID_SZ = 32;
    // pfSense hub — full width bar at top
    const PF = { x:46, y:14, w:1508, h:130 };
    // Bus line Y
    const BUS_Y = PF.y + PF.h + 44;
    // 4 zones below bus
    const ZW=368, ZH=500, ZY=BUS_Y+30, ZG=12;
    const ZX=[46, 426, 806, 1186];
    // Node cards inside zones
    const NW=ZW-24, NH=100, NY1=ZY+48, NY2=ZY+48+NH+14;
    const NX=ZX.map(x=>x+12);

    // ─────────────────────────────────────────────
    // ZONE + NODE DATA
    // ─────────────────────────────────────────────
    const ZONES=[
      {i:0,label:'VLAN 10',sub:'Management',   pk:'mgmt'},
      {i:1,label:'VLAN 20',sub:'Security',     pk:'sec'},
      {i:2,label:'VLAN 30',sub:'Monitoring',   pk:'mon'},
      {i:3,label:'VLAN 40',sub:'Lab / Victim', pk:'lab'},
    ];

    const NODES=[
      // pfSense
      { id:'pfsense', x:PF.x, y:PF.y, w:PF.w, h:PF.h, pk:'hub', isHub:true,
        title:'pfSense',    sub:'192.168.1.1',
        tags:['FIREWALL','VLAN TRUNK','NAT','IDS/IPS','SPAN PORT'],
        icon:'firewall',
        info:{ title:'pfSense Firewall', ip:'192.168.1.1',
          body:'Core of the lab. Handles all inter-VLAN routing, NAT, and firewall rules. Suricata runs inline for IDS/IPS. A mirror port sends all traffic to Security Onion for full-packet capture.' }},
      // MGMT
      { id:'winserver', x:NX[0], y:NY1, w:NW, h:NH, pk:'mgmt', zi:0,
        title:'Win Server 2019', sub:'192.168.10.10',
        tags:['AD','DNS','DHCP','GPO'],
        icon:'server',
        info:{ title:'Windows Server 2019', ip:'192.168.10.10',
          body:'Domain Controller for the lab. Runs Active Directory, DNS, DHCP, Group Policy, and Exchange Server.' }},
      { id:'ubuntu', x:NX[0], y:NY2, w:NW, h:NH, pk:'mgmt', zi:0,
        title:'Ubuntu 22.04', sub:'192.168.10.20',
        tags:['ANSIBLE','TERRAFORM','JUMP BOX'],
        icon:'server',
        info:{ title:'Ubuntu Server 22.04', ip:'192.168.10.20',
          body:'Automation host running Ansible and Terraform for infrastructure-as-code. Also serves as the SSH jump box for the rest of the lab.' }},
      // Security
      { id:'seconion', x:NX[1], y:NY1, w:NW, h:NH, pk:'sec', zi:1,
        title:'Security Onion', sub:'192.168.20.10',
        tags:['SIEM','ZEEK','SURICATA','ELASTIC'],
        icon:'shield',
        info:{ title:'Security Onion 2.4', ip:'192.168.20.10',
          body:'Full SIEM and IDS stack. Receives mirrored traffic from pfSense span port. Runs Zeek for protocol analysis, Suricata for detection, and Elastic Stack for log search.' }},
      { id:'kali', x:NX[1], y:NY2, w:NW, h:NH, pk:'sec', zi:1,
        title:'Kali Linux 2024', sub:'192.168.20.20',
        tags:['METASPLOIT','BURP SUITE','NMAP'],
        icon:'terminal',
        info:{ title:'Kali Linux 2024', ip:'192.168.20.20',
          body:'Primary pentest and CTF workstation. Full offensive toolkit including Metasploit, Burp Suite, Nmap, Hashcat, and BloodHound. Isolated to VLAN 20.' }},
      // Monitoring
      { id:'docker', x:NX[2], y:NY1, w:NW, h:NH, pk:'mon', zi:2,
        title:'Docker Host', sub:'192.168.30.10',
        tags:['PROMETHEUS','GRAFANA','LOKI'],
        icon:'monitor',
        info:{ title:'Docker Host (Ubuntu 22.04)', ip:'192.168.30.10',
          body:'Full observability stack via Docker Compose: Prometheus, Grafana, Loki, Promtail, Alertmanager, Node Exporter, and cAdvisor. Live dashboards for all lab VMs.' }},
      { id:'alertmgr', x:NX[2], y:NY2, w:NW, h:NH, pk:'mon', zi:2,
        title:'AlertManager', sub:'192.168.30.20',
        tags:['NODE EXPORTER','CADVISOR','PROMTAIL'],
        icon:'monitor',
        info:{ title:'AlertManager + Exporters', ip:'192.168.30.20',
          body:'Handles alert routing, grouping, and deduplication. Node Exporter scrapes host metrics from each VM. cAdvisor monitors container resource usage.' }},
      // Lab
      { id:'msf', x:NX[3], y:NY1, w:NW, h:NH, pk:'lab', zi:3,
        title:'Metasploitable 3', sub:'192.168.40.10',
        tags:['VULN TARGET','WINDOWS','ETERNALBLUE'],
        icon:'skull',
        info:{ title:'Metasploitable 3', ip:'192.168.40.10',
          body:'Intentionally vulnerable Windows Server. Used for exploitation practice: EternalBlue, unpatched services, weak credentials. Fully isolated in VLAN 40.' }},
      { id:'dvwa', x:NX[3], y:NY2, w:NW, h:NH, pk:'lab', zi:3,
        title:'DVWA', sub:'192.168.40.20',
        tags:['SQL INJECTION','XSS','CSRF','FILE INCL'],
        icon:'skull',
        info:{ title:'DVWA (Damn Vulnerable Web App)', ip:'192.168.40.20',
          body:'Web vulnerability training target. Covers SQL injection, XSS, CSRF, file inclusion, and command injection at adjustable difficulty levels.' }},
    ];

    // ─────────────────────────────────────────────
    // PACKET / PARTICLE SYSTEM
    // ─────────────────────────────────────────────
    // Paths as arrays of [x,y] waypoints
    function pathDrop(zi) {
      return [[ZX[zi]+ZW/2, BUS_Y],[ZX[zi]+ZW/2, ZY]];
    }
    const PATHS=[
      // pfSense internal pulse (top bar left→right)
      { pts:[[PF.x+20, PF.y+PF.h/2],[PF.x+PF.w-20, PF.y+PF.h/2]], color:'#c8d6f8', speed:0.0012 },
      // pfSense → bus
      { pts:[[PF.x+PF.w/2, PF.y+PF.h],[PF.x+PF.w/2, BUS_Y]], color:'#c8d6f8', speed:0.003 },
      // bus → zones
      { pts:[[PF.x+PF.w/2, BUS_Y],...pathDrop(0)], color:'#4a8fff', speed:0.0022 },
      { pts:[[PF.x+PF.w/2, BUS_Y],...pathDrop(1)], color:'#2ecc71', speed:0.0022 },
      { pts:[[PF.x+PF.w/2, BUS_Y],...pathDrop(2)], color:'#f5c842', speed:0.0022 },
      { pts:[[PF.x+PF.w/2, BUS_Y],...pathDrop(3)], color:'#ff4a5a', speed:0.0022 },
      // seconion → docker
      { pts:[[NX[1]+NW, NY1+NH/2],[NX[2], NY1+NH/2]], color:'#2ecc71', speed:0.0015 },
    ];

    // Initialise particles
    const particles=[];
    const PCOUNTS=[4,3,3,3,3,3,3];
    PATHS.forEach((p,pi)=>{
      for(let i=0;i<(PCOUNTS[pi]||3);i++){
        particles.push({ pi, t:Math.random(), trail:[], size:2.5+Math.random() });
      }
    });

    function pathLen(pts){
      let l=0;
      for(let i=0;i<pts.length-1;i++){
        const dx=pts[i+1][0]-pts[i][0],dy=pts[i+1][1]-pts[i][1];
        l+=Math.sqrt(dx*dx+dy*dy);
      }
      return l;
    }
    function pathPos(pts,t){
      let segs=[],tot=0;
      for(let i=0;i<pts.length-1;i++){
        const dx=pts[i+1][0]-pts[i][0],dy=pts[i+1][1]-pts[i][1];
        const l=Math.sqrt(dx*dx+dy*dy); segs.push(l); tot+=l;
      }
      let d=t*tot;
      for(let i=0;i<segs.length;i++){
        if(d<=segs[i]){
          const r=d/segs[i];
          return [pts[i][0]+r*(pts[i+1][0]-pts[i][0]), pts[i][1]+r*(pts[i+1][1]-pts[i][1])];
        }
        d-=segs[i];
      }
      return pts[pts.length-1];
    }

    // ─────────────────────────────────────────────
    // INTERACTION STATE
    // ─────────────────────────────────────────────
    let hovered=null, active=null;
    const FRIENDS={
      pfsense:['winserver','ubuntu','seconion','kali','docker','alertmgr','msf','dvwa'],
      winserver:['pfsense'],ubuntu:['pfsense'],
      seconion:['pfsense','docker'],kali:['pfsense'],
      docker:['pfsense','seconion'],alertmgr:['pfsense'],
      msf:['pfsense'],dvwa:['pfsense'],
    };
    function isFriend(id){ const p=active||hovered; return p&&(p===id||(FRIENDS[p]||[]).includes(id)); }
    function isDim(id){ const p=active||hovered; return p&&!isFriend(id); }

    // ─────────────────────────────────────────────
    // DRAW HELPERS
    // ─────────────────────────────────────────────
    function rr(x,y,w,h,r=6){
      ctx.beginPath();
      ctx.moveTo(x+r,y); ctx.lineTo(x+w-r,y); ctx.arcTo(x+w,y,x+w,y+r,r);
      ctx.lineTo(x+w,y+h-r); ctx.arcTo(x+w,y+h,x+w-r,y+h,r);
      ctx.lineTo(x+r,y+h); ctx.arcTo(x,y+h,x,y+h-r,r);
      ctx.lineTo(x,y+r); ctx.arcTo(x,y,x+r,y,r);
      ctx.closePath();
    }

    function hexPath(cx,cy,r){
      ctx.beginPath();
      for(let i=0;i<6;i++){
        const a=Math.PI/3*i-Math.PI/6;
        i===0?ctx.moveTo(cx+r*Math.cos(a),cy+r*Math.sin(a)):ctx.lineTo(cx+r*Math.cos(a),cy+r*Math.sin(a));
      }
      ctx.closePath();
    }

    function arrow(x1,y1,x2,y2,col,sz=7){
      const a=Math.atan2(y2-y1,x2-x1);
      ctx.fillStyle=col; ctx.beginPath();
      ctx.moveTo(x2,y2);
      ctx.lineTo(x2-sz*Math.cos(a-.4),y2-sz*Math.sin(a-.4));
      ctx.lineTo(x2-sz*Math.cos(a+.4),y2-sz*Math.sin(a+.4));
      ctx.closePath(); ctx.fill();
    }

    function drawGlowLine(pts,col,lw,dash,glow){
      ctx.save();
      if(glow){ ctx.shadowColor=col; ctx.shadowBlur=glow; }
      ctx.strokeStyle=col; ctx.lineWidth=lw;
      ctx.setLineDash(dash||[]);
      ctx.beginPath(); ctx.moveTo(pts[0][0],pts[0][1]);
      pts.slice(1).forEach(p=>ctx.lineTo(p[0],p[1]));
      ctx.stroke(); ctx.setLineDash([]); ctx.restore();
    }

    // ─────────────────────────────────────────────
    // ICON DRAWERS
    // ─────────────────────────────────────────────
    function drawIcon(type,cx,cy,sz,col){
      ctx.strokeStyle=col; ctx.fillStyle=col;
      ctx.lineWidth=1.5;
      ctx.beginPath();
      if(type==='firewall'){
        // Shield
        ctx.moveTo(cx,cy-sz); ctx.lineTo(cx+sz*.8,cy-sz*.5);
        ctx.lineTo(cx+sz*.8,cy+sz*.2); ctx.quadraticCurveTo(cx,cy+sz,cx,cy+sz);
        ctx.quadraticCurveTo(cx-sz*.8,cy+sz*.2,cx-sz*.8,cy+sz*.2);
        ctx.lineTo(cx-sz*.8,cy-sz*.5); ctx.closePath();
        ctx.stroke();
        ctx.font=`bold ${sz*.8}px monospace`; ctx.textAlign='center';
        ctx.fillText('⚡',cx,cy+sz*.35);
      } else if(type==='server'){
        // Stack of rectangles
        [-1,0,1].forEach(i=>{
          rr(cx-sz,cy+i*sz*.7-sz*.2,sz*2,sz*.45,2);
          ctx.stroke();
          ctx.beginPath(); ctx.arc(cx+sz*.65,cy+i*sz*.7+sz*.02,sz*.1,0,Math.PI*2); ctx.fill();
        });
      } else if(type==='shield'){
        ctx.moveTo(cx,cy-sz); ctx.lineTo(cx+sz,cy-sz*.4);
        ctx.lineTo(cx+sz,cy+sz*.3); ctx.quadraticCurveTo(cx,cy+sz*1.1,cx,cy+sz*1.1);
        ctx.quadraticCurveTo(cx-sz,cy+sz*.3,cx-sz,cy+sz*.3);
        ctx.lineTo(cx-sz,cy-sz*.4); ctx.closePath(); ctx.stroke();
        ctx.font=`${sz}px monospace`; ctx.textAlign='center';
        ctx.fillText('◉',cx,cy+sz*.3);
      } else if(type==='terminal'){
        rr(cx-sz,cy-sz*.7,sz*2,sz*1.4,3); ctx.stroke();
        ctx.font=`${sz*.5}px "JetBrains Mono",monospace`; ctx.textAlign='left';
        ctx.fillText('$ _',cx-sz*.75,cy+sz*.1);
      } else if(type==='monitor'){
        rr(cx-sz,cy-sz*.8,sz*2,sz*1.2,3); ctx.stroke();
        ctx.moveTo(cx,cy+sz*.4); ctx.lineTo(cx,cy+sz*.8); ctx.stroke();
        ctx.moveTo(cx-sz*.4,cy+sz*.8); ctx.lineTo(cx+sz*.4,cy+sz*.8); ctx.stroke();
        ctx.font=`${sz*.55}px monospace`; ctx.textAlign='center';
        ctx.fillStyle=col+'88'; ctx.fillText('▲▼',cx,cy+sz*.1);
      } else if(type==='skull'){
        ctx.arc(cx,cy-sz*.1,sz*.7,0,Math.PI*2); ctx.stroke();
        ctx.beginPath();
        ctx.arc(cx-sz*.25,cy+sz*.05,sz*.18,0,Math.PI*2); ctx.fill();
        ctx.beginPath();
        ctx.arc(cx+sz*.25,cy+sz*.05,sz*.18,0,Math.PI*2); ctx.fill();
        ctx.beginPath();
        ctx.moveTo(cx-sz*.4,cy+sz*.7); ctx.lineTo(cx+sz*.4,cy+sz*.7);
        [-sz*.25,0,sz*.25].forEach(x=>{
          ctx.moveTo(cx+x,cy+sz*.5); ctx.lineTo(cx+x,cy+sz*.7);
        });
        ctx.stroke();
      }
    }

    // ─────────────────────────────────────────────
    // BACKGROUND
    // ─────────────────────────────────────────────
    function drawBG(){
      ctx.fillStyle=C.bg; ctx.fillRect(0,0,W,H);
      // Dot grid
      ctx.fillStyle=C.grid;
      for(let x=GRID_SZ;x<W;x+=GRID_SZ)
        for(let y=GRID_SZ;y<H;y+=GRID_SZ){
          ctx.beginPath(); ctx.arc(x,y,.8,0,Math.PI*2); ctx.fill();
        }
      // Subtle scanlines
      ctx.fillStyle='rgba(0,0,0,0.04)';
      for(let y=0;y<H;y+=3){ ctx.fillRect(0,y,W,1); }
    }

    // ─────────────────────────────────────────────
    // CONNECTIONS
    // ─────────────────────────────────────────────
    function drawConnections(){
      const pivot=active||hovered;

      // Bus line
      const busLit=pivot&&pivot!=='pfsense'||!pivot;
      drawGlowLine([[ZX[0]+ZW/2,BUS_Y],[ZX[3]+ZW/2,BUS_Y]],
        pivot?'rgba(200,214,248,0.12)':'rgba(200,214,248,0.06)',1,[]);

      // pfSense → bus stem
      drawGlowLine([[PF.x+PF.w/2,PF.y+PF.h],[PF.x+PF.w/2,BUS_Y]],
        pivot?'rgba(200,214,248,0.15)':'rgba(200,214,248,0.08)',1.5,[]);

      // Zone drops
      const zoneCols=['#4a8fff','#2ecc71','#f5c842','#ff4a5a'];
      const zonePivots=[
        ['pfsense','winserver','ubuntu'],
        ['pfsense','seconion','kali'],
        ['pfsense','docker','alertmgr'],
        ['pfsense','msf','dvwa'],
      ];
      ZX.forEach((zx,i)=>{
        const lit=pivot&&zonePivots[i].includes(pivot);
        const base=zoneCols[i];
        const col=lit?base:(pivot?'rgba(255,255,255,0.05)':'rgba(255,255,255,0.08)');
        const lw=lit?2.5:1;
        const glow=lit?14:0;
        drawGlowLine([[zx+ZW/2,BUS_Y],[zx+ZW/2,ZY]],col,lw,lit?[]:[8,6],glow);
        if(lit) arrow(zx+ZW/2,BUS_Y+40,zx+ZW/2,ZY,base,8);
      });

      // seconion → docker
      {
        const lit=pivot&&(pivot==='seconion'||pivot==='docker');
        const y=NY1+NH/2;
        const col=lit?'#2ecc71':'rgba(46,204,113,0.15)';
        drawGlowLine([[NX[1]+NW,y],[NX[2],y]],col,lit?2:1,[4,4],lit?10:0);
        if(lit){
          arrow(NX[1]+NW+10,y,NX[2],y,'#2ecc71',8);
        }
      }
    }

    // ─────────────────────────────────────────────
    // ZONES
    // ─────────────────────────────────────────────
    function drawZones(){
      const pivot=active||hovered;
      ZONES.forEach(z=>{
        const x=ZX[z.i], pal=C[z.pk];
        const lit=pivot&&['pfsense',...NODES.filter(n=>n.zi===z.i).map(n=>n.id)].includes(pivot);
        const alpha=pivot&&!lit?0.25:1;
        ctx.globalAlpha=alpha;

        // Zone glow
        if(lit){
          const g=ctx.createRadialGradient(x+ZW/2,ZY+ZH*.6,ZW*.1,x+ZW/2,ZY+ZH*.6,ZW*.9);
          g.addColorStop(0,pal.glow); g.addColorStop(1,'transparent');
          ctx.fillStyle=g; ctx.fillRect(x,ZY,ZW,ZH);
        }

        // Zone body
        ctx.fillStyle=pal.base; ctx.strokeStyle=lit?pal.border:'rgba(255,255,255,0.06)';
        ctx.lineWidth=lit?1.5:1;
        rr(x,ZY,ZW,ZH,8); ctx.fill(); ctx.stroke();

        // Top bar with gradient
        const topGrad=ctx.createLinearGradient(x,ZY,x+ZW,ZY);
        topGrad.addColorStop(0,pal.accent+'44');
        topGrad.addColorStop(.5,pal.accent+'88');
        topGrad.addColorStop(1,pal.accent+'44');
        ctx.fillStyle=topGrad;
        rr(x,ZY,ZW,4,2); ctx.fill();

        // VLAN label
        ctx.fillStyle=lit?pal.label:'#3a4260';
        ctx.font='bold 15px "JetBrains Mono",monospace'; ctx.textAlign='center';
        ctx.fillText(z.label,x+ZW/2,ZY+24);
        ctx.fillStyle=lit?pal.accent+'99':'#2a3050';
        ctx.font='11px "JetBrains Mono",monospace';
        ctx.fillText(z.sub.toUpperCase(),x+ZW/2,ZY+40);

        ctx.globalAlpha=1;
      });
    }

    // ─────────────────────────────────────────────
    // NODES
    // ─────────────────────────────────────────────
    function drawNodes(){
      const pivot=active||hovered;
      NODES.forEach(n=>{
        if(n.isHub) return; // drawn separately
        const pal=C[n.pk];
        const isAct=active===n.id, isHov=hovered===n.id;
        const friend=isFriend(n.id);
        const dim=isDim(n.id);
        ctx.globalAlpha=dim?0.18:1;

        // Outer glow ring on active
        if(isAct){
          const pulse=0.4+0.3*Math.sin(tick*0.06);
          ctx.save(); ctx.globalAlpha=pulse;
          ctx.shadowColor=pal.accent; ctx.shadowBlur=30;
          ctx.strokeStyle=pal.accent; ctx.lineWidth=1;
          rr(n.x-4,n.y-4,n.w+8,n.h+8,10); ctx.stroke();
          ctx.restore(); ctx.globalAlpha=dim?0.18:1;
        }

        // Card shadow/glow
        if(isAct||isHov){
          ctx.shadowColor=pal.accent; ctx.shadowBlur=isAct?28:14;
        }

        // Card body
        ctx.fillStyle=isAct?pal.base:isHov?pal.base:n.zi!==undefined?pal.base:'#0d0e18';
        ctx.strokeStyle=isAct?pal.accent:isHov?pal.accent+'cc':friend?pal.accent+'55':pal.border+'66';
        ctx.lineWidth=(isAct||isHov)?2:1;
        rr(n.x,n.y,n.w,n.h,6); ctx.fill(); ctx.stroke();
        ctx.shadowBlur=0;

        // Left accent strip
        ctx.fillStyle=isAct?pal.accent:isHov?pal.accent+'aa':pal.accent+'33';
        rr(n.x,n.y,4,n.h,3); ctx.fill();

        // Status dot
        const dotPulse=isAct?(0.5+0.5*Math.sin(tick*0.08)):0.9;
        ctx.fillStyle=pal.accent; ctx.globalAlpha=(dim?0.18:1)*dotPulse;
        ctx.beginPath(); ctx.arc(n.x+20,n.y+n.h/2,5,0,Math.PI*2); ctx.fill();
        ctx.globalAlpha=dim?0.18:1;

        // Icon
        const iconX=n.x+n.w-44, iconY=n.y+n.h/2;
        ctx.globalAlpha=(dim?0.18:1)*(isAct||isHov?0.9:0.35);
        drawIcon(n.icon,iconX,iconY,14,pal.accent);
        ctx.globalAlpha=dim?0.18:1;

        // Title
        ctx.fillStyle=isAct?pal.label:isHov?pal.label:friend?pal.accent+'cc':'#6a7898';
        ctx.font=`600 17px "JetBrains Mono",monospace`; ctx.textAlign='left';
        ctx.fillText(n.title,n.x+32,n.y+30);

        // IP
        ctx.fillStyle=isAct?pal.accent+'cc':isHov?pal.accent+'99':'#2a3454';
        ctx.font=`400 13px "JetBrains Mono",monospace`;
        ctx.fillText(n.sub,n.x+32,n.y+50);

        // Tags
        let tx=n.x+32, ty=n.y+n.h-18;
        n.tags.forEach(tag=>{
          const tw=ctx.measureText(tag).width+12;
          if(tx+tw>n.x+n.w-50) return;
          ctx.fillStyle=isAct?pal.tag:isHov?pal.tag:'rgba(255,255,255,0.04)';
          rr(tx,ty-12,tw,16,3); ctx.fill();
          ctx.fillStyle=isAct?pal.accent+'cc':isHov?pal.accent+'99':'#3a4464';
          ctx.font='bold 9px "JetBrains Mono",monospace'; ctx.textAlign='left';
          ctx.fillText(tag,tx+6,ty);
          tx+=tw+5;
        });

        ctx.globalAlpha=1;
      });
    }

    // ─────────────────────────────────────────────
    // pfSense HUB NODE
    // ─────────────────────────────────────────────
    function drawHub(){
      const n=NODES[0], pal=C.hub;
      const isAct=active===n.id, isHov=hovered===n.id;
      const pivot=active||hovered;
      const dim=pivot&&!isAct&&!isHov&&!(FRIENDS[pivot]||[]).includes(n.id)&&pivot!==n.id;
      ctx.globalAlpha=dim?0.3:1;

      if(isAct||isHov){ ctx.shadowColor=pal.accent; ctx.shadowBlur=isAct?32:16; }

      // Body
      ctx.fillStyle='#07101e';
      ctx.strokeStyle=isAct?pal.accent:isHov?pal.accent+'cc':'rgba(74,100,180,0.4)';
      ctx.lineWidth=(isAct||isHov)?2:1.5;
      rr(n.x,n.y,n.w,n.h,8); ctx.fill(); ctx.stroke();
      ctx.shadowBlur=0;

      // Top gradient bar
      const barGrad=ctx.createLinearGradient(n.x,n.y,n.x+n.w,n.y);
      barGrad.addColorStop(0,'rgba(74,100,220,0.6)');
      barGrad.addColorStop(.3,'rgba(200,214,248,0.5)');
      barGrad.addColorStop(.7,'rgba(200,214,248,0.5)');
      barGrad.addColorStop(1,'rgba(74,100,220,0.6)');
      ctx.fillStyle=barGrad; rr(n.x,n.y,n.w,4,4); ctx.fill();

      // Hex icon
      ctx.save(); ctx.globalAlpha=(dim?0.3:1)*0.6;
      ctx.strokeStyle=pal.accent+'66'; ctx.lineWidth=1;
      hexPath(n.x+50,n.y+n.h/2,26); ctx.stroke();
      hexPath(n.x+50,n.y+n.h/2,20); ctx.stroke();
      ctx.restore();

      // Main title
      ctx.fillStyle=isAct||isHov?'#e8f0ff':'#c8d6f8';
      ctx.font='bold 26px "JetBrains Mono",monospace'; ctx.textAlign='left';
      ctx.fillText(n.title,n.x+88,n.y+48);

      // Sub IP
      ctx.fillStyle='#4a6aaa';
      ctx.font='500 16px "JetBrains Mono",monospace';
      ctx.fillText(n.sub,n.x+88,n.y+72);

      // Tags
      let tx=n.x+88, ty=n.y+n.h-16;
      n.tags.forEach(tag=>{
        const tw=ctx.measureText(tag).width+14;
        ctx.fillStyle='rgba(74,100,220,0.25)'; rr(tx,ty-13,tw,17,3); ctx.fill();
        ctx.fillStyle=isAct?pal.accent:'#5a7aaa';
        ctx.font='bold 10px "JetBrains Mono",monospace'; ctx.textAlign='left';
        ctx.fillText(tag,tx+7,ty); tx+=tw+6;
      });

      // Live pulsing indicator
      const p=0.4+0.6*Math.sin(tick*0.05);
      ctx.fillStyle=`rgba(46,204,113,${p*0.9})`;
      ctx.shadowColor='#2ecc71'; ctx.shadowBlur=8*p;
      ctx.beginPath(); ctx.arc(n.x+n.w-30,n.y+n.h/2,5,0,Math.PI*2); ctx.fill();
      ctx.shadowBlur=0;
      ctx.fillStyle=`rgba(46,204,113,${p*0.4})`;
      ctx.beginPath(); ctx.arc(n.x+n.w-30,n.y+n.h/2,5+8*p,0,Math.PI*2); ctx.fill();
      ctx.fillStyle='#2ecc71'; ctx.font='bold 11px "JetBrains Mono",monospace';
      ctx.textAlign='right'; ctx.fillText('ONLINE',n.x+n.w-42,n.y+n.h/2+4);

      ctx.globalAlpha=1;
    }

    // ─────────────────────────────────────────────
    // PARTICLES
    // ─────────────────────────────────────────────
    function drawParticles(){
      particles.forEach(p=>{
        const path=PATHS[p.pi];
        const pos=pathPos(path.pts,p.t);
        // Trail
        for(let i=0;i<p.trail.length;i++){
          const a=(i/p.trail.length)*0.25;
          ctx.globalAlpha=a;
          ctx.fillStyle=path.color;
          ctx.beginPath(); ctx.arc(p.trail[i][0],p.trail[i][1],p.size*.5,0,Math.PI*2); ctx.fill();
        }
        // Head glow
        ctx.globalAlpha=0.9;
        ctx.shadowColor=path.color; ctx.shadowBlur=12;
        ctx.fillStyle=path.color;
        ctx.beginPath(); ctx.arc(pos[0],pos[1],p.size,0,Math.PI*2); ctx.fill();
        ctx.shadowBlur=0; ctx.globalAlpha=1;
        // Advance
        p.trail.push([...pos]);
        if(p.trail.length>8) p.trail.shift();
        p.t=(p.t+path.speed)%1;
      });
    }

    // ─────────────────────────────────────────────
    // FOOTER
    // ─────────────────────────────────────────────
    function drawFooter(){
      ctx.fillStyle='rgba(255,255,255,0.12)';
      ctx.font='11px "JetBrains Mono",monospace'; ctx.textAlign='left';
      ctx.fillText('VMware Workstation  ·  Windows 11  ·  Click any node for details',14,H-10);
      // Uptime counter (fake but fun)
      const mins=Math.floor(tick/60), secs=tick%60;
      ctx.textAlign='right';
      ctx.fillText(`UPTIME ${String(mins).padStart(3,'0')}:${String(secs).padStart(2,'0')}`,W-14,H-10);
    }

    // ─────────────────────────────────────────────
    // MAIN LOOP
    // ─────────────────────────────────────────────
    function draw(){
      drawBG();
      drawConnections();
      drawZones();
      drawNodes();
      drawParticles();
      drawHub();
      drawFooter();
      tick++;
      requestAnimationFrame(draw);
    }

    // ─────────────────────────────────────────────
    // HIT TEST + EVENTS
    // ─────────────────────────────────────────────
    function getNode(mx,my){
      const r=canvas.getBoundingClientRect();
      const cx=(mx-r.left)*(W/r.width), cy=(my-r.top)*(H/r.height);
      return NODES.find(n=>cx>=n.x&&cx<=n.x+n.w&&cy>=n.y&&cy<=n.y+n.h)||null;
    }

    function showPanel(n,mx,my){
      pTitle.textContent=n.info.title;
      pIp.textContent=n.info.ip;
      pBody.textContent=n.info.body;
      panel.style.display='block';
      const wrap=canvas.parentElement.getBoundingClientRect();
      let left=mx-wrap.left+18, top=my-wrap.top+18;
      const pw=290,ph=170;
      if(left+pw>wrap.width-10) left=mx-wrap.left-pw-18;
      if(top+ph>wrap.height-10) top=my-wrap.top-ph-18;
      panel.style.left=Math.max(4,left)+'px';
      panel.style.top=Math.max(4,top)+'px';
    }

    canvas.addEventListener('mousemove',e=>{
      const n=getNode(e.clientX,e.clientY);
      hovered=n?n.id:null;
      canvas.style.cursor=n?'pointer':'default';
      if(n&&!active) showPanel(n,e.clientX,e.clientY);
      else if(!n&&!active) panel.style.display='none';
    });
    canvas.addEventListener('click',e=>{
      const n=getNode(e.clientX,e.clientY);
      active=(n&&active!==n.id)?n.id:null;
      if(active&&n) showPanel(n,e.clientX,e.clientY);
      else panel.style.display='none';
    });
    canvas.addEventListener('mouseleave',()=>{
      hovered=null;
      if(!active) panel.style.display='none';
    });
    canvas.addEventListener('touchstart',e=>{
      e.preventDefault();
      const t=e.touches[0],n=getNode(t.clientX,t.clientY);
      active=(n&&active!==n.id)?n.id:null;
      if(active&&n) showPanel(n,t.clientX,t.clientY);
      else panel.style.display='none';
    },{passive:false});

    draw();
  })();
</script>

</body>
</html>
