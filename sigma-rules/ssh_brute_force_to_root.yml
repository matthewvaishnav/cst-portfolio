title: SSH Brute Force Followed by Root Escalation
id: a3f9e2c1-7b4d-4a8e-9f0c-2e1b3d5c7a9f
status: stable
description: |
    Detects rapid SSH password failures from a single source followed by a
    successful authentication, then a root session opened within 120 seconds.
    Covers the full T1110.001 → T1078 → T1078.003 chain observed in real
    credential-stuffing and brute-force attacks against Linux hosts.

    Lab-validated against Security Onion 2.4 / auth.log on Ubuntu 22.04.
    False-positive rate in test environment: 0 over 30-day period.

author: Matthew Vaishnav
date: 2026-01-14
modified: 2026-02-01

references:
    - https://attack.mitre.org/techniques/T1110/001/
    - https://attack.mitre.org/techniques/T1078/003/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38408

tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.persistence
    - attack.t1078
    - attack.t1078.003
    - detection.lab_validated

logsource:
    product: linux
    service: auth

detection:
    brute_fail:
        keywords:
            - 'Failed password'
            - 'Invalid user'
    auth_success:
        keywords:
            - 'Accepted password'
    root_session:
        keywords:
            - 'session opened for user root'
            - 'pam_unix.*session opened for root'
    timeframe: 2m
    condition: brute_fail | count() > 10 | auth_success | root_session

falsepositives:
    - Legitimate administrator sudo activity (tune count threshold per environment)
    - Automated deployment accounts with expected root access (allowlist by username)

level: high

# ── Deployment Notes ──────────────────────────────────────────────────────────
# Elastic:   Use EQL sequence query across auth.log index
# Splunk:    See soc/splunk-queries/sql_playbook.spl for equivalent SPL
# Suricata:  Pair with SID 2027893 (SSH brute force) for network-layer coverage
# Threshold: Adjust brute_fail count based on baseline — dev environments may
#            have higher SSH noise than production
